var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},b=Object.create(new $jscomp.global.Proxy(a,{get:function(e,l,h){return e==a&&"q"==l&&h==b}}));return!0===b.q}catch(e){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;
$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,e){a!=Array.prototype&&a!=Object.prototype&&(a[b]=e.value)};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};
$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(e){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(e||"")+"_"+b++,e)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};$jscomp.polyfill=function(a,b,e,l){if(b){e=$jscomp.global;a=a.split(".");for(l=0;l<a.length-1;l++){var h=a[l];h in e||(e[h]={});e=e[h]}a=a[a.length-1];l=e[a];b=b(l);b!=l&&null!=b&&$jscomp.defineProperty(e,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("WeakMap",function(a){function b(){if(!a||!Object.seal)return!1;try{var d=Object.seal({}),b=Object.seal({}),g=new a([[d,2],[b,3]]);if(2!=g.get(d)||3!=g.get(b))return!1;g.delete(d);g.set(b,4);return!g.has(d)&&4==g.get(b)}catch(c){return!1}}function e(){}function l(a){if(!$jscomp.owns(a,n)){var d=new e;$jscomp.defineProperty(a,n,{value:d})}}function h(a){var d=Object[a];d&&(Object[a]=function(a){if(a instanceof e)return a;l(a);return d(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&
$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;var n="$jscomp_hidden_"+Math.random();h("freeze");h("preventExtensions");h("seal");var g=0,d=function(a){this.id_=(g+=Math.random()+1).toString();if(a){a=$jscomp.makeIterator(a);for(var d;!(d=a.next()).done;)d=d.value,this.set(d[0],d[1])}};d.prototype.set=function(a,d){l(a);if(!$jscomp.owns(a,n))throw Error("WeakMap key fail: "+a);a[n][this.id_]=d;return this};d.prototype.get=function(a){return $jscomp.owns(a,n)?a[n][this.id_]:void 0};d.prototype.has=
function(a){return $jscomp.owns(a,n)&&$jscomp.owns(a[n],this.id_)};d.prototype.delete=function(a){return $jscomp.owns(a,n)&&$jscomp.owns(a[n],this.id_)?delete a[n][this.id_]:!1};return d},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(a){function b(){if($jscomp.ASSUME_NO_NATIVE_MAP||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var d=Object.seal({x:4}),b=new a($jscomp.makeIterator([[d,"s"]]));if("s"!=b.get(d)||1!=b.size||b.get({x:4})||b.set({x:4},"t")!=b||2!=b.size)return!1;var g=b.entries(),c=g.next();if(c.done||c.value[0]!=d||"s"!=c.value[1])return!1;c=g.next();return c.done||4!=c.value[0].x||"t"!=c.value[1]||!g.next().done?!1:!0}catch(f){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;$jscomp.initSymbolIterator();var e=new WeakMap,l=function(a){this.data_={};this.head_=g();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var d;!(d=a.next()).done;)d=d.value,this.set(d[0],d[1])}};l.prototype.set=function(a,d){a=0===a?0:a;var k=h(this,a);k.list||(k.list=this.data_[k.id]=[]);k.entry?k.entry.value=d:(k.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,
value:d},k.list.push(k.entry),this.head_.previous.next=k.entry,this.head_.previous=k.entry,this.size++);return this};l.prototype.delete=function(a){a=h(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};l.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=g();this.size=0};l.prototype.has=function(a){return!!h(this,a).entry};
l.prototype.get=function(a){return(a=h(this,a).entry)&&a.value};l.prototype.entries=function(){return n(this,function(a){return[a.key,a.value]})};l.prototype.keys=function(){return n(this,function(a){return a.key})};l.prototype.values=function(){return n(this,function(a){return a.value})};l.prototype.forEach=function(a,d){for(var k=this.entries(),c;!(c=k.next()).done;)c=c.value,a.call(d,c[1],c[0],this)};l.prototype[Symbol.iterator]=l.prototype.entries;var h=function(a,b){var k=b&&typeof b;"object"==
k||"function"==k?e.has(b)?k=e.get(b):(k=""+ ++d,e.set(b,k)):k="p_"+b;var c=a.data_[k];if(c&&$jscomp.owns(a.data_,k))for(a=0;a<c.length;a++){var f=c[a];if(b!==b&&f.key!==f.key||b===f.key)return{id:k,list:c,index:a,entry:f}}return{id:k,list:c,index:-1,entry:void 0}},n=function(a,d){var k=a.head_;return $jscomp.iteratorPrototype(function(){if(k){for(;k.head!=a.head_;)k=k.previous;for(;k.next!=k.head;)return k=k.next,{done:!1,value:d(k)};k=null}return{done:!0,value:void 0}})},g=function(){var a={};return a.previous=
a.next=a.head=a},d=0;return l},"es6","es3");
$jscomp.polyfill("Set",function(a){function b(){if($jscomp.ASSUME_NO_NATIVE_SET||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),e=new a($jscomp.makeIterator([b]));if(!e.has(b)||1!=e.size||e.add(b)!=e||1!=e.size||e.add({x:4})!=e||2!=e.size)return!1;var n=e.entries(),g=n.next();if(g.done||g.value[0]!=b||g.value[1]!=b)return!1;g=n.next();return g.done||g.value[0]==b||4!=g.value[0].x||g.value[1]!=g.value[0]?!1:n.next().done}catch(d){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;$jscomp.initSymbolIterator();var e=function(a){this.map_=new Map;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)this.add(b.value)}this.size=this.map_.size};e.prototype.add=function(a){a=0===a?0:a;this.map_.set(a,a);this.size=this.map_.size;return this};e.prototype.delete=function(a){a=this.map_.delete(a);this.size=this.map_.size;return a};e.prototype.clear=function(){this.map_.clear();
this.size=0};e.prototype.has=function(a){return this.map_.has(a)};e.prototype.entries=function(){return this.map_.entries()};e.prototype.values=function(){return this.map_.values()};e.prototype.keys=e.prototype.values;e.prototype[Symbol.iterator]=e.prototype.values;e.prototype.forEach=function(a,b){var e=this;this.map_.forEach(function(g){return a.call(b,g,g,e)})};return e},"es6","es3");
$jscomp.polyfill("Object.is",function(a){return a?a:function(a,e){return a===e?0!==a||1/a===1/e:a!==a&&e!==e}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,e){var b=this;b instanceof String&&(b=String(b));var h=b.length;e=e||0;for(0>e&&(e=Math.max(e+h,0));e<h;e++){var n=b[e];if(n===a||Object.is(n,a))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,b,e){if(null==a)throw new TypeError("The 'this' value for String.prototype."+e+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+e+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,e){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,e||0)}},"es6","es3");$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function e(a){return a instanceof h?a:new h(function(d,k){d(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;b.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var d=this;this.asyncExecuteFunction(function(){d.executeBatch_()})}this.batch_.push(a)};var l=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(a){l(a,0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var d=0;d<a.length;++d){var k=a[d];a[d]=null;try{k()}catch(u){this.asyncThrow_(u)}}}this.batch_=null};b.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var h=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var d=this.createResolveAndReject_();try{a(d.resolve,d.reject)}catch(k){d.reject(k)}};h.prototype.createResolveAndReject_=function(){function a(a){return function(b){k||(k=!0,a.call(d,b))}}var d=this,k=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};h.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof h)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var d=null!=a;break a;case "function":d=!0;break a;default:d=!1}d?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};h.prototype.resolveToNonPromiseObj_=function(a){var d=void 0;try{d=a.then}catch(k){this.reject_(k);return}"function"==typeof d?
this.settleSameAsThenable_(d,a):this.fulfill_(a)};h.prototype.reject_=function(a){this.settle_(2,a)};h.prototype.fulfill_=function(a){this.settle_(1,a)};h.prototype.settle_=function(a,d){if(0!=this.state_)throw Error("Cannot settle("+a+", "+d+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=d;this.executeOnSettledCallbacks_()};h.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=0;a<this.onSettledCallbacks_.length;++a)n.asyncExecute(this.onSettledCallbacks_[a]);
this.onSettledCallbacks_=null}};var n=new b;h.prototype.settleSameAsPromise_=function(a){var d=this.createResolveAndReject_();a.callWhenSettled_(d.resolve,d.reject)};h.prototype.settleSameAsThenable_=function(a,d){var b=this.createResolveAndReject_();try{a.call(d,b.resolve,b.reject)}catch(u){b.reject(u)}};h.prototype.then=function(a,d){function b(a,c){return"function"==typeof a?function(c){try{e(a(c))}catch(z){g(z)}}:c}var e,g,c=new h(function(a,c){e=a;g=c});this.callWhenSettled_(b(a,e),b(d,g));return c};
h.prototype.catch=function(a){return this.then(void 0,a)};h.prototype.callWhenSettled_=function(a,d){function b(){switch(e.state_){case 1:a(e.result_);break;case 2:d(e.result_);break;default:throw Error("Unexpected state: "+e.state_);}}var e=this;null==this.onSettledCallbacks_?n.asyncExecute(b):this.onSettledCallbacks_.push(b)};h.resolve=e;h.reject=function(a){return new h(function(d,b){b(a)})};h.race=function(a){return new h(function(d,b){for(var k=$jscomp.makeIterator(a),g=k.next();!g.done;g=k.next())e(g.value).callWhenSettled_(d,
b)})};h.all=function(a){var d=$jscomp.makeIterator(a),b=d.next();return b.done?e([]):new h(function(a,k){function c(c){return function(d){f[c]=d;q--;0==q&&a(f)}}var f=[],q=0;do f.push(void 0),q++,e(b.value).callWhenSettled_(c(f.length-1),k),b=d.next();while(!b.done)})};return h},"es6","es3");var cr={plugins_:{},behaviors:{}};"function"!==typeof Object.getPrototypeOf&&(Object.getPrototypeOf="object"===typeof"test".__proto__?function(a){return a.__proto__}:function(a){return a.constructor.prototype});
(function(){function a(a,c){this.x=a;this.y=c;cr.seal(this)}function b(a,c,d,f){this.set(a,c,d,f);cr.seal(this)}function e(){this.bly=this.blx=this.bry=this.brx=this.try_=this.trx=this.tly=this.tlx=0;cr.seal(this)}function l(a,c,d,f){a<c?d<f?(z=a<d?a:d,x=c>f?c:f):(z=a<f?a:f,x=c>d?c:d):d<f?(z=c<d?c:d,x=a>f?a:f):(z=c<f?c:f,x=a>d?a:d)}function h(){this.items=this.s=null;this.item_count=0;B&&(this.s=new Set);this.values_cache=[];this.cache_valid=!0;cr.seal(this)}function n(a){E[m++]=a}function g(){this.sum=
this.t=this.y=this.c=0;cr.seal(this)}function d(a){this.pts_cache=[];this.bboxBottom=this.bboxRight=this.bboxTop=this.bboxLeft=0;this.convexpolys=null;this.set_pts(a);cr.seal(this)}function k(a,c){this.cellwidth=a;this.cellheight=c;this.cells={}}function u(a,c){this.cellwidth=a;this.cellheight=c;this.cells={}}function r(a,c,d){k.prototype.totalCellCount++;if(K.length){var f=K.pop();f.grid=a;f.x=c;f.y=d;return f}return new cr.GridCell(a,c,d)}function c(a,c,d){this.grid=a;this.x=c;this.y=d;this.objects=
new cr.ObjectSet}function f(a,c,d){u.prototype.totalCellCount++;if(I.length){var f=I.pop();f.grid=a;f.x=c;f.y=d;return f}return new cr.RenderCell(a,c,d)}function q(a,c,d){this.grid=a;this.x=c;this.y=d;this.objects=[];this.is_sorted=!0;this.pending_removal=new cr.ObjectSet;this.any_pending_removal=!1}function y(a,c){return a.zindex-c.zindex}cr.logexport=function(a){window.console&&window.console.log&&window.console.log(a)};cr.logerror=function(a){window.console&&window.console.error&&window.console.error(a)};
cr.seal=function(a){return a};cr.freeze=function(a){return a};cr.is_undefined=function(a){return"undefined"===typeof a};cr.is_number=function(a){return"number"===typeof a};cr.is_string=function(a){return"string"===typeof a};cr.isPOT=function(a){return 0<a&&0===(a-1&a)};cr.nextHighestPowerOfTwo=function(a){--a;for(var c=1;32>c;c<<=1)a|=a>>c;return a+1};cr.abs=function(a){return 0>a?-a:a};cr.max=function(a,c){return a>c?a:c};cr.min=function(a,c){return a<c?a:c};cr.PI=Math.PI;cr.round=function(a){return a+
.5|0};cr.floor=function(a){return 0<=a?a|0:(a|0)-1};cr.ceil=function(a){var c=a|0;return c===a?c:c+1};a.prototype.offset=function(a,c){this.x+=a;this.y+=c;return this};a.prototype.mul=function(a,c){this.x*=a;this.y*=c;return this};cr.vector2=a;cr.segments_intersect=function(a,c,d,f,m,b,k,p){if(a<d){var w=a;var t=d}else w=d,t=a;if(m<k){var e=m;var q=k}else e=k,q=m;if(t<e||w>q)return!1;c<f?(w=c,t=f):(w=f,t=c);b<p?(e=b,q=p):(e=p,q=b);if(t<e||w>q)return!1;t=m-a+k-d;w=b-c+p-f;a=d-a;c=f-c;m=k-m;b=p-b;p=
cr.abs(c*m-b*a);return cr.abs(m*w-b*t)>p?!1:cr.abs(a*w-c*t)<=p};b.prototype.set=function(a,c,d,f){this.left=a;this.top=c;this.right=d;this.bottom=f};b.prototype.copy=function(a){this.left=a.left;this.top=a.top;this.right=a.right;this.bottom=a.bottom};b.prototype.width=function(){return this.right-this.left};b.prototype.height=function(){return this.bottom-this.top};b.prototype.offset=function(a,c){this.left+=a;this.top+=c;this.right+=a;this.bottom+=c;return this};b.prototype.normalize=function(){if(this.left>
this.right){var a=this.left;this.left=this.right;this.right=a}this.top>this.bottom&&(a=this.top,this.top=this.bottom,this.bottom=a)};b.prototype.intersects_rect=function(a){return!(a.right<this.left||a.bottom<this.top||a.left>this.right||a.top>this.bottom)};b.prototype.intersects_rect_off=function(a,c,d){return!(a.right+c<this.left||a.bottom+d<this.top||a.left+c>this.right||a.top+d>this.bottom)};b.prototype.contains_pt=function(a,c){return a>=this.left&&a<=this.right&&c>=this.top&&c<=this.bottom};
b.prototype.equals=function(a){return this.left===a.left&&this.top===a.top&&this.right===a.right&&this.bottom===a.bottom};cr.rect=b;e.prototype.set_from_rect=function(a){this.tlx=a.left;this.tly=a.top;this.trx=a.right;this.try_=a.top;this.brx=a.right;this.bry=a.bottom;this.blx=a.left;this.bly=a.bottom};e.prototype.set_from_rotated_rect=function(a,c){if(0===c)this.set_from_rect(a);else{var d=Math.sin(c),f=Math.cos(c);c=a.left*d;var m=a.top*d,b=a.right*d;d*=a.bottom;var k=a.left*f,p=a.top*f,w=a.right*
f;a=a.bottom*f;this.tlx=k-m;this.tly=p+c;this.trx=w-m;this.try_=p+b;this.brx=w-d;this.bry=a+b;this.blx=k-d;this.bly=a+c}};e.prototype.offset=function(a,c){this.tlx+=a;this.tly+=c;this.trx+=a;this.try_+=c;this.brx+=a;this.bry+=c;this.blx+=a;this.bly+=c;return this};var z=0,x=0;e.prototype.bounding_box=function(a){l(this.tlx,this.trx,this.brx,this.blx);a.left=z;a.right=x;l(this.tly,this.try_,this.bry,this.bly);a.top=z;a.bottom=x};e.prototype.contains_pt=function(a,c){var d=this.tlx,f=this.tly,m=this.trx-
d,b=this.try_-f,k=this.brx-d,p=this.bry-f;a-=d;c-=f;var w=m*m+b*b,t=m*k+b*p;b=m*a+b*c;var e=k*k+p*p,q=k*a+p*c,g=1/(w*e-t*t);m=(e*b-t*q)*g;w=(w*q-t*b)*g;if(0<=m&&0<w&&1>m+w)return!0;m=this.blx-d;b=this.bly-f;w=m*m+b*b;t=m*k+b*p;b=m*a+b*c;g=1/(w*e-t*t);m=(e*b-t*q)*g;w=(w*q-t*b)*g;return 0<=m&&0<w&&1>m+w};e.prototype.at=function(a,c){if(c)switch(a){case 0:return this.tlx;case 1:return this.trx;case 2:return this.brx;case 3:return this.blx;case 4:return this.tlx;default:return this.tlx}else switch(a){case 0:return this.tly;
case 1:return this.try_;case 2:return this.bry;case 3:return this.bly;case 4:return this.tly;default:return this.tly}};e.prototype.midX=function(){return(this.tlx+this.trx+this.brx+this.blx)/4};e.prototype.midY=function(){return(this.tly+this.try_+this.bry+this.bly)/4};e.prototype.intersects_segment=function(a,c,d,f){if(this.contains_pt(a,c)||this.contains_pt(d,f))return!0;var m;for(m=0;4>m;m++){var b=this.at(m,!0);var k=this.at(m,!1);var p=this.at(m+1,!0);var w=this.at(m+1,!1);if(cr.segments_intersect(a,
c,d,f,b,k,p,w))return!0}return!1};e.prototype.intersects_quad=function(a){var c=a.midX(),d=a.midY();if(this.contains_pt(c,d))return!0;c=this.midX();d=this.midY();if(a.contains_pt(c,d))return!0;var f,m;for(f=0;4>f;f++)for(m=0;4>m;m++){c=this.at(f,!0);d=this.at(f,!1);var b=this.at(f+1,!0);var k=this.at(f+1,!1);var p=a.at(m,!0);var w=a.at(m,!1);var t=a.at(m+1,!0);var e=a.at(m+1,!1);if(cr.segments_intersect(c,d,b,k,p,w,t,e))return!0}return!1};cr.quad=e;cr.RGB=function(a,c,d){return Math.max(Math.min(a,
255),0)|Math.max(Math.min(c,255),0)<<8|Math.max(Math.min(d,255),0)<<16};cr.GetRValue=function(a){return a&255};cr.GetGValue=function(a){return(a&65280)>>8};cr.GetBValue=function(a){return(a&16711680)>>16};cr.shallowCopy=function(a,c,d){for(var f in c)c.hasOwnProperty(f)&&(a[f]=c[f]);return a};cr.arrayRemove=function(a,c){var d;c=cr.floor(c);if(!(0>c||c>=a.length)){for(d=a.length-1;c<d;c++)a[c]=a[c+1];cr.truncateArray(a,d)}};cr.truncateArray=function(a,c){a.length=c};cr.clearArray=function(a){cr.truncateArray(a,
0)};cr.shallowAssignArray=function(a,c){cr.clearArray(a);var d;var f=0;for(d=c.length;f<d;++f)a[f]=c[f]};cr.appendArray=function(a,c){a.push.apply(a,c)};cr.fastIndexOf=function(a,c){var d;var f=0;for(d=a.length;f<d;++f)if(a[f]===c)return f;return-1};cr.arrayFindRemove=function(a,c){c=cr.fastIndexOf(a,c);-1!==c&&cr.arrayRemove(a,c)};cr.clamp=function(a,c,d){return a<c?c:a>d?d:a};cr.to_radians=function(a){return a/(180/cr.PI)};cr.to_degrees=function(a){return 180/cr.PI*a};cr.clamp_angle_degrees=function(a){a%=
360;0>a&&(a+=360);return a};cr.clamp_angle=function(a){a%=2*cr.PI;0>a&&(a+=2*cr.PI);return a};cr.to_clamped_degrees=function(a){return cr.clamp_angle_degrees(cr.to_degrees(a))};cr.to_clamped_radians=function(a){return cr.clamp_angle(cr.to_radians(a))};cr.angleTo=function(a,c,d,f){return Math.atan2(f-c,d-a)};cr.angleDiff=function(a,c){if(a===c)return 0;a=Math.sin(a)*Math.sin(c)+Math.cos(a)*Math.cos(c);return 1<=a?0:-1>=a?cr.PI:Math.acos(a)};cr.angleRotate=function(a,c,d){var f=Math.sin(a),m=Math.cos(a),
b=Math.sin(c),k=Math.cos(c);return Math.acos(f*b+m*k)>d?0<m*b-f*k?cr.clamp_angle(a+d):cr.clamp_angle(a-d):cr.clamp_angle(c)};cr.angleClockwise=function(a,c){return 0>=Math.cos(a)*Math.sin(c)-Math.sin(a)*Math.cos(c)};cr.rotatePtAround=function(a,c,d,f,m,b){if(0===d)return b?a:c;var k=Math.sin(d);d=Math.cos(d);a-=f;c-=m;var p=a*k;a=a*d-c*k;return b?a+f:c*d+p+m};cr.distanceTo=function(a,c,d,f){a=d-a;c=f-c;return Math.sqrt(a*a+c*c)};cr.xor=function(a,c){return!a!==!c};cr.lerp=function(a,c,d){return a+
(c-a)*d};cr.unlerp=function(a,c,d){return a===c?0:(d-a)/(c-a)};cr.anglelerp=function(a,c,d){var f=cr.angleDiff(a,c);return cr.angleClockwise(c,a)?a+f*d:a-f*d};cr.qarp=function(a,c,d,f){return cr.lerp(cr.lerp(a,c,f),cr.lerp(c,d,f),f)};cr.cubic=function(a,c,d,f,m){return cr.lerp(cr.qarp(a,c,d,m),cr.qarp(c,d,f,m),m)};cr.cosp=function(a,c,d){return(a+c+(a-c)*Math.cos(d*Math.PI))/2};cr.hasAnyOwnProperty=function(a){for(var c in a)if(a.hasOwnProperty(c))return!0;return!1};cr.wipe=function(a){for(var c in a)a.hasOwnProperty(c)&&
delete a[c]};var C=+new Date;cr.performance_now=function(){if("undefined"!==typeof window.performance){var a=window.performance;if("undefined"!==typeof a.now)return a.now();if("undefined"!==typeof a.webkitNow)return a.webkitNow();if("undefined"!==typeof a.mozNow)return a.mozNow();if("undefined"!==typeof a.msNow)return a.msNow()}return Date.now()-C};var v=!1,t=v=!1,A=!1;"undefined"!==typeof window&&(v=/chrome/i.test(navigator.userAgent)||/chromium/i.test(navigator.userAgent),v=!v&&/safari/i.test(navigator.userAgent),
t=/(iphone|ipod|ipad)/i.test(navigator.userAgent),A=window.c2ejecta);var B=!v&&!A&&!t&&"undefined"!==typeof Set&&"undefined"!==typeof Set.prototype.forEach;h.prototype.contains=function(a){return this.isEmpty()?!1:B?this.s.has(a):this.items&&this.items.hasOwnProperty(a)};h.prototype.add=function(a){if(B)this.s.has(a)||(this.s.add(a),this.cache_valid=!1);else{var c=a.toString(),d=this.items;d?d.hasOwnProperty(c)||(d[c]=a,this.item_count++,this.cache_valid=!1):(this.items={},this.items[c]=a,this.item_count=
1,this.cache_valid=!1)}};h.prototype.remove=function(a){if(!this.isEmpty())if(B)this.s.has(a)&&(this.s["delete"](a),this.cache_valid=!1);else if(this.items){a=a.toString();var c=this.items;c.hasOwnProperty(a)&&(delete c[a],this.item_count--,this.cache_valid=!1)}};h.prototype.clear=function(){this.isEmpty()||(B?this.s.clear():(this.items=null,this.item_count=0),cr.clearArray(this.values_cache),this.cache_valid=!0)};h.prototype.isEmpty=function(){return 0===this.count()};h.prototype.count=function(){return B?
this.s.size:this.item_count};var E=null,m=0;h.prototype.update_cache=function(){if(!this.cache_valid){if(B)cr.clearArray(this.values_cache),E=this.values_cache,m=0,this.s.forEach(n),E=null,m=0;else{var a=this.values_cache;cr.clearArray(a);var c,d=0,f=this.items;if(f)for(c in f)f.hasOwnProperty(c)&&(a[d++]=f[c])}this.cache_valid=!0}};h.prototype.valuesRef=function(){this.update_cache();return this.values_cache};cr.ObjectSet=h;var p=new cr.ObjectSet;cr.removeArrayDuplicates=function(a){var c;var d=
0;for(c=a.length;d<c;++d)p.add(a[d]);cr.shallowAssignArray(a,p.valuesRef());p.clear()};cr.arrayRemoveAllFromObjectSet=function(a,c){B?cr.arrayRemoveAll_set(a,c.s):cr.arrayRemoveAll_arr(a,c.valuesRef())};cr.arrayRemoveAll_set=function(a,c){var d,f;var m=d=0;for(f=a.length;d<f;++d){var b=a[d];c.has(b)||(a[m++]=b)}cr.truncateArray(a,m)};cr.arrayRemoveAll_arr=function(a,c){var d,f;var m=d=0;for(f=a.length;d<f;++d){var b=a[d];-1===cr.fastIndexOf(c,b)&&(a[m++]=b)}cr.truncateArray(a,m)};g.prototype.add=
function(a){this.y=a-this.c;this.t=this.sum+this.y;this.c=this.t-this.sum-this.y;this.sum=this.t};g.prototype.reset=function(){this.sum=this.t=this.y=this.c=0};cr.KahanAdder=g;cr.regexp_escape=function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")};d.prototype.set_pts=function(a){this.pts_array=a;this.pts_count=a.length/2;this.pts_cache.length=a.length;this.cache_height=this.cache_width=-1;this.cache_angle=0};d.prototype.is_empty=function(){return!this.pts_array.length};d.prototype.update_bbox=
function(){for(var a=this.pts_cache,c=a[0],d=c,f=a[1],m=f,b,k,p=1,w=this.pts_count;p<w;++p)k=2*p,b=a[k],k=a[k+1],b<c&&(c=b),b>d&&(d=b),k<f&&(f=k),k>m&&(m=k);this.bboxLeft=c;this.bboxRight=d;this.bboxTop=f;this.bboxBottom=m};d.prototype.set_from_rect=function(a,c,d){this.pts_cache.length=8;this.pts_count=4;var f=this.pts_cache;f[0]=a.left-c;f[1]=a.top-d;f[2]=a.right-c;f[3]=a.top-d;f[4]=a.right-c;f[5]=a.bottom-d;f[6]=a.left-c;f[7]=a.bottom-d;this.cache_width=a.right-a.left;this.cache_height=a.bottom-
a.top;this.update_bbox()};d.prototype.set_from_quad=function(a,c,d,f,m){this.pts_cache.length=8;this.pts_count=4;var b=this.pts_cache;b[0]=a.tlx-c;b[1]=a.tly-d;b[2]=a.trx-c;b[3]=a.try_-d;b[4]=a.brx-c;b[5]=a.bry-d;b[6]=a.blx-c;b[7]=a.bly-d;this.cache_width=f;this.cache_height=m;this.update_bbox()};d.prototype.set_from_poly=function(a){this.pts_count=a.pts_count;cr.shallowAssignArray(this.pts_cache,a.pts_cache);this.bboxLeft=a.bboxLeft;this.bboxTop=a.bboxTop;this.bboxRight=a.bboxRight;this.bboxBottom=
a.bboxBottom};d.prototype.cache_poly=function(a,c,d){if(this.cache_width!==a||this.cache_height!==c||this.cache_angle!==d){this.cache_width=a;this.cache_height=c;this.cache_angle=d;var f,m=0,b=1,k=this.pts_array,p=this.pts_cache;0!==d&&(m=Math.sin(d),b=Math.cos(d));d=0;for(f=this.pts_count;d<f;d++){var w=2*d;var t=w+1;var e=k[w]*a;var q=k[t]*c;p[w]=e*b-q*m;p[t]=q*b+e*m}this.update_bbox()}};d.prototype.contains_pt=function(a,c){var d=this.pts_cache;if(a===d[0]&&c===d[1])return!0;var f,m=this.pts_count,
b=this.bboxLeft-110,k=this.bboxTop-101,p=this.bboxRight+131,w=this.bboxBottom+120,t=0,e=0;for(f=0;f<m;f++){var q=2*f;var g=(f+1)%m*2;var r=d[q];q=d[q+1];var v=d[g];g=d[g+1];cr.segments_intersect(b,k,a,c,r,q,v,g)&&t++;cr.segments_intersect(p,w,a,c,r,q,v,g)&&e++}return 1===t%2||1===e%2};d.prototype.intersects_poly=function(a,c,d){var f=a.pts_cache,m=this.pts_cache;if(this.contains_pt(f[0]+c,f[1]+d)||a.contains_pt(m[0]-c,m[1]-d))return!0;var b,k;var p=0;for(b=this.pts_count;p<b;p++){var w=2*p;var t=
(p+1)%b*2;var e=m[w];w=m[w+1];var q=m[t];var g=m[t+1];t=0;for(k=a.pts_count;t<k;t++){var r=2*t;var v=(t+1)%k*2;var n=f[r]+c;r=f[r+1]+d;var h=f[v]+c;v=f[v+1]+d;if(cr.segments_intersect(e,w,q,g,n,r,h,v))return!0}}return!1};d.prototype.intersects_segment=function(a,c,d,f,m,b){var k=this.pts_cache;if(this.contains_pt(d-a,f-c))return!0;var p;var w=0;for(p=this.pts_count;w<p;w++){var t=2*w;var e=(w+1)%p*2;var q=k[t]+a;t=k[t+1]+c;var g=k[e]+a;e=k[e+1]+c;if(cr.segments_intersect(d,f,m,b,q,t,g,e))return!0}return!1};
d.prototype.mirror=function(a){var c;var d=0;for(c=this.pts_count;d<c;++d){var f=2*d;this.pts_cache[f]=2*a-this.pts_cache[f]}};d.prototype.flip=function(a){var c;var d=0;for(c=this.pts_count;d<c;++d){var f=2*d+1;this.pts_cache[f]=2*a-this.pts_cache[f]}};d.prototype.diag=function(){var a;var c=0;for(a=this.pts_count;c<a;++c){var d=2*c;var f=d+1;var m=this.pts_cache[d];this.pts_cache[d]=this.pts_cache[f];this.pts_cache[f]=m}};cr.CollisionPoly=d;k.prototype.totalCellCount=0;k.prototype.getCell=function(a,
c,d){var f=this.cells[a];return f?(f=f[c])?f:d?(f=r(this,a,c),this.cells[a][c]=f):null:d?(f=r(this,a,c),this.cells[a]={},this.cells[a][c]=f):null};k.prototype.XToCell=function(a){return cr.floor(a/this.cellwidth)};k.prototype.YToCell=function(a){return cr.floor(a/this.cellheight)};k.prototype.update=function(a,c,d){var f,m,b;if(c){var p=c.left;for(f=c.right;p<=f;++p){var t=c.top;for(m=c.bottom;t<=m;++t)if(!d||!d.contains_pt(p,t))if(b=this.getCell(p,t,!1))b.remove(a),b.isEmpty()&&(k.prototype.totalCellCount--,
b.objects.clear(),1E3>K.length&&K.push(b),this.cells[p][t]=null)}}if(d)for(p=d.left,f=d.right;p<=f;++p)for(t=d.top,m=d.bottom;t<=m;++t)c&&c.contains_pt(p,t)||this.getCell(p,t,!0).insert(a)};k.prototype.queryRange=function(a,c){var d,f;var m=this.XToCell(a.left);var b=this.YToCell(a.top);var k=this.XToCell(a.right);for(d=this.YToCell(a.bottom);m<=k;++m)for(a=b;a<=d;++a)(f=this.getCell(m,a,!1))&&f.dump(c)};cr.SparseGrid=k;u.prototype.totalCellCount=0;u.prototype.getCell=function(a,c,d){var m=this.cells[a];
return m?(m=m[c])?m:d?(m=f(this,a,c),this.cells[a][c]=m):null:d?(m=f(this,a,c),this.cells[a]={},this.cells[a][c]=m):null};u.prototype.XToCell=function(a){return cr.floor(a/this.cellwidth)};u.prototype.YToCell=function(a){return cr.floor(a/this.cellheight)};u.prototype.update=function(a,c,d){var f,m,b;if(c){var k=c.left;for(f=c.right;k<=f;++k){var p=c.top;for(m=c.bottom;p<=m;++p)if(!d||!d.contains_pt(k,p))if(b=this.getCell(k,p,!1))b.remove(a),b.isEmpty()&&(u.prototype.totalCellCount--,b.reset(),1E3>
I.length&&I.push(b),this.cells[k][p]=null)}}if(d)for(k=d.left,f=d.right;k<=f;++k)for(p=d.top,m=d.bottom;p<=m;++p)c&&c.contains_pt(k,p)||this.getCell(k,p,!0).insert(a)};u.prototype.queryRange=function(a,c,d,f,m){var b,k;a=this.XToCell(a);c=this.YToCell(c);d=this.XToCell(d);for(b=this.YToCell(f);a<=d;++a)for(f=c;f<=b;++f)(k=this.getCell(a,f,!1))&&k.dump(m)};u.prototype.markRangeChanged=function(a){var c,d;var f=a.left;var m=a.top;var b=a.right;for(c=a.bottom;f<=b;++f)for(a=m;a<=c;++a)if(d=this.getCell(f,
a,!1))d.is_sorted=!1};cr.RenderGrid=u;var K=[];c.prototype.isEmpty=function(){return this.objects.isEmpty()};c.prototype.insert=function(a){this.objects.add(a)};c.prototype.remove=function(a){this.objects.remove(a)};c.prototype.dump=function(a){cr.appendArray(a,this.objects.valuesRef())};cr.GridCell=c;var I=[];q.prototype.isEmpty=function(){if(!this.objects.length)return!0;if(this.objects.length>this.pending_removal.count())return!1;this.flush_pending();return!0};q.prototype.insert=function(a){this.pending_removal.contains(a)?
(this.pending_removal.remove(a),this.pending_removal.isEmpty()&&(this.any_pending_removal=!1)):this.objects.length?(this.objects[this.objects.length-1].get_zindex()>a.get_zindex()&&(this.is_sorted=!1),this.objects.push(a)):(this.objects.push(a),this.is_sorted=!0)};q.prototype.remove=function(a){this.pending_removal.add(a);this.any_pending_removal=!0;30<=this.pending_removal.count()&&this.flush_pending()};q.prototype.flush_pending=function(){this.any_pending_removal&&(this.pending_removal.count()===
this.objects.length?this.reset():(cr.arrayRemoveAllFromObjectSet(this.objects,this.pending_removal),this.pending_removal.clear(),this.any_pending_removal=!1))};q.prototype.ensure_sorted=function(){this.is_sorted||(this.objects.sort(y),this.is_sorted=!0)};q.prototype.reset=function(){cr.clearArray(this.objects);this.is_sorted=!0;this.pending_removal.clear();this.any_pending_removal=!1};q.prototype.dump=function(a){this.flush_pending();this.ensure_sorted();this.objects.length&&a.push(this.objects)};
cr.RenderCell=q;var M="lighter xor copy destination-over source-in destination-in source-out destination-out source-atop destination-atop".split(" ");cr.effectToCompositeOp=function(a){return 0>=a||11<=a?"source-over":M[a-1]};cr.setGLBlend=function(a,c,d){if(d)switch(a.srcBlend=d.ONE,a.destBlend=d.ONE_MINUS_SRC_ALPHA,c){case 1:a.srcBlend=d.ONE;a.destBlend=d.ONE;break;case 3:a.srcBlend=d.ONE;a.destBlend=d.ZERO;break;case 4:a.srcBlend=d.ONE_MINUS_DST_ALPHA;a.destBlend=d.ONE;break;case 5:a.srcBlend=
d.DST_ALPHA;a.destBlend=d.ZERO;break;case 6:a.srcBlend=d.ZERO;a.destBlend=d.SRC_ALPHA;break;case 7:a.srcBlend=d.ONE_MINUS_DST_ALPHA;a.destBlend=d.ZERO;break;case 8:a.srcBlend=d.ZERO;a.destBlend=d.ONE_MINUS_SRC_ALPHA;break;case 9:a.srcBlend=d.DST_ALPHA;a.destBlend=d.ONE_MINUS_SRC_ALPHA;break;case 10:a.srcBlend=d.ONE_MINUS_DST_ALPHA,a.destBlend=d.SRC_ALPHA}};cr.round6dp=function(a){return Math.round(1E6*a)/1E6};cr.equals_nocase=function(a,c){return"string"!==typeof a||"string"!==typeof c||a.length!==
c.length?!1:a===c?!0:a.toLowerCase()===c.toLowerCase()};cr.isCanvasInputEvent=function(a){a=a.target;return!a||a===document||a===window||document&&document.body&&a===document.body||cr.equals_nocase(a.tagName,"canvas")?!0:!1}})();var MatrixArray="undefined"!==typeof Float32Array?Float32Array:Array,glMatrixArrayType=MatrixArray,vec3={},mat3={},mat4={},quat4={};vec3.create=function(a){var b=new MatrixArray(3);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2]);return b};
vec3.set=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};vec3.add=function(a,b,e){if(!e||a===e)return a[0]+=b[0],a[1]+=b[1],a[2]+=b[2],a;e[0]=a[0]+b[0];e[1]=a[1]+b[1];e[2]=a[2]+b[2];return e};vec3.subtract=function(a,b,e){if(!e||a===e)return a[0]-=b[0],a[1]-=b[1],a[2]-=b[2],a;e[0]=a[0]-b[0];e[1]=a[1]-b[1];e[2]=a[2]-b[2];return e};vec3.negate=function(a,b){b||(b=a);b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b};
vec3.scale=function(a,b,e){if(!e||a===e)return a[0]*=b,a[1]*=b,a[2]*=b,a;e[0]=a[0]*b;e[1]=a[1]*b;e[2]=a[2]*b;return e};vec3.normalize=function(a,b){b||(b=a);var e=a[0],l=a[1];a=a[2];var h=Math.sqrt(e*e+l*l+a*a);if(h){if(1===h)return b[0]=e,b[1]=l,b[2]=a,b}else return b[0]=0,b[1]=0,b[2]=0,b;h=1/h;b[0]=e*h;b[1]=l*h;b[2]=a*h;return b};vec3.cross=function(a,b,e){e||(e=a);var l=a[0],h=a[1];a=a[2];var n=b[0],g=b[1];b=b[2];e[0]=h*b-a*g;e[1]=a*n-l*b;e[2]=l*g-h*n;return e};
vec3.length=function(a){var b=a[0],e=a[1];a=a[2];return Math.sqrt(b*b+e*e+a*a)};vec3.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};vec3.direction=function(a,b,e){e||(e=a);var l=a[0]-b[0],h=a[1]-b[1];a=a[2]-b[2];b=Math.sqrt(l*l+h*h+a*a);if(!b)return e[0]=0,e[1]=0,e[2]=0,e;b=1/b;e[0]=l*b;e[1]=h*b;e[2]=a*b;return e};vec3.lerp=function(a,b,e,l){l||(l=a);l[0]=a[0]+e*(b[0]-a[0]);l[1]=a[1]+e*(b[1]-a[1]);l[2]=a[2]+e*(b[2]-a[2]);return l};vec3.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+"]"};
mat3.create=function(a){var b=new MatrixArray(9);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8]);return b};mat3.set=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};mat3.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};
mat3.transpose=function(a,b){if(!b||a===b){b=a[1];var e=a[2],l=a[5];a[1]=a[3];a[2]=a[6];a[3]=b;a[5]=a[7];a[6]=e;a[7]=l;return a}b[0]=a[0];b[1]=a[3];b[2]=a[6];b[3]=a[1];b[4]=a[4];b[5]=a[7];b[6]=a[2];b[7]=a[5];b[8]=a[8];return b};mat3.toMat4=function(a,b){b||(b=mat4.create());b[15]=1;b[14]=0;b[13]=0;b[12]=0;b[11]=0;b[10]=a[8];b[9]=a[7];b[8]=a[6];b[7]=0;b[6]=a[5];b[5]=a[4];b[4]=a[3];b[3]=0;b[2]=a[2];b[1]=a[1];b[0]=a[0];return b};
mat3.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+"]"};mat4.create=function(a){var b=new MatrixArray(16);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);return b};
mat4.set=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};mat4.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};
mat4.transpose=function(a,b){if(!b||a===b){b=a[1];var e=a[2],l=a[3],h=a[6],n=a[7],g=a[11];a[1]=a[4];a[2]=a[8];a[3]=a[12];a[4]=b;a[6]=a[9];a[7]=a[13];a[8]=e;a[9]=h;a[11]=a[14];a[12]=l;a[13]=n;a[14]=g;return a}b[0]=a[0];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=a[1];b[5]=a[5];b[6]=a[9];b[7]=a[13];b[8]=a[2];b[9]=a[6];b[10]=a[10];b[11]=a[14];b[12]=a[3];b[13]=a[7];b[14]=a[11];b[15]=a[15];return b};
mat4.determinant=function(a){var b=a[0],e=a[1],l=a[2],h=a[3],n=a[4],g=a[5],d=a[6],k=a[7],u=a[8],r=a[9],c=a[10],f=a[11],q=a[12],y=a[13],z=a[14];a=a[15];return q*r*d*h-u*y*d*h-q*g*c*h+n*y*c*h+u*g*z*h-n*r*z*h-q*r*l*k+u*y*l*k+q*e*c*k-b*y*c*k-u*e*z*k+b*r*z*k+q*g*l*f-n*y*l*f-q*e*d*f+b*y*d*f+n*e*z*f-b*g*z*f-u*g*l*a+n*r*l*a+u*e*d*a-b*r*d*a-n*e*c*a+b*g*c*a};
mat4.inverse=function(a,b){b||(b=a);var e=a[0],l=a[1],h=a[2],n=a[3],g=a[4],d=a[5],k=a[6],u=a[7],r=a[8],c=a[9],f=a[10],q=a[11],y=a[12],z=a[13],x=a[14];a=a[15];var C=e*d-l*g,v=e*k-h*g,t=e*u-n*g,A=l*k-h*d,B=l*u-n*d,E=h*u-n*k,m=r*z-c*y,p=r*x-f*y,K=r*a-q*y,I=c*x-f*z,M=c*a-q*z,O=f*a-q*x,G=1/(C*O-v*M+t*I+A*K-B*p+E*m);b[0]=(d*O-k*M+u*I)*G;b[1]=(-l*O+h*M-n*I)*G;b[2]=(z*E-x*B+a*A)*G;b[3]=(-c*E+f*B-q*A)*G;b[4]=(-g*O+k*K-u*p)*G;b[5]=(e*O-h*K+n*p)*G;b[6]=(-y*E+x*t-a*v)*G;b[7]=(r*E-f*t+q*v)*G;b[8]=(g*M-d*K+u*m)*
G;b[9]=(-e*M+l*K-n*m)*G;b[10]=(y*B-z*t+a*C)*G;b[11]=(-r*B+c*t-q*C)*G;b[12]=(-g*I+d*p-k*m)*G;b[13]=(e*I-l*p+h*m)*G;b[14]=(-y*A+z*v-x*C)*G;b[15]=(r*A-c*v+f*C)*G;return b};mat4.toRotationMat=function(a,b){b||(b=mat4.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};
mat4.toMat3=function(a,b){b||(b=mat3.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[4];b[4]=a[5];b[5]=a[6];b[6]=a[8];b[7]=a[9];b[8]=a[10];return b};mat4.toInverseMat3=function(a,b){var e=a[0],l=a[1],h=a[2],n=a[4],g=a[5],d=a[6],k=a[8],u=a[9];a=a[10];var r=a*g-d*u,c=-a*n+d*k,f=u*n-g*k,q=e*r+l*c+h*f;if(!q)return null;q=1/q;b||(b=mat3.create());b[0]=r*q;b[1]=(-a*l+h*u)*q;b[2]=(d*l-h*g)*q;b[3]=c*q;b[4]=(a*e-h*k)*q;b[5]=(-d*e+h*n)*q;b[6]=f*q;b[7]=(-u*e+l*k)*q;b[8]=(g*e-l*n)*q;return b};
mat4.multiply=function(a,b,e){e||(e=a);var l=a[0],h=a[1],n=a[2],g=a[3],d=a[4],k=a[5],u=a[6],r=a[7],c=a[8],f=a[9],q=a[10],y=a[11],z=a[12],x=a[13],C=a[14];a=a[15];var v=b[0],t=b[1],A=b[2],B=b[3],E=b[4],m=b[5],p=b[6],K=b[7],I=b[8],M=b[9],O=b[10],G=b[11],H=b[12],F=b[13],J=b[14];b=b[15];e[0]=v*l+t*d+A*c+B*z;e[1]=v*h+t*k+A*f+B*x;e[2]=v*n+t*u+A*q+B*C;e[3]=v*g+t*r+A*y+B*a;e[4]=E*l+m*d+p*c+K*z;e[5]=E*h+m*k+p*f+K*x;e[6]=E*n+m*u+p*q+K*C;e[7]=E*g+m*r+p*y+K*a;e[8]=I*l+M*d+O*c+G*z;e[9]=I*h+M*k+O*f+G*x;e[10]=I*
n+M*u+O*q+G*C;e[11]=I*g+M*r+O*y+G*a;e[12]=H*l+F*d+J*c+b*z;e[13]=H*h+F*k+J*f+b*x;e[14]=H*n+F*u+J*q+b*C;e[15]=H*g+F*r+J*y+b*a;return e};mat4.multiplyVec3=function(a,b,e){e||(e=b);var l=b[0],h=b[1];b=b[2];e[0]=a[0]*l+a[4]*h+a[8]*b+a[12];e[1]=a[1]*l+a[5]*h+a[9]*b+a[13];e[2]=a[2]*l+a[6]*h+a[10]*b+a[14];return e};
mat4.multiplyVec4=function(a,b,e){e||(e=b);var l=b[0],h=b[1],n=b[2];b=b[3];e[0]=a[0]*l+a[4]*h+a[8]*n+a[12]*b;e[1]=a[1]*l+a[5]*h+a[9]*n+a[13]*b;e[2]=a[2]*l+a[6]*h+a[10]*n+a[14]*b;e[3]=a[3]*l+a[7]*h+a[11]*n+a[15]*b;return e};
mat4.translate=function(a,b,e){var l=b[0],h=b[1];b=b[2];if(!e||a===e)return a[12]=a[0]*l+a[4]*h+a[8]*b+a[12],a[13]=a[1]*l+a[5]*h+a[9]*b+a[13],a[14]=a[2]*l+a[6]*h+a[10]*b+a[14],a[15]=a[3]*l+a[7]*h+a[11]*b+a[15],a;var n=a[0];var g=a[1];var d=a[2];var k=a[3];var u=a[4];var r=a[5];var c=a[6];var f=a[7];var q=a[8];var y=a[9];var z=a[10];var x=a[11];e[0]=n;e[1]=g;e[2]=d;e[3]=k;e[4]=u;e[5]=r;e[6]=c;e[7]=f;e[8]=q;e[9]=y;e[10]=z;e[11]=x;e[12]=n*l+u*h+q*b+a[12];e[13]=g*l+r*h+y*b+a[13];e[14]=d*l+c*h+z*b+a[14];
e[15]=k*l+f*h+x*b+a[15];return e};mat4.scale=function(a,b,e){var l=b[0],h=b[1];b=b[2];if(!e||a===e)return a[0]*=l,a[1]*=l,a[2]*=l,a[3]*=l,a[4]*=h,a[5]*=h,a[6]*=h,a[7]*=h,a[8]*=b,a[9]*=b,a[10]*=b,a[11]*=b,a;e[0]=a[0]*l;e[1]=a[1]*l;e[2]=a[2]*l;e[3]=a[3]*l;e[4]=a[4]*h;e[5]=a[5]*h;e[6]=a[6]*h;e[7]=a[7]*h;e[8]=a[8]*b;e[9]=a[9]*b;e[10]=a[10]*b;e[11]=a[11]*b;e[12]=a[12];e[13]=a[13];e[14]=a[14];e[15]=a[15];return e};
mat4.rotate=function(a,b,e,l){var h=e[0],n=e[1];e=e[2];var g=Math.sqrt(h*h+n*n+e*e);if(!g)return null;1!==g&&(g=1/g,h*=g,n*=g,e*=g);var d=Math.sin(b);var k=Math.cos(b);var u=1-k;b=a[0];g=a[1];var r=a[2];var c=a[3];var f=a[4];var q=a[5];var y=a[6];var z=a[7];var x=a[8];var C=a[9];var v=a[10];var t=a[11];var A=h*h*u+k;var B=n*h*u+e*d;var E=e*h*u-n*d;var m=h*n*u-e*d;var p=n*n*u+k;var K=e*n*u+h*d;var I=h*e*u+n*d;h=n*e*u-h*d;n=e*e*u+k;l?a!==l&&(l[12]=a[12],l[13]=a[13],l[14]=a[14],l[15]=a[15]):l=a;l[0]=
b*A+f*B+x*E;l[1]=g*A+q*B+C*E;l[2]=r*A+y*B+v*E;l[3]=c*A+z*B+t*E;l[4]=b*m+f*p+x*K;l[5]=g*m+q*p+C*K;l[6]=r*m+y*p+v*K;l[7]=c*m+z*p+t*K;l[8]=b*I+f*h+x*n;l[9]=g*I+q*h+C*n;l[10]=r*I+y*h+v*n;l[11]=c*I+z*h+t*n;return l};
mat4.rotateX=function(a,b,e){var l=Math.sin(b);b=Math.cos(b);var h=a[4],n=a[5],g=a[6],d=a[7],k=a[8],u=a[9],r=a[10],c=a[11];e?a!==e&&(e[0]=a[0],e[1]=a[1],e[2]=a[2],e[3]=a[3],e[12]=a[12],e[13]=a[13],e[14]=a[14],e[15]=a[15]):e=a;e[4]=h*b+k*l;e[5]=n*b+u*l;e[6]=g*b+r*l;e[7]=d*b+c*l;e[8]=h*-l+k*b;e[9]=n*-l+u*b;e[10]=g*-l+r*b;e[11]=d*-l+c*b;return e};
mat4.rotateY=function(a,b,e){var l=Math.sin(b);b=Math.cos(b);var h=a[0],n=a[1],g=a[2],d=a[3],k=a[8],u=a[9],r=a[10],c=a[11];e?a!==e&&(e[4]=a[4],e[5]=a[5],e[6]=a[6],e[7]=a[7],e[12]=a[12],e[13]=a[13],e[14]=a[14],e[15]=a[15]):e=a;e[0]=h*b+k*-l;e[1]=n*b+u*-l;e[2]=g*b+r*-l;e[3]=d*b+c*-l;e[8]=h*l+k*b;e[9]=n*l+u*b;e[10]=g*l+r*b;e[11]=d*l+c*b;return e};
mat4.rotateZ=function(a,b,e){var l=Math.sin(b);b=Math.cos(b);var h=a[0],n=a[1],g=a[2],d=a[3],k=a[4],u=a[5],r=a[6],c=a[7];e?a!==e&&(e[8]=a[8],e[9]=a[9],e[10]=a[10],e[11]=a[11],e[12]=a[12],e[13]=a[13],e[14]=a[14],e[15]=a[15]):e=a;e[0]=h*b+k*l;e[1]=n*b+u*l;e[2]=g*b+r*l;e[3]=d*b+c*l;e[4]=h*-l+k*b;e[5]=n*-l+u*b;e[6]=g*-l+r*b;e[7]=d*-l+c*b;return e};
mat4.frustum=function(a,b,e,l,h,n,g){g||(g=mat4.create());var d=b-a,k=l-e,u=n-h;g[0]=2*h/d;g[1]=0;g[2]=0;g[3]=0;g[4]=0;g[5]=2*h/k;g[6]=0;g[7]=0;g[8]=(b+a)/d;g[9]=(l+e)/k;g[10]=-(n+h)/u;g[11]=-1;g[12]=0;g[13]=0;g[14]=-(n*h*2)/u;g[15]=0;return g};mat4.perspective=function(a,b,e,l,h){a=e*Math.tan(a*Math.PI/360);b*=a;return mat4.frustum(-b,b,-a,a,e,l,h)};
mat4.ortho=function(a,b,e,l,h,n,g){g||(g=mat4.create());var d=b-a,k=l-e,u=n-h;g[0]=2/d;g[1]=0;g[2]=0;g[3]=0;g[4]=0;g[5]=2/k;g[6]=0;g[7]=0;g[8]=0;g[9]=0;g[10]=-2/u;g[11]=0;g[12]=-(a+b)/d;g[13]=-(l+e)/k;g[14]=-(n+h)/u;g[15]=1;return g};
mat4.lookAt=function(a,b,e,l){l||(l=mat4.create());var h=a[0],n=a[1];a=a[2];var g=e[0];var d=e[1];var k=e[2];e=b[1];var u=b[2];if(h===b[0]&&n===e&&a===u)return mat4.identity(l);e=h-b[0];u=n-b[1];var r=a-b[2];var c=1/Math.sqrt(e*e+u*u+r*r);e*=c;u*=c;r*=c;b=d*r-k*u;k=k*e-g*r;g=g*u-d*e;(c=Math.sqrt(b*b+k*k+g*g))?(c=1/c,b*=c,k*=c,g*=c):g=k=b=0;d=u*g-r*k;var f=r*b-e*g;var q=e*k-u*b;(c=Math.sqrt(d*d+f*f+q*q))?(c=1/c,d*=c,f*=c,q*=c):q=f=d=0;l[0]=b;l[1]=d;l[2]=e;l[3]=0;l[4]=k;l[5]=f;l[6]=u;l[7]=0;l[8]=g;
l[9]=q;l[10]=r;l[11]=0;l[12]=-(b*h+k*n+g*a);l[13]=-(d*h+f*n+q*a);l[14]=-(e*h+u*n+r*a);l[15]=1;return l};mat4.fromRotationTranslation=function(a,b,e){e||(e=mat4.create());var l=a[0],h=a[1],n=a[2],g=a[3],d=l+l,k=h+h,u=n+n;a=l*d;var r=l*k;l*=u;var c=h*k;h*=u;n*=u;d*=g;k*=g;g*=u;e[0]=1-(c+n);e[1]=r+g;e[2]=l-k;e[3]=0;e[4]=r-g;e[5]=1-(a+n);e[6]=h+d;e[7]=0;e[8]=l+k;e[9]=h-d;e[10]=1-(a+c);e[11]=0;e[12]=b[0];e[13]=b[1];e[14]=b[2];e[15]=1;return e};
mat4.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+"]"};quat4.create=function(a){var b=new MatrixArray(4);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]);return b};quat4.set=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};
quat4.calculateW=function(a,b){var e=a[0],l=a[1],h=a[2];if(!b||a===b)return a[3]=-Math.sqrt(Math.abs(1-e*e-l*l-h*h)),a;b[0]=e;b[1]=l;b[2]=h;b[3]=-Math.sqrt(Math.abs(1-e*e-l*l-h*h));return b};quat4.inverse=function(a,b){if(!b||a===b)return a[0]*=-1,a[1]*=-1,a[2]*=-1,a;b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=a[3];return b};quat4.length=function(a){var b=a[0],e=a[1],l=a[2];a=a[3];return Math.sqrt(b*b+e*e+l*l+a*a)};
quat4.normalize=function(a,b){b||(b=a);var e=a[0],l=a[1],h=a[2];a=a[3];var n=Math.sqrt(e*e+l*l+h*h+a*a);if(0===n)return b[0]=0,b[1]=0,b[2]=0,b[3]=0,b;n=1/n;b[0]=e*n;b[1]=l*n;b[2]=h*n;b[3]=a*n;return b};quat4.multiply=function(a,b,e){e||(e=a);var l=a[0],h=a[1],n=a[2];a=a[3];var g=b[0],d=b[1],k=b[2];b=b[3];e[0]=l*b+a*g+h*k-n*d;e[1]=h*b+a*d+n*g-l*k;e[2]=n*b+a*k+l*d-h*g;e[3]=a*b-l*g-h*d-n*k;return e};
quat4.multiplyVec3=function(a,b,e){e||(e=b);var l=b[0],h=b[1],n=b[2];b=a[0];var g=a[1],d=a[2];a=a[3];var k=a*l+g*n-d*h,u=a*h+d*l-b*n,r=a*n+b*h-g*l;l=-b*l-g*h-d*n;e[0]=k*a+l*-b+u*-d-r*-g;e[1]=u*a+l*-g+r*-b-k*-d;e[2]=r*a+l*-d+k*-g-u*-b;return e};quat4.toMat3=function(a,b){b||(b=mat3.create());var e=a[0],l=a[1],h=a[2];a=a[3];var n=e+e,g=l+l,d=h+h,k=e*n,u=e*g;e*=d;var r=l*g;l*=d;h*=d;n*=a;g*=a;a*=d;b[0]=1-(r+h);b[1]=u+a;b[2]=e-g;b[3]=u-a;b[4]=1-(k+h);b[5]=l+n;b[6]=e+g;b[7]=l-n;b[8]=1-(k+r);return b};
quat4.toMat4=function(a,b){b||(b=mat4.create());var e=a[0],l=a[1],h=a[2];a=a[3];var n=e+e,g=l+l,d=h+h,k=e*n,u=e*g;e*=d;var r=l*g;l*=d;h*=d;n*=a;g*=a;a*=d;b[0]=1-(r+h);b[1]=u+a;b[2]=e-g;b[3]=0;b[4]=u-a;b[5]=1-(k+h);b[6]=l+n;b[7]=0;b[8]=e+g;b[9]=l-n;b[10]=1-(k+r);b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};
quat4.slerp=function(a,b,e,l){l||(l=a);var h=a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3];if(1<=Math.abs(h))return l!==a&&(l[0]=a[0],l[1]=a[1],l[2]=a[2],l[3]=a[3]),l;var n=Math.acos(h);var g=Math.sqrt(1-h*h);if(.001>Math.abs(g))return l[0]=.5*a[0]+.5*b[0],l[1]=.5*a[1]+.5*b[1],l[2]=.5*a[2]+.5*b[2],l[3]=.5*a[3]+.5*b[3],l;h=Math.sin((1-e)*n)/g;e=Math.sin(e*n)/g;l[0]=a[0]*h+b[0]*e;l[1]=a[1]*h+b[1]*e;l[2]=a[2]*h+b[2]*e;l[3]=a[3]*h+b[3]*e;return l};
quat4.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"};
(function(){function a(a,b,e){this.isIE=/msie/i.test(navigator.userAgent)||/trident/i.test(navigator.userAgent);this.height=this.width=0;this.enableFrontToBack=!!e;this.isBatchInEarlyZPass=this.isEarlyZPass=!1;this.currentZ=0;this.zNear=1;this.zFar=1E3;this.zIncrement=(this.zFar-this.zNear)/32768;this.zA=this.zFar/(this.zFar-this.zNear);this.zB=this.zFar*this.zNear/(this.zNear-this.zFar);this.kzA=65536*this.zA;this.kzB=65536*this.zB;this.cam=vec3.create([0,0,100]);this.look=vec3.create([0,0,0]);this.up=
vec3.create([0,1,0]);this.worldScale=vec3.create([1,1,1]);this.enable_mipmaps=!0;this.matP=mat4.create();this.matMV=mat4.create();this.lastMV=mat4.create();this.currentMV=mat4.create();this.gl=a;this.version=0===this.gl.getParameter(this.gl.VERSION).indexOf("WebGL 2")?2:1;this.initState()}function b(a,b,e){this.gl=a;this.shaderProgram=b;this.name=e;this.locAPos=a.getAttribLocation(b,"aPos");this.locATex=a.getAttribLocation(b,"aTex");this.locMatP=a.getUniformLocation(b,"matP");this.locMatMV=a.getUniformLocation(b,
"matMV");this.locOpacity=a.getUniformLocation(b,"opacity");this.locColorFill=a.getUniformLocation(b,"colorFill");this.locSamplerFront=a.getUniformLocation(b,"samplerFront");this.locSamplerBack=a.getUniformLocation(b,"samplerBack");this.locDestStart=a.getUniformLocation(b,"destStart");this.locDestEnd=a.getUniformLocation(b,"destEnd");this.locSeconds=a.getUniformLocation(b,"seconds");this.locPixelWidth=a.getUniformLocation(b,"pixelWidth");this.locPixelHeight=a.getUniformLocation(b,"pixelHeight");this.locLayerScale=
a.getUniformLocation(b,"layerScale");this.locLayerAngle=a.getUniformLocation(b,"layerAngle");this.locViewOrigin=a.getUniformLocation(b,"viewOrigin");this.locScrollPos=a.getUniformLocation(b,"scrollPos");this.hasAnyOptionalUniforms=!!(this.locPixelWidth||this.locPixelHeight||this.locSeconds||this.locSamplerBack||this.locDestStart||this.locDestEnd||this.locLayerScale||this.locLayerAngle||this.locViewOrigin||this.locScrollPos);this.lpPixelHeight=this.lpPixelWidth=-999;this.lpOpacity=1;this.lpDestStartY=
this.lpDestStartX=0;this.lpLayerScale=this.lpDestEndY=this.lpDestEndX=1;this.lpSeconds=this.lpScrollPosY=this.lpScrollPosX=this.lpViewOriginY=this.lpViewOriginX=this.lpLayerAngle=0;this.lastCustomParams=[];this.lpMatMV=mat4.create();this.locOpacity&&a.uniform1f(this.locOpacity,1);this.locColorFill&&a.uniform4f(this.locColorFill,1,1,1,1);this.locSamplerFront&&a.uniform1i(this.locSamplerFront,0);this.locSamplerBack&&a.uniform1i(this.locSamplerBack,1);this.locDestStart&&a.uniform2f(this.locDestStart,
0,0);this.locDestEnd&&a.uniform2f(this.locDestEnd,1,1);this.locLayerScale&&a.uniform1f(this.locLayerScale,1);this.locLayerAngle&&a.uniform1f(this.locLayerAngle,0);this.locViewOrigin&&a.uniform2f(this.locViewOrigin,0,0);this.locScrollPos&&a.uniform2f(this.locScrollPos,0,0);this.locSeconds&&a.uniform1f(this.locSeconds,0);this.hasCurrentMatMV=!1}function e(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]&&a[9]===b[9]&&a[10]===
b[10]&&a[11]===b[11]&&a[12]===b[12]&&a[13]===b[13]&&a[14]===b[14]&&a[15]===b[15]}function l(a,b){this.type=a;this.glwrap=b;this.gl=b.gl;this.indexCount=this.startIndex=this.opacityParam=0;this.mat4param=this.texParam=null;this.shaderParams=[];cr.seal(this)}var h=mat4.create();a.prototype.initState=function(){var a=this.gl,b;this.lastOpacity=1;this.lastTexture1=this.lastTexture0=null;this.currentOpacity=1;a.clearColor(0,0,0,0);a.clear(a.COLOR_BUFFER_BIT);a.enable(a.BLEND);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);
a.disable(a.CULL_FACE);a.disable(a.STENCIL_TEST);a.disable(a.DITHER);this.enableFrontToBack?(a.enable(a.DEPTH_TEST),a.depthFunc(a.LEQUAL)):a.disable(a.DEPTH_TEST);this.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE);this.lastSrcBlend=a.ONE;this.lastDestBlend=a.ONE_MINUS_SRC_ALPHA;this.vertexData=new Float32Array(8E3*(this.enableFrontToBack?3:2));this.texcoordData=new Float32Array(16E3);this.pointData=new Float32Array(32E3);this.pointBuffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,this.pointBuffer);
a.bufferData(a.ARRAY_BUFFER,this.pointData.byteLength,a.DYNAMIC_DRAW);this.vertexBuffers=Array(4);this.texcoordBuffers=Array(4);for(b=0;4>b;b++)this.vertexBuffers[b]=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffers[b]),a.bufferData(a.ARRAY_BUFFER,this.vertexData.byteLength,a.DYNAMIC_DRAW),this.texcoordBuffers[b]=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.texcoordBuffers[b]),a.bufferData(a.ARRAY_BUFFER,this.texcoordData.byteLength,a.DYNAMIC_DRAW);this.curBuffer=0;this.indexBuffer=
a.createBuffer();a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer);for(var e=new Uint16Array(12E3),g=b=0;12E3>b;)e[b++]=g,e[b++]=g+1,e[b++]=g+2,e[b++]=g,e[b++]=g+2,e[b++]=g+3,g+=4;a.bufferData(a.ELEMENT_ARRAY_BUFFER,e,a.STATIC_DRAW);this.pointPtr=this.texPtr=this.vertexPtr=0;this.shaderPrograms=[];b=this.enableFrontToBack?"attribute highp vec3 aPos;\nattribute mediump vec2 aTex;\nvarying mediump vec2 vTex;\nuniform highp mat4 matP;\nuniform highp mat4 matMV;\nvoid main(void) {\n\tgl_Position = matP * matMV * vec4(aPos.x, aPos.y, aPos.z, 1.0);\n\tvTex = aTex;\n}":
"attribute highp vec2 aPos;\nattribute mediump vec2 aTex;\nvarying mediump vec2 vTex;\nuniform highp mat4 matP;\nuniform highp mat4 matMV;\nvoid main(void) {\n\tgl_Position = matP * matMV * vec4(aPos.x, aPos.y, 0.0, 1.0);\n\tvTex = aTex;\n}";e=this.createShaderProgram({src:"varying mediump vec2 vTex;\nuniform lowp float opacity;\nuniform lowp sampler2D samplerFront;\nvoid main(void) {\n\tgl_FragColor = texture2D(samplerFront, vTex);\n\tgl_FragColor *= opacity;\n}"},b,"<default>");this.shaderPrograms.push(e);
e=this.createShaderProgram({src:"uniform mediump sampler2D samplerFront;\nvarying lowp float opacity;\nvoid main(void) {\n\tgl_FragColor = texture2D(samplerFront, gl_PointCoord);\n\tgl_FragColor *= opacity;\n}"},"attribute vec4 aPos;\nvarying float opacity;\nuniform mat4 matP;\nuniform mat4 matMV;\nvoid main(void) {\n\tgl_Position = matP * matMV * vec4(aPos.x, aPos.y, 0.0, 1.0);\n\tgl_PointSize = aPos.z;\n\topacity = aPos.w;\n}","<point>");this.shaderPrograms.push(e);e=this.createShaderProgram({src:"varying mediump vec2 vTex;\nuniform lowp sampler2D samplerFront;\nvoid main(void) {\n\tif (texture2D(samplerFront, vTex).a < 1.0)\n\t\tdiscard;\n}"},
b,"<earlyz>");this.shaderPrograms.push(e);e=this.createShaderProgram({src:"uniform lowp vec4 colorFill;\nvoid main(void) {\n\tgl_FragColor = colorFill;\n}"},b,"<fill>");this.shaderPrograms.push(e);for(var c in cr.shaders)cr.shaders.hasOwnProperty(c)&&this.shaderPrograms.push(this.createShaderProgram(cr.shaders[c],b,c));a.activeTexture(a.TEXTURE0);a.bindTexture(a.TEXTURE_2D,null);this.batch=[];this.batchPtr=0;this.hasPointBatchTop=this.hasQuadBatchTop=!1;this.currentProgram=this.lastProgram=-1;this.currentShader=
null;this.fbo=a.createFramebuffer();this.depthBuffer=this.renderToTex=null;this.attachedDepthBuffer=!1;this.enableFrontToBack&&(this.depthBuffer=a.createRenderbuffer());this.tmpVec3=vec3.create([0,0,0]);a=a.getParameter(a.ALIASED_POINT_SIZE_RANGE);this.minPointSize=a[0];this.maxPointSize=a[1];2048<this.maxPointSize&&(this.maxPointSize=2048);this.switchProgram(0);cr.seal(this)};b.prototype.updateMatMV=function(a){e(this.lpMatMV,a)||(mat4.set(a,this.lpMatMV),this.gl.uniformMatrix4fv(this.locMatMV,!1,
a))};a.prototype.createShaderProgram=function(a,k,e){var d=this.gl,c=d.createShader(d.FRAGMENT_SHADER);d.shaderSource(c,a.src);d.compileShader(c);if(!d.getShaderParameter(c,d.COMPILE_STATUS))throw a=d.getShaderInfoLog(c),d.deleteShader(c),Error("error compiling fragment shader: "+a);var f=d.createShader(d.VERTEX_SHADER);d.shaderSource(f,k);d.compileShader(f);if(!d.getShaderParameter(f,d.COMPILE_STATUS))throw a=d.getShaderInfoLog(f),d.deleteShader(c),d.deleteShader(f),Error("error compiling vertex shader: "+
a);k=d.createProgram();d.attachShader(k,c);d.attachShader(k,f);d.linkProgram(k);if(!d.getProgramParameter(k,d.LINK_STATUS))throw a=d.getProgramInfoLog(k),d.deleteShader(c),d.deleteShader(f),d.deleteProgram(k),Error("error linking shader program: "+a);d.useProgram(k);d.deleteShader(c);d.deleteShader(f);c=new b(d,k,e);c.extendBoxHorizontal=a.extendBoxHorizontal||0;c.extendBoxVertical=a.extendBoxVertical||0;c.crossSampling=!!a.crossSampling;c.preservesOpaqueness=!!a.preservesOpaqueness;c.animated=!!a.animated;
c.parameters=a.parameters||[];a=0;for(f=c.parameters.length;a<f;a++)c.parameters[a][1]=d.getUniformLocation(k,c.parameters[a][0]),c.lastCustomParams.push(0),d.uniform1f(c.parameters[a][1],0);cr.seal(c);return c};a.prototype.getShaderIndex=function(a){var d;var b=0;for(d=this.shaderPrograms.length;b<d;b++)if(this.shaderPrograms[b].name===a)return b;return-1};a.prototype.project=function(a,b,e){var d=this.matMV,c=this.matP,f=[0,0,0,0,0,0,0,0];f[0]=d[0]*a+d[4]*b+d[12];f[1]=d[1]*a+d[5]*b+d[13];f[2]=d[2]*
a+d[6]*b+d[14];f[3]=d[3]*a+d[7]*b+d[15];f[4]=c[0]*f[0]+c[4]*f[1]+c[8]*f[2]+c[12]*f[3];f[5]=c[1]*f[0]+c[5]*f[1]+c[9]*f[2]+c[13]*f[3];f[6]=c[2]*f[0]+c[6]*f[1]+c[10]*f[2]+c[14]*f[3];f[7]=-f[2];0!==f[7]&&(f[7]=1/f[7],f[4]*=f[7],f[5]*=f[7],f[6]*=f[7],e[0]=(.5*f[4]+.5)*this.width,e[1]=(.5*f[5]+.5)*this.height)};a.prototype.setSize=function(a,b,e){if(this.width!==a||this.height!==b||e){this.endBatch();e=this.gl;this.width=a;this.height=b;e.viewport(0,0,a,b);mat4.lookAt(this.cam,this.look,this.up,this.matMV);
this.enableFrontToBack?(mat4.ortho(-a/2,a/2,b/2,-b/2,this.zNear,this.zFar,this.matP),this.worldScale[0]=1,this.worldScale[1]=1):(mat4.perspective(45,a/b,this.zNear,this.zFar,this.matP),a=[0,0],b=[0,0],this.project(0,0,a),this.project(1,1,b),this.worldScale[0]=1/(b[0]-a[0]),this.worldScale[1]=-1/(b[1]-a[1]));a=0;for(b=this.shaderPrograms.length;a<b;a++){var d=this.shaderPrograms[a];d.hasCurrentMatMV=!1;d.locMatP&&(e.useProgram(d.shaderProgram),e.uniformMatrix4fv(d.locMatP,!1,this.matP))}e.useProgram(this.shaderPrograms[this.lastProgram].shaderProgram);
e.bindTexture(e.TEXTURE_2D,null);e.activeTexture(e.TEXTURE1);e.bindTexture(e.TEXTURE_2D,null);e.activeTexture(e.TEXTURE0);this.lastTexture1=this.lastTexture0=null;this.depthBuffer&&(e.bindFramebuffer(e.FRAMEBUFFER,this.fbo),e.bindRenderbuffer(e.RENDERBUFFER,this.depthBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,this.width,this.height),this.attachedDepthBuffer||(e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,this.depthBuffer),this.attachedDepthBuffer=
!0),e.bindRenderbuffer(e.RENDERBUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null),this.renderToTex=null)}};a.prototype.resetModelView=function(){mat4.lookAt(this.cam,this.look,this.up,this.matMV);mat4.scale(this.matMV,this.worldScale)};a.prototype.translate=function(a,b){if(0!==a||0!==b)this.tmpVec3[0]=a,this.tmpVec3[1]=b,this.tmpVec3[2]=0,mat4.translate(this.matMV,this.tmpVec3)};a.prototype.scale=function(a,b){if(1!==a||1!==b)this.tmpVec3[0]=a,this.tmpVec3[1]=b,this.tmpVec3[2]=1,mat4.scale(this.matMV,
this.tmpVec3)};a.prototype.rotateZ=function(a){0!==a&&mat4.rotateZ(this.matMV,a)};a.prototype.updateModelView=function(){if(!e(this.lastMV,this.matMV)){var a=this.pushBatch();a.type=5;a.mat4param?mat4.set(this.matMV,a.mat4param):a.mat4param=mat4.create(this.matMV);mat4.set(this.matMV,this.lastMV);this.hasPointBatchTop=this.hasQuadBatchTop=!1}};a.prototype.setEarlyZIndex=function(a){this.enableFrontToBack&&(32760<a&&(a=32760),this.currentZ=this.cam[2]-this.zNear-a*this.zIncrement)};l.prototype.doSetEarlyZPass=
function(){var a=this.gl,b=this.glwrap;0!==this.startIndex?(a.depthMask(!0),a.colorMask(!1,!1,!1,!1),a.disable(a.BLEND),a.bindFramebuffer(a.FRAMEBUFFER,b.fbo),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,null,0),a.clear(a.DEPTH_BUFFER_BIT),a.bindFramebuffer(a.FRAMEBUFFER,null),b.isBatchInEarlyZPass=!0):(a.depthMask(!1),a.colorMask(!0,!0,!0,!0),a.enable(a.BLEND),b.isBatchInEarlyZPass=!1)};l.prototype.doSetTexture=function(){this.gl.bindTexture(this.gl.TEXTURE_2D,this.texParam)};
l.prototype.doSetTexture1=function(){var a=this.gl;a.activeTexture(a.TEXTURE1);a.bindTexture(a.TEXTURE_2D,this.texParam);a.activeTexture(a.TEXTURE0)};l.prototype.doSetOpacity=function(){var a=this.opacityParam,b=this.glwrap;b.currentOpacity=a;b=b.currentShader;b.locOpacity&&b.lpOpacity!==a&&(b.lpOpacity=a,this.gl.uniform1f(b.locOpacity,a))};l.prototype.doQuad=function(){this.gl.drawElements(this.gl.TRIANGLES,this.indexCount,this.gl.UNSIGNED_SHORT,this.startIndex)};l.prototype.doSetBlend=function(){this.gl.blendFunc(this.startIndex,
this.indexCount)};l.prototype.doUpdateModelView=function(){var a,b=this.glwrap.shaderPrograms,e=this.glwrap.currentProgram;var g=0;for(a=b.length;g<a;g++){var c=b[g];g===e&&c.locMatMV?(c.updateMatMV(this.mat4param),c.hasCurrentMatMV=!0):c.hasCurrentMatMV=!1}mat4.set(this.mat4param,this.glwrap.currentMV)};l.prototype.doRenderToTexture=function(){var a=this.gl,b=this.glwrap;this.texParam?(b.lastTexture1===this.texParam&&(a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,null),b.lastTexture1=null,
a.activeTexture(a.TEXTURE0)),a.bindFramebuffer(a.FRAMEBUFFER,b.fbo),b.isBatchInEarlyZPass||a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.texParam,0)):(b.enableFrontToBack||a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,null,0),a.bindFramebuffer(a.FRAMEBUFFER,null))};l.prototype.doClear=function(){var a=this.gl,b=this.startIndex;0===b?(a.clearColor(this.mat4param[0],this.mat4param[1],this.mat4param[2],this.mat4param[3]),a.clear(a.COLOR_BUFFER_BIT)):
1===b?(a.enable(a.SCISSOR_TEST),a.scissor(this.mat4param[0],this.mat4param[1],this.mat4param[2],this.mat4param[3]),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT),a.disable(a.SCISSOR_TEST)):a.clear(a.DEPTH_BUFFER_BIT)};l.prototype.doSetDepthTestEnabled=function(){var a=this.gl;0!==this.startIndex?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST)};l.prototype.doPoints=function(){var a=this.gl,b=this.glwrap;b.enableFrontToBack&&a.disable(a.DEPTH_TEST);var e=b.shaderPrograms[1];a.useProgram(e.shaderProgram);
!e.hasCurrentMatMV&&e.locMatMV&&(e.updateMatMV(b.currentMV),e.hasCurrentMatMV=!0);a.enableVertexAttribArray(e.locAPos);a.bindBuffer(a.ARRAY_BUFFER,b.pointBuffer);a.vertexAttribPointer(e.locAPos,4,a.FLOAT,!1,0,0);a.drawArrays(a.POINTS,this.startIndex/4,this.indexCount);e=b.currentShader;a.useProgram(e.shaderProgram);0<=e.locAPos&&(a.enableVertexAttribArray(e.locAPos),a.bindBuffer(a.ARRAY_BUFFER,b.vertexBuffers[b.curBuffer]),a.vertexAttribPointer(e.locAPos,b.enableFrontToBack?3:2,a.FLOAT,!1,0,0));0<=
e.locATex&&(a.enableVertexAttribArray(e.locATex),a.bindBuffer(a.ARRAY_BUFFER,b.texcoordBuffers[b.curBuffer]),a.vertexAttribPointer(e.locATex,2,a.FLOAT,!1,0,0));b.enableFrontToBack&&a.enable(a.DEPTH_TEST)};l.prototype.doSetProgram=function(){var a=this.gl,b=this.glwrap,e=b.shaderPrograms[this.startIndex];b.currentProgram=this.startIndex;b.currentShader=e;a.useProgram(e.shaderProgram);!e.hasCurrentMatMV&&e.locMatMV&&(e.updateMatMV(b.currentMV),e.hasCurrentMatMV=!0);e.locOpacity&&e.lpOpacity!==b.currentOpacity&&
(e.lpOpacity=b.currentOpacity,a.uniform1f(e.locOpacity,b.currentOpacity));0<=e.locAPos&&(a.enableVertexAttribArray(e.locAPos),a.bindBuffer(a.ARRAY_BUFFER,b.vertexBuffers[b.curBuffer]),a.vertexAttribPointer(e.locAPos,b.enableFrontToBack?3:2,a.FLOAT,!1,0,0));0<=e.locATex&&(a.enableVertexAttribArray(e.locATex),a.bindBuffer(a.ARRAY_BUFFER,b.texcoordBuffers[b.curBuffer]),a.vertexAttribPointer(e.locATex,2,a.FLOAT,!1,0,0))};l.prototype.doSetColor=function(){var a=this.mat4param;this.gl.uniform4f(this.glwrap.currentShader.locColorFill,
a[0],a[1],a[2],a[3])};l.prototype.doSetProgramParameters=function(){var a=this.glwrap.currentShader,b=this.gl;var e=this.mat4param;a.locSamplerBack&&this.glwrap.lastTexture1!==this.texParam&&(b.activeTexture(b.TEXTURE1),b.bindTexture(b.TEXTURE_2D,this.texParam),this.glwrap.lastTexture1=this.texParam,b.activeTexture(b.TEXTURE0));var g=e[0];a.locPixelWidth&&g!==a.lpPixelWidth&&(a.lpPixelWidth=g,b.uniform1f(a.locPixelWidth,g));g=e[1];a.locPixelHeight&&g!==a.lpPixelHeight&&(a.lpPixelHeight=g,b.uniform1f(a.locPixelHeight,
g));g=e[2];var c=e[3];!a.locDestStart||g===a.lpDestStartX&&c===a.lpDestStartY||(a.lpDestStartX=g,a.lpDestStartY=c,b.uniform2f(a.locDestStart,g,c));g=e[4];c=e[5];!a.locDestEnd||g===a.lpDestEndX&&c===a.lpDestEndY||(a.lpDestEndX=g,a.lpDestEndY=c,b.uniform2f(a.locDestEnd,g,c));g=e[6];a.locLayerScale&&g!==a.lpLayerScale&&(a.lpLayerScale=g,b.uniform1f(a.locLayerScale,g));g=e[7];a.locLayerAngle&&g!==a.lpLayerAngle&&(a.lpLayerAngle=g,b.uniform1f(a.locLayerAngle,g));g=e[8];c=e[9];!a.locViewOrigin||g===a.lpViewOriginX&&
c===a.lpViewOriginY||(a.lpViewOriginX=g,a.lpViewOriginY=c,b.uniform2f(a.locViewOrigin,g,c));g=e[10];c=e[11];!a.locScrollPos||g===a.lpScrollPosX&&c===a.lpScrollPosY||(a.lpScrollPosX=g,a.lpScrollPosY=c,b.uniform2f(a.locScrollPos,g,c));g=e[12];a.locSeconds&&g!==a.lpSeconds&&(a.lpSeconds=g,b.uniform1f(a.locSeconds,g));if(a.parameters.length)for(e=0,c=a.parameters.length;e<c;e++)g=this.shaderParams[e],g!==a.lastCustomParams[e]&&(a.lastCustomParams[e]=g,b.uniform1f(a.parameters[e][1],g))};a.prototype.pushBatch=
function(){this.batchPtr===this.batch.length&&this.batch.push(new l(0,this));return this.batch[this.batchPtr++]};a.prototype.endBatch=function(){if(0!==this.batchPtr&&!this.gl.isContextLost()){var a=this.gl;0<this.pointPtr&&(a.bindBuffer(a.ARRAY_BUFFER,this.pointBuffer),a.bufferSubData(a.ARRAY_BUFFER,0,this.pointData.subarray(0,this.pointPtr)),b&&0<=b.locAPos&&"<point>"===b.name&&a.vertexAttribPointer(b.locAPos,4,a.FLOAT,!1,0,0));if(0<this.vertexPtr){var b=this.currentShader;a.bindBuffer(a.ARRAY_BUFFER,
this.vertexBuffers[this.curBuffer]);a.bufferSubData(a.ARRAY_BUFFER,0,this.vertexData.subarray(0,this.vertexPtr));b&&0<=b.locAPos&&"<point>"!==b.name&&a.vertexAttribPointer(b.locAPos,this.enableFrontToBack?3:2,a.FLOAT,!1,0,0);a.bindBuffer(a.ARRAY_BUFFER,this.texcoordBuffers[this.curBuffer]);a.bufferSubData(a.ARRAY_BUFFER,0,this.texcoordData.subarray(0,this.texPtr));b&&0<=b.locATex&&"<point>"!==b.name&&a.vertexAttribPointer(b.locATex,2,a.FLOAT,!1,0,0)}a=0;for(b=this.batchPtr;a<b;a++){var e=this.batch[a];
switch(e.type){case 1:e.doQuad();break;case 2:e.doSetTexture();break;case 3:e.doSetOpacity();break;case 4:e.doSetBlend();break;case 5:e.doUpdateModelView();break;case 6:e.doRenderToTexture();break;case 7:e.doClear();break;case 8:e.doPoints();break;case 9:e.doSetProgram();break;case 10:e.doSetProgramParameters();break;case 11:e.doSetTexture1();break;case 12:e.doSetColor();break;case 13:e.doSetDepthTestEnabled();break;case 14:e.doSetEarlyZPass()}}this.pointPtr=this.texPtr=this.vertexPtr=this.batchPtr=
0;this.isBatchInEarlyZPass=this.hasPointBatchTop=this.hasQuadBatchTop=!1;this.curBuffer++;4<=this.curBuffer&&(this.curBuffer=0)}};a.prototype.setOpacity=function(a){if(a!==this.lastOpacity&&!this.isEarlyZPass){var b=this.pushBatch();b.type=3;this.lastOpacity=b.opacityParam=a;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};a.prototype.setTexture=function(a){if(a!==this.lastTexture0){var b=this.pushBatch();b.type=2;this.lastTexture0=b.texParam=a;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};a.prototype.setBlend=
function(a,b){if((a!==this.lastSrcBlend||b!==this.lastDestBlend)&&!this.isEarlyZPass){var d=this.pushBatch();d.type=4;d.startIndex=a;d.indexCount=b;this.lastSrcBlend=a;this.lastDestBlend=b;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};a.prototype.isPremultipliedAlphaBlend=function(){return this.lastSrcBlend===this.gl.ONE&&this.lastDestBlend===this.gl.ONE_MINUS_SRC_ALPHA};a.prototype.setAlphaBlend=function(){this.setBlend(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA)};a.prototype.setNoPremultiplyAlphaBlend=
function(){this.setBlend(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)};a.prototype.quad=function(a,b,e,g,c,f,q,n){15992<=this.vertexPtr&&this.endBatch();var d=this.vertexPtr,k=this.texPtr,h=this.vertexData,v=this.texcoordData,t=this.currentZ;if(this.hasQuadBatchTop)this.batch[this.batchPtr-1].indexCount+=6;else{var A=this.pushBatch();A.type=1;A.startIndex=this.enableFrontToBack?d:d/2*3;A.indexCount=6;this.hasQuadBatchTop=!0;this.hasPointBatchTop=!1}this.enableFrontToBack?(h[d++]=a,h[d++]=b,h[d++]=
t,h[d++]=e,h[d++]=g,h[d++]=t,h[d++]=c,h[d++]=f,h[d++]=t,h[d++]=q,h[d++]=n,h[d++]=t):(h[d++]=a,h[d++]=b,h[d++]=e,h[d++]=g,h[d++]=c,h[d++]=f,h[d++]=q,h[d++]=n);v[k++]=0;v[k++]=0;v[k++]=1;v[k++]=0;v[k++]=1;v[k++]=1;v[k++]=0;v[k++]=1;this.vertexPtr=d;this.texPtr=k};a.prototype.quadTex=function(a,b,e,g,c,f,q,h,n){15992<=this.vertexPtr&&this.endBatch();var d=this.vertexPtr,k=this.texPtr,v=this.vertexData,t=this.texcoordData,A=this.currentZ;if(this.hasQuadBatchTop)this.batch[this.batchPtr-1].indexCount+=
6;else{var r=this.pushBatch();r.type=1;r.startIndex=this.enableFrontToBack?d:d/2*3;r.indexCount=6;this.hasQuadBatchTop=!0;this.hasPointBatchTop=!1}r=n.left;var l=n.top,m=n.right;n=n.bottom;this.enableFrontToBack?(v[d++]=a,v[d++]=b,v[d++]=A,v[d++]=e,v[d++]=g,v[d++]=A,v[d++]=c,v[d++]=f,v[d++]=A,v[d++]=q,v[d++]=h,v[d++]=A):(v[d++]=a,v[d++]=b,v[d++]=e,v[d++]=g,v[d++]=c,v[d++]=f,v[d++]=q,v[d++]=h);t[k++]=r;t[k++]=l;t[k++]=m;t[k++]=l;t[k++]=m;t[k++]=n;t[k++]=r;t[k++]=n;this.vertexPtr=d;this.texPtr=k};a.prototype.quadTexUV=
function(a,b,e,g,c,f,q,n,h,l,C,v,t,A,B,E){15992<=this.vertexPtr&&this.endBatch();var d=this.vertexPtr,p=this.texPtr,k=this.vertexData,r=this.texcoordData,x=this.currentZ;if(this.hasQuadBatchTop)this.batch[this.batchPtr-1].indexCount+=6;else{var y=this.pushBatch();y.type=1;y.startIndex=this.enableFrontToBack?d:d/2*3;y.indexCount=6;this.hasQuadBatchTop=!0;this.hasPointBatchTop=!1}this.enableFrontToBack?(k[d++]=a,k[d++]=b,k[d++]=x,k[d++]=e,k[d++]=g,k[d++]=x,k[d++]=c,k[d++]=f,k[d++]=x,k[d++]=q,k[d++]=
n,k[d++]=x):(k[d++]=a,k[d++]=b,k[d++]=e,k[d++]=g,k[d++]=c,k[d++]=f,k[d++]=q,k[d++]=n);r[p++]=h;r[p++]=l;r[p++]=C;r[p++]=v;r[p++]=t;r[p++]=A;r[p++]=B;r[p++]=E;this.vertexPtr=d;this.texPtr=p};a.prototype.convexPoly=function(a){var d=a.length/2-2,b=d-1,e=a[0],c=a[1],f;for(f=0;f<d;f+=2){var g=2*f;var n=a[g+2];var h=a[g+3];var l=a[g+4];var C=a[g+5];if(f===b)this.quad(e,c,n,h,l,C,l,C);else{var v=a[g+6];g=a[g+7];this.quad(e,c,n,h,l,C,v,g)}}};a.prototype.point=function(a,b,e,g){7996<=this.pointPtr&&this.endBatch();
var c=this.pointPtr,d=this.pointData;if(this.hasPointBatchTop)this.batch[this.batchPtr-1].indexCount++;else{var k=this.pushBatch();k.type=8;k.startIndex=c;k.indexCount=1;this.hasPointBatchTop=!0;this.hasQuadBatchTop=!1}d[c++]=a;d[c++]=b;d[c++]=e;d[c++]=g;this.pointPtr=c};a.prototype.switchProgram=function(a){if(this.lastProgram!==a){if(!this.shaderPrograms[a]){if(0===this.lastProgram)return;a=0}var d=this.pushBatch();d.type=9;this.lastProgram=d.startIndex=a;this.hasPointBatchTop=this.hasQuadBatchTop=
!1}};a.prototype.programUsesDest=function(a){a=this.shaderPrograms[a];return!(!a.locDestStart&&!a.locDestEnd)};a.prototype.programUsesCrossSampling=function(a){a=this.shaderPrograms[a];return!!(a.locDestStart||a.locDestEnd||a.crossSampling)};a.prototype.programPreservesOpaqueness=function(a){return this.shaderPrograms[a].preservesOpaqueness};a.prototype.programExtendsBox=function(a){a=this.shaderPrograms[a];return 0!==a.extendBoxHorizontal||0!==a.extendBoxVertical};a.prototype.getProgramBoxExtendHorizontal=
function(a){return this.shaderPrograms[a].extendBoxHorizontal};a.prototype.getProgramBoxExtendVertical=function(a){return this.shaderPrograms[a].extendBoxVertical};a.prototype.getProgramParameterType=function(a,b){return this.shaderPrograms[a].parameters[b][2]};a.prototype.programIsAnimated=function(a){return this.shaderPrograms[a].animated};a.prototype.setProgramParameters=function(a,b,e,g,c,f,q,n,h,l,C,v,t,A,B){var d=this.shaderPrograms[this.lastProgram];if(d.hasAnyOptionalUniforms||B.length){var m=
this.pushBatch();m.type=10;m.mat4param?mat4.set(this.matMV,m.mat4param):m.mat4param=mat4.create();var p=m.mat4param;p[0]=b;p[1]=e;p[2]=g;p[3]=c;p[4]=f;p[5]=q;p[6]=n;p[7]=h;p[8]=l;p[9]=C;p[10]=v;p[11]=t;p[12]=A;m.texParam=d.locSamplerBack?a:null;if(B.length)for(e=m.shaderParams,e.length=B.length,a=0,b=B.length;a<b;a++)e[a]=B[a];this.hasPointBatchTop=this.hasQuadBatchTop=!1}};a.prototype.clear=function(a,b,e,g){var c=this.pushBatch();c.type=7;c.startIndex=0;c.mat4param||(c.mat4param=mat4.create());
c.mat4param[0]=a;c.mat4param[1]=b;c.mat4param[2]=e;c.mat4param[3]=g;this.hasPointBatchTop=this.hasQuadBatchTop=!1};a.prototype.clearRect=function(a,b,e,g){if(!(0>e||0>g)){var c=this.pushBatch();c.type=7;c.startIndex=1;c.mat4param||(c.mat4param=mat4.create());c.mat4param[0]=a;c.mat4param[1]=b;c.mat4param[2]=e;c.mat4param[3]=g;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};a.prototype.clearDepth=function(){var a=this.pushBatch();a.type=7;a.startIndex=2;this.hasPointBatchTop=this.hasQuadBatchTop=!1};
a.prototype.setEarlyZPass=function(a){if(this.enableFrontToBack&&(a=!!a,this.isEarlyZPass!==a)){var b=this.pushBatch();b.type=14;b.startIndex=a?1:0;this.hasPointBatchTop=this.hasQuadBatchTop=!1;this.isEarlyZPass=a;this.renderToTex=null;this.isEarlyZPass?this.switchProgram(2):this.switchProgram(0)}};a.prototype.setDepthTestEnabled=function(a){if(this.enableFrontToBack){var b=this.pushBatch();b.type=13;b.startIndex=a?1:0;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};a.prototype.fullscreenQuad=function(){mat4.set(this.lastMV,
h);this.resetModelView();this.updateModelView();var a=this.width/2,b=this.height/2;this.quad(-a,b,a,b,a,-b,-a,-b);mat4.set(h,this.matMV);this.updateModelView()};a.prototype.setColorFillMode=function(a,b,e,g){this.switchProgram(3);var c=this.pushBatch();c.type=12;c.mat4param||(c.mat4param=mat4.create());c.mat4param[0]=a;c.mat4param[1]=b;c.mat4param[2]=e;c.mat4param[3]=g;this.hasPointBatchTop=this.hasQuadBatchTop=!1};a.prototype.setTextureFillMode=function(){this.switchProgram(0)};a.prototype.restoreEarlyZMode=
function(){this.switchProgram(2)};a.prototype.present=function(){this.endBatch();this.gl.flush()};var n=[],g={};a.prototype.contextLost=function(){cr.clearArray(n);g={}};a.prototype.loadTexture=function(a,b,e,h,c,f){b=!!b;e=!!e;var d=a.src+","+b+","+e+(b?","+c:"");if("undefined"!==typeof a.src&&g.hasOwnProperty(d)){var k=g[d];k.c2refcount++;return k}this.endBatch();var r=this.gl,l=cr.isPOT(a.width)&&cr.isPOT(a.height);k=r.createTexture();r.bindTexture(r.TEXTURE_2D,k);r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,
!0);var C=r.RGBA,v=r.RGBA,t=r.UNSIGNED_BYTE;if(h&&!this.isIE)switch(h){case 1:v=C=r.RGB;break;case 2:t=r.UNSIGNED_SHORT_4_4_4_4;break;case 3:t=r.UNSIGNED_SHORT_5_5_5_1;break;case 4:v=C=r.RGB,t=r.UNSIGNED_SHORT_5_6_5}if(1===this.version&&!l&&b){h=document.createElement("canvas");h.width=cr.nextHighestPowerOfTwo(a.width);h.height=cr.nextHighestPowerOfTwo(a.height);var A=h.getContext("2d");"undefined"!==typeof A.imageSmoothingEnabled?A.imageSmoothingEnabled=e:(A.webkitImageSmoothingEnabled=e,A.mozImageSmoothingEnabled=
e,A.msImageSmoothingEnabled=e);A.drawImage(a,0,0,a.width,a.height,0,0,h.width,h.height);r.texImage2D(r.TEXTURE_2D,0,C,v,t,h)}else r.texImage2D(r.TEXTURE_2D,0,C,v,t,a);b?"repeat-x"===c?(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE)):("repeat-y"===c?r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE):r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.REPEAT)):(r.texParameteri(r.TEXTURE_2D,
r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE));e?(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),(l||2<=this.version)&&this.enable_mipmaps&&!f?(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR_MIPMAP_LINEAR),r.generateMipmap(r.TEXTURE_2D)):r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR)):(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST));r.bindTexture(r.TEXTURE_2D,
null);this.lastTexture0=null;k.c2width=a.width;k.c2height=a.height;k.c2refcount=1;k.c2texkey=d;n.push(k);return g[d]=k};a.prototype.createEmptyTexture=function(a,b,e,g,c){this.endBatch();var f=this.gl;this.isIE&&(g=!1);var d=f.createTexture();f.bindTexture(f.TEXTURE_2D,d);f.texImage2D(f.TEXTURE_2D,0,f.RGBA,a,b,0,f.RGBA,g?f.UNSIGNED_SHORT_4_4_4_4:f.UNSIGNED_BYTE,null);c?(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.REPEAT),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.REPEAT)):(f.texParameteri(f.TEXTURE_2D,
f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE));f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,e?f.LINEAR:f.NEAREST);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,e?f.LINEAR:f.NEAREST);f.bindTexture(f.TEXTURE_2D,null);this.lastTexture0=null;d.c2width=a;d.c2height=b;n.push(d);return d};a.prototype.videoToTexture=function(a,b,e){this.endBatch();var d=this.gl;this.isIE&&(e=!1);d.bindTexture(d.TEXTURE_2D,b);d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,
!0);try{d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,e?d.UNSIGNED_SHORT_4_4_4_4:d.UNSIGNED_BYTE,a)}catch(c){console&&console.error&&console.error("Error updating WebGL texture: ",c)}d.bindTexture(d.TEXTURE_2D,null);this.lastTexture0=null};a.prototype.deleteTexture=function(a){a&&("undefined"!==typeof a.c2refcount&&1<a.c2refcount?a.c2refcount--:(this.endBatch(),a===this.lastTexture0&&(this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.lastTexture0=null),a===this.lastTexture1&&(this.gl.activeTexture(this.gl.TEXTURE1),
this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.gl.activeTexture(this.gl.TEXTURE0),this.lastTexture1=null),cr.arrayFindRemove(n,a),"undefined"!==typeof a.c2texkey&&delete g[a.c2texkey],this.gl.deleteTexture(a)))};a.prototype.estimateVRAM=function(){var a=this.width*this.height*8,b;var e=0;for(b=n.length;e<b;e++){var g=n[e];a+=g.c2width*g.c2height*4}return a};a.prototype.textureCount=function(){return n.length};a.prototype.setRenderingToTexture=function(a){if(a!==this.renderToTex){var b=this.pushBatch();
b.type=6;this.renderToTex=b.texParam=a;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};cr.GLWrap=a})();
(function(){function a(a){if(a&&(a.getContext||a.dc)&&!a.c2runtime){a.c2runtime=this;var c=this;this.isPhoneGap=this.isCordova=(this.isCrosswalk=/crosswalk/i.test(navigator.userAgent)||/xwalk/i.test(navigator.userAgent)||!("undefined"===typeof window.c2isCrosswalk||!window.c2isCrosswalk))||"undefined"!==typeof window.device&&("undefined"!==typeof window.device.cordova||"undefined"!==typeof window.device.phonegap)||"undefined"!==typeof window.c2iscordova&&window.c2iscordova;this.isDirectCanvas=!!a.dc;
this.isAppMobi="undefined"!==typeof window.AppMobi||this.isDirectCanvas;this.isCocoonJs=!!window.c2cocoonjs;this.isEjecta=!!window.c2ejecta;this.isCocoonJs&&(CocoonJS.App.onSuspended.addEventListener(function(){c.setSuspended(!0)}),CocoonJS.App.onActivated.addEventListener(function(){c.setSuspended(!1)}));this.isEjecta&&(document.addEventListener("pagehide",function(){c.setSuspended(!0)}),document.addEventListener("pageshow",function(){c.setSuspended(!1)}),document.addEventListener("resize",function(){c.setSize(window.innerWidth,
window.innerHeight)}));this.isDomFree=this.isDirectCanvas||this.isCocoonJs||this.isEjecta;this.isMicrosoftEdge=/edge\//i.test(navigator.userAgent);this.isIE=(/msie/i.test(navigator.userAgent)||/trident/i.test(navigator.userAgent)||/iemobile/i.test(navigator.userAgent))&&!this.isMicrosoftEdge;this.isTizen=/tizen/i.test(navigator.userAgent);this.isAndroid=/android/i.test(navigator.userAgent)&&!this.isTizen&&!this.isIE&&!this.isMicrosoftEdge;this.isiPhone=(/iphone/i.test(navigator.userAgent)||/ipod/i.test(navigator.userAgent))&&
!this.isIE&&!this.isMicrosoftEdge;this.isiPad=/ipad/i.test(navigator.userAgent);this.isiOS=this.isiPhone||this.isiPad||this.isEjecta;this.isiPhoneiOS6=this.isiPhone&&/os\s6/i.test(navigator.userAgent);this.isChrome=(/chrome/i.test(navigator.userAgent)||/chromium/i.test(navigator.userAgent))&&!this.isIE&&!this.isMicrosoftEdge;this.isAmazonWebApp=/amazonwebappplatform/i.test(navigator.userAgent);this.isFirefox=/firefox/i.test(navigator.userAgent);this.isSafari=/safari/i.test(navigator.userAgent)&&!this.isChrome&&
!this.isIE&&!this.isMicrosoftEdge;this.isWindows=/windows/i.test(navigator.userAgent);this.isNodeWebkit=this.isNWjs="undefined"!==typeof window.c2nodewebkit||"undefined"!==typeof window.c2nwjs||/nodewebkit/i.test(navigator.userAgent)||/nwjs/i.test(navigator.userAgent);this.isArcade="undefined"!==typeof window.is_scirra_arcade;this.isWindows8App=!("undefined"===typeof window.c2isWindows8||!window.c2isWindows8);this.isWindows8Capable=!("undefined"===typeof window.c2isWindows8Capable||!window.c2isWindows8Capable);
this.isWindowsPhone8=!("undefined"===typeof window.c2isWindowsPhone8||!window.c2isWindowsPhone8);this.isWindowsPhone81=!("undefined"===typeof window.c2isWindowsPhone81||!window.c2isWindowsPhone81);this.isWindows10=!!window.cr_windows10;this.isWinJS=this.isWindows8App||this.isWindows8Capable||this.isWindowsPhone81||this.isWindows10;this.isBlackberry10=!("undefined"===typeof window.c2isBlackberry10||!window.c2isBlackberry10);this.isAndroidStockBrowser=this.isAndroid&&!this.isChrome&&!this.isCrosswalk&&
!this.isFirefox&&!this.isAmazonWebApp&&!this.isDomFree;this.devicePixelRatio=1;this.isMobile=this.isCordova||this.isCrosswalk||this.isAppMobi||this.isCocoonJs||this.isAndroid||this.isiOS||this.isWindowsPhone8||this.isWindowsPhone81||this.isBlackberry10||this.isTizen||this.isEjecta;this.isMobile||(this.isMobile=/(blackberry|bb10|playbook|palm|symbian|nokia|windows\s+ce|phone|mobile|tablet|kindle|silk)/i.test(navigator.userAgent));this.isWKWebView=!!(this.isiOS&&this.isCordova&&window.webkit);"undefined"===
typeof cr_is_preview||this.isNWjs||"?nw"!==window.location.search&&!/nodewebkit/i.test(navigator.userAgent)&&!/nwjs/i.test(navigator.userAgent)||(this.isNWjs=!0);this.isDebug="undefined"!==typeof cr_is_preview&&-1<window.location.search.indexOf("debug");this.canvas=a;this.canvasdiv=document.getElementById("c2canvasdiv");this.glwrap=this.gl=null;this.glUnmaskedRenderer="(unavailable)";this.enableFrontToBack=!1;this.earlyz_index=0;this.ctx=null;this.firstInFullscreen=!1;this.oldHeight=this.oldWidth=
0;this.canvas.oncontextmenu=function(a){a.preventDefault&&a.preventDefault();return!1};this.canvas.onselectstart=function(a){a.preventDefault&&a.preventDefault();return!1};this.canvas.ontouchstart=function(a){a.preventDefault&&a.preventDefault();return!1};this.isDirectCanvas&&(window.c2runtime=this);this.isNWjs&&(window.ondragover=function(a){a.preventDefault();return!1},window.ondrop=function(a){a.preventDefault();return!1},window.nwgui&&window.nwgui.App.clearCache&&window.nwgui.App.clearCache());
this.isAndroidStockBrowser&&"undefined"!==typeof jQuery&&jQuery("canvas").parents("*").css("overflow","visible");this.width=a.width;this.height=a.height;this.draw_width=this.width;this.draw_height=this.height;this.cssWidth=this.width;this.cssHeight=this.height;this.lastWindowWidth=window.innerWidth;this.lastWindowHeight=window.innerHeight;this.forceCanvasAlpha=!1;this.redraw=!0;this.isSuspended=!1;Date.now||(Date.now=function(){return+new Date});this.plugins=[];this.types={};this.types_by_index=[];
this.behaviors=[];this.layouts={};this.layouts_by_index=[];this.eventsheets={};this.eventsheets_by_index=[];this.wait_for_textures=[];this.triggers_to_postinit=[];this.all_global_vars=[];this.all_local_vars=[];this.shadowcasterBehavior=this.jumpthruBehavior=this.solidBehavior=null;this.deathRow={};this.isInClearDeathRow=this.hasPendingInstances=!1;this.isInOnDestroy=0;this.isEndingLayout=this.isRunningEvents=!1;this.createRow=[];this.isLoadingState=!1;this.loadFromSlot=this.saveToSlot="";this.loadFromJson=
null;this.lastSaveJson="";this.suspendDrawing=this.signalledContinuousPreview=!1;this.fireOnCreateAfterLoad=[];this.dt1=this.dt=0;this.minimumFramerate=30;this.cpuutilisation=this.logictime=0;this.timescale=1;this.kahanTime=new cr.KahanAdder;this.wallTime=new cr.KahanAdder;this.objectcount=this.framecount=this.execcount=this.tickcount_nosave=this.tickcount=this.last_fps_time=this.fps=this.last_tick_time=0;this.changelayout=null;this.destroycallbacks=[];this.event_stack=[];this.event_stack_index=-1;
this.localvar_stack=[[]];this.trigger_depth=this.localvar_stack_index=0;this.pushEventStack(null);this.loop_stack=[];this.loop_stack_index=-1;this.next_puid=this.next_uid=0;this.layout_first_tick=!0;this.family_count=0;this.suspend_events=[];this.timeout_id=this.raf_id=-1;this.isloading=!0;this.loadingprogress=0;this.isNodeFullscreen=!1;this.stackLocalCount=0;this.audioInstance=null;this.isInUserInputEvent=this.had_a_click=!1;this.objects_to_pretick=new cr.ObjectSet;this.objects_to_tick=new cr.ObjectSet;
this.objects_to_tick2=new cr.ObjectSet;this.registered_collisions=[];this.temp_poly=new cr.CollisionPoly([]);this.temp_poly2=new cr.CollisionPoly([]);this.allGroups=[];this.groups_by_name={};this.cndsBySid={};this.actsBySid={};this.varsBySid={};this.blocksBySid={};this.layout_ctx=this.layout_canvas=this.layout_tex=this.layer_tex=this.layer_ctx=this.layer_canvas=this.running_layout=null;this.uses_background_blending=this.is_WebGL_context_lost=!1;this.fx_tex=[null,null];this.fullscreen_scaling=0;this.files_subfolder=
"";this.objectsByUid={};this.snapshotCanvas=this.loaderlogos=null;this.snapshotData="";this.objectRefTable=[];this.requestProjectData()}}function b(a,c){return 128>=c?a[3]:256>=c?a[2]:512>=c?a[1]:a[0]}function e(){try{return!!window.indexedDB}catch(w){return!1}}function l(a){a.target.result.createObjectStore("saves",{keyPath:"slot"})}function h(a,c,b,f){try{var d=indexedDB.open("_C2SaveStates");d.onupgradeneeded=l;d.onerror=f;d.onsuccess=function(d){d=d.target.result;d.onerror=f;d.transaction(["saves"],
"readwrite").objectStore("saves").put({slot:a,data:c}).onsuccess=b}}catch(U){f(U)}}function n(a,c,b){try{var f=indexedDB.open("_C2SaveStates");f.onupgradeneeded=l;f.onerror=b;f.onsuccess=function(f){f=f.target.result;f.onerror=b;var d=f.transaction(["saves"]).objectStore("saves").get(a);d.onsuccess=function(a){d.result?c(d.result.data):c(null)}}}catch(V){b(V)}}function g(){cr.logexport("Reloading for continuous preview");window.c2cocoonjs?CocoonJS.App.reload():-1<window.location.search.indexOf("continuous")?
window.location.reload(!0):window.location+="?continuous"}function d(a){var c,b={};for(c in a)!a.hasOwnProperty(c)||a[c]instanceof cr.ObjectSet||a[c]&&"undefined"!==typeof a[c].c2userdata||"spriteCreatedDestroyCallback"!==c&&(b[c]=a[c]);return b}var k=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame;a.prototype.requestProjectData=function(){var a=this;if(this.isWKWebView)this.fetchLocalFileViaCordovaAsText("data.js",
function(c){a.loadProject(JSON.parse(c))},function(a){alert("Error fetching data.js")});else{var c=this.isWindowsPhone8?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest;var b="data.js";if(this.isWindows8App||this.isWindowsPhone8||this.isWindowsPhone81||this.isWindows10)b="data.json";c.open("GET",b,!0);var f=!1;if(!this.isDomFree&&"response"in c&&"responseType"in c)try{c.responseType="json",f="json"===c.responseType}catch(V){f=!1}if(!f&&"responseType"in c)try{c.responseType="text"}catch(V){}if("overrideMimeType"in
c)try{c.overrideMimeType("application/json; charset=utf-8")}catch(V){}this.isWindowsPhone8?c.onreadystatechange=function(){4===c.readyState&&a.loadProject(JSON.parse(c.responseText))}:(c.onload=function(){if(f)a.loadProject(c.response);else if(a.isEjecta){var b=c.responseText;b=b.substr(b.indexOf("{"));a.loadProject(JSON.parse(b))}else a.loadProject(JSON.parse(c.responseText))},c.onerror=function(a){cr.logerror("Error requesting "+b+":");cr.logerror(a)});c.send()}};a.prototype.initRendererAndLoader=
function(){var a=this,c,b;this.isRetina=(!this.isDomFree||this.isEjecta||this.isCordova)&&this.useHighDpi&&!this.isAndroidStockBrowser;0===this.fullscreen_mode&&this.isiOS&&(this.isRetina=!1);this.devicePixelRatio=this.isRetina?window.devicePixelRatio||window.webkitDevicePixelRatio||window.mozDevicePixelRatio||window.msDevicePixelRatio||1:1;"object"===typeof window.StatusBar&&window.StatusBar.hide();this.ClearDeathRow();0<this.fullscreen_mode&&this.setSize(window.innerWidth,window.innerHeight,!0);
this.canvas.addEventListener("webglcontextlost",function(c){c.preventDefault();a.onContextLost();cr.logexport("[Construct 2] WebGL context lost");window.cr_setSuspended(!0)},!1);this.canvas.addEventListener("webglcontextrestored",function(c){a.glwrap.initState();a.glwrap.setSize(a.glwrap.width,a.glwrap.height,!0);a.layer_tex=null;a.layout_tex=null;a.fx_tex[0]=null;a.fx_tex[1]=null;a.onContextRestored();a.redraw=!0;cr.logexport("[Construct 2] WebGL context restored");window.cr_setSuspended(!1)},!1);
try{if(this.enableWebGL&&(this.isCocoonJs||this.isEjecta||!this.isDomFree)){var f={alpha:!0,depth:!1,antialias:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!0};this.isAndroid||(this.gl=this.canvas.getContext("webgl2",f));this.gl||(this.gl=this.canvas.getContext("webgl",f)||this.canvas.getContext("experimental-webgl",f))}}catch(W){}if(this.gl){this.gl.getParameter(this.gl.VERSION).indexOf("WebGL 2");if(f=this.gl.getExtension("WEBGL_debug_renderer_info")){var d=this.gl.getParameter(f.UNMASKED_VENDOR_WEBGL);
this.glUnmaskedRenderer=this.gl.getParameter(f.UNMASKED_RENDERER_WEBGL)+" ["+d+"]"}this.enableFrontToBack&&(this.glUnmaskedRenderer+=" [front-to-back enabled]");this.isDomFree||(this.overlay_canvas=document.createElement("canvas"),jQuery(this.overlay_canvas).appendTo(this.canvas.parentNode),this.overlay_canvas.oncontextmenu=function(a){return!1},this.overlay_canvas.onselectstart=function(a){return!1},this.overlay_canvas.width=Math.round(this.cssWidth*this.devicePixelRatio),this.overlay_canvas.height=
Math.round(this.cssHeight*this.devicePixelRatio),jQuery(this.overlay_canvas).css({width:this.cssWidth+"px",height:this.cssHeight+"px"}),this.positionOverlayCanvas(),this.overlay_ctx=this.overlay_canvas.getContext("2d"));this.glwrap=new cr.GLWrap(this.gl,this.isMobile,this.enableFrontToBack);this.glwrap.setSize(this.canvas.width,this.canvas.height);this.glwrap.enable_mipmaps=0!==this.downscalingQuality;this.ctx=null;f=0;for(d=this.types_by_index.length;f<d;f++){var m=this.types_by_index[f];var e=0;
for(c=m.effect_types.length;e<c;e++){var p=m.effect_types[e];p.shaderindex=this.glwrap.getShaderIndex(p.id);p.preservesOpaqueness=this.glwrap.programPreservesOpaqueness(p.shaderindex);this.uses_background_blending=this.uses_background_blending||this.glwrap.programUsesDest(p.shaderindex)}}f=0;for(d=this.layouts_by_index.length;f<d;f++){var t=this.layouts_by_index[f];e=0;for(c=t.effect_types.length;e<c;e++)p=t.effect_types[e],p.shaderindex=this.glwrap.getShaderIndex(p.id),p.preservesOpaqueness=this.glwrap.programPreservesOpaqueness(p.shaderindex);
t.updateActiveEffects();e=0;for(c=t.layers.length;e<c;e++){var g=t.layers[e];m=0;for(b=g.effect_types.length;m<b;m++)p=g.effect_types[m],p.shaderindex=this.glwrap.getShaderIndex(p.id),p.preservesOpaqueness=this.glwrap.programPreservesOpaqueness(p.shaderindex),this.uses_background_blending=this.uses_background_blending||this.glwrap.programUsesDest(p.shaderindex);g.updateActiveEffects()}}}else{if(0<this.fullscreen_mode&&this.isDirectCanvas){this.canvas=null;document.oncontextmenu=function(a){return!1};
document.onselectstart=function(a){return!1};this.ctx=AppMobi.canvas.getContext("2d");try{this.ctx.samplingMode=this.linearSampling?"smooth":"sharp",this.ctx.globalScale=1,this.ctx.HTML5CompatibilityMode=!0,this.ctx.imageSmoothingEnabled=this.linearSampling}catch(W){}0!==this.width&&0!==this.height&&(this.ctx.width=this.width,this.ctx.height=this.height)}this.ctx||(f=this.isCocoonJs?{antialias:!!this.linearSampling,alpha:!0}:{alpha:!0},this.ctx=this.canvas.getContext("2d",f),this.setCtxImageSmoothingEnabled(this.ctx,
this.linearSampling));this.overlay_ctx=this.overlay_canvas=null}this.tickFunc=function(c){a.tick(!1,c)};window==window.top||this.isDomFree||this.isWinJS||this.isWindowsPhone8||(document.addEventListener("mousedown",function(){window.focus()},!0),document.addEventListener("touchstart",function(){window.focus()},!0));"undefined"!==typeof cr_is_preview&&(this.isCocoonJs&&console.log("[Construct 2] In preview-over-wifi via CocoonJS mode"),-1<window.location.search.indexOf("continuous")&&(cr.logexport("Reloading for continuous preview"),
this.loadFromSlot="__c2_continuouspreview",this.suspendDrawing=!0),this.pauseOnBlur&&!this.isMobile&&(jQuery(window).focus(function(){a.setSuspended(!1)}),jQuery(window).blur(function(){var c=window.parent;c&&c.document.hasFocus()||a.setSuspended(!0)})));window.addEventListener("blur",function(){a.onWindowBlur()});this.isDomFree||(f=function(a){if(cr.isCanvasInputEvent(a)&&document.activeElement&&document.activeElement!==document.getElementsByTagName("body")[0]&&document.activeElement.blur)try{document.activeElement.blur()}catch(Z){}},
"undefined"!==typeof PointerEvent?document.addEventListener("pointerdown",f):window.navigator.msPointerEnabled?document.addEventListener("MSPointerDown",f):document.addEventListener("touchstart",f),document.addEventListener("mousedown",f));0===this.fullscreen_mode&&this.isRetina&&1<this.devicePixelRatio&&this.setSize(this.original_width,this.original_height,!0);this.tryLockOrientation();this.getready();this.go();this.extra={};cr.seal(this)};a.prototype.setSize=function(a,c,b){var f=0,d=0,m;if(this.lastWindowWidth!==
a||this.lastWindowHeight!==c||b){this.lastWindowWidth=a;this.lastWindowHeight=c;var e=this.fullscreen_mode;if((m=(document.mozFullScreen||document.webkitIsFullScreen||!!document.msFullscreenElement||document.fullScreen||this.isNodeFullscreen)&&!this.isCordova)||0!==this.fullscreen_mode||b){m&&(e=this.fullscreen_scaling);b=this.devicePixelRatio;if(4<=e)if(5===e&&1!==b&&(a+=1,c+=1),m=this.original_width/this.original_height,a/c>m)if(m*=c,5===e){f=m*b/this.original_width;1<f?f=Math.floor(f):1>f&&(f=
1/Math.ceil(1/f));m=this.original_width*f/b;var p=this.original_height*f/b;f=(a-m)/2;d=(c-p)/2;a=m;c=p}else f=(a-m)/2,a=m;else p=a/m,5===e?(f=p*b/this.original_height,1<f?f=Math.floor(f):1>f&&(f=1/Math.ceil(1/f)),m=this.original_width*f/b,p=this.original_height*f/b,f=(a-m)/2,d=(c-p)/2,a=m):d=(c-p)/2,c=p;else m&&0===e&&(f=Math.floor((a-this.original_width)/2),d=Math.floor((c-this.original_height)/2),a=this.original_width,c=this.original_height);2>e&&(this.aspect_scale=b);this.cssWidth=Math.round(a);
this.cssHeight=Math.round(c);this.width=Math.round(a*b);this.height=Math.round(c*b);this.redraw=!0;this.wantFullscreenScalingQuality?(this.draw_width=this.width,this.draw_height=this.height,this.fullscreenScalingQuality=!0):this.width<this.original_width&&this.height<this.original_height||1===e?(this.draw_width=this.width,this.draw_height=this.height,this.fullscreenScalingQuality=!0):(this.draw_width=this.original_width,this.draw_height=this.original_height,this.fullscreenScalingQuality=!1,2===e?
(m=this.original_width/this.original_height,e=this.lastWindowWidth/this.lastWindowHeight,e<m?this.draw_width=this.draw_height*e:e>m&&(this.draw_height=this.draw_width/e)):3===e&&(m=this.original_width/this.original_height,e=this.lastWindowWidth/this.lastWindowHeight,e>m?this.draw_width=this.draw_height*e:e<m&&(this.draw_height=this.draw_width/e)));this.canvasdiv&&!this.isDomFree&&(jQuery(this.canvasdiv).css({width:Math.round(a)+"px",height:Math.round(c)+"px","margin-left":Math.floor(f)+"px","margin-top":Math.floor(d)+
"px"}),"undefined"!==typeof cr_is_preview&&jQuery("#borderwrap").css({width:Math.round(a)+"px",height:Math.round(c)+"px"}));this.canvas&&(this.canvas.width=Math.round(a*b),this.canvas.height=Math.round(c*b),this.isEjecta?(this.canvas.style.left=Math.floor(f)+"px",this.canvas.style.top=Math.floor(d)+"px",this.canvas.style.width=Math.round(a)+"px",this.canvas.style.height=Math.round(c)+"px"):this.isRetina&&!this.isDomFree&&(this.canvas.style.width=Math.round(a)+"px",this.canvas.style.height=Math.round(c)+
"px"));this.overlay_canvas&&(this.overlay_canvas.width=Math.round(a*b),this.overlay_canvas.height=Math.round(c*b),this.overlay_canvas.style.width=this.cssWidth+"px",this.overlay_canvas.style.height=this.cssHeight+"px");this.glwrap&&this.glwrap.setSize(Math.round(a*b),Math.round(c*b));this.isDirectCanvas&&this.ctx&&(this.ctx.width=Math.round(a),this.ctx.height=Math.round(c));this.ctx&&this.setCtxImageSmoothingEnabled(this.ctx,this.linearSampling);this.tryLockOrientation();this.isiPhone&&!this.isCordova&&
window.scrollTo(0,0)}}};a.prototype.tryLockOrientation=function(){if(this.autoLockOrientation&&0!==this.orientations){var a="portrait";2===this.orientations&&(a="landscape");try{screen.orientation&&screen.orientation.lock?screen.orientation.lock(a).catch(function(){}):screen.lockOrientation?screen.lockOrientation(a):screen.webkitLockOrientation?screen.webkitLockOrientation(a):screen.mozLockOrientation?screen.mozLockOrientation(a):screen.msLockOrientation&&screen.msLockOrientation(a)}catch(D){console&&
console.warn&&console.warn("Failed to lock orientation: ",D)}}};a.prototype.onContextLost=function(){this.glwrap.contextLost();this.is_WebGL_context_lost=!0;var a;var c=0;for(a=this.types_by_index.length;c<a;c++){var b=this.types_by_index[c];if(b.onLostWebGLContext)b.onLostWebGLContext()}};a.prototype.onContextRestored=function(){this.is_WebGL_context_lost=!1;var a;var c=0;for(a=this.types_by_index.length;c<a;c++){var b=this.types_by_index[c];if(b.onRestoreWebGLContext)b.onRestoreWebGLContext()}};
a.prototype.positionOverlayCanvas=function(){if(!this.isDomFree){var a=(document.mozFullScreen||document.webkitIsFullScreen||document.fullScreen||document.msFullscreenElement||this.isNodeFullscreen)&&!this.isCordova?jQuery(this.canvas).offset():jQuery(this.canvas).position();a.position="absolute";jQuery(this.overlay_canvas).css(a)}};var u=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame||window.oCancelAnimationFrame;a.prototype.setSuspended=
function(a){var c;if(a&&!this.isSuspended)for(cr.logexport("[Construct 2] Suspending"),this.isSuspended=!0,-1!==this.raf_id&&u&&u(this.raf_id),-1!==this.timeout_id&&clearTimeout(this.timeout_id),a=0,c=this.suspend_events.length;a<c;a++)this.suspend_events[a](!0);else if(!a&&this.isSuspended){cr.logexport("[Construct 2] Resuming");this.isSuspended=!1;this.last_tick_time=cr.performance_now();this.last_fps_time=cr.performance_now();a=this.logictime=this.framecount=0;for(c=this.suspend_events.length;a<
c;a++)this.suspend_events[a](!1);this.tick(!1)}};a.prototype.addSuspendCallback=function(a){this.suspend_events.push(a)};a.prototype.GetObjectReference=function(a){return this.objectRefTable[a]};a.prototype.loadProject=function(a){a&&a.project||cr.logerror("Project model unavailable");a=a.project;this.name=a[0];this.first_layout=a[1];this.fullscreen_mode=a[12];this.fullscreen_mode_set=a[12];this.original_width=a[10];this.original_height=a[11];this.parallax_x_origin=this.original_width/2;this.parallax_y_origin=
this.original_height/2;this.isDomFree&&!this.isEjecta&&(4<=a[12]||0===a[12])&&(cr.logexport("[Construct 2] Letterbox scale fullscreen modes are not supported on this platform - falling back to 'Scale outer'"),this.fullscreen_mode_set=this.fullscreen_mode=3);this.uses_loader_layout=a[18];this.loaderstyle=a[19];if(0===this.loaderstyle){var c=new Image;c.crossOrigin="anonymous";this.setImageSrc(c,"loading-logo.png");this.loaderlogos={logo:c}}else if(4===this.loaderstyle){c=new Image;c.src="";var b=new Image;
b.src="";var f=new Image;f.src="";var d=new Image;d.src="";var m=new Image;m.src="";var e=new Image;e.src="";var p=new Image;p.src="";var t=new Image;t.src="";var g=new Image;g.src="";var k=new Image;k.src="";var q=new Image;q.src="";var w=new Image;w.src="";this.loaderlogos={logo:[c,b,f,d],powered:[m,e,p,t],website:[g,k,q,w]}}this.next_uid=a[21];this.objectRefTable=cr.getObjectRefTable();this.system=new cr.system_object(this);c=0;for(b=a[2].length;c<b;c++){p=a[2][c];f=this.GetObjectReference(p[0]);
cr.add_common_aces(p,f.prototype);t=new f(this);t.singleglobal=p[1];t.is_world=p[2];t.is_rotatable=p[5];t.must_predraw=p[9];if(t.onCreate)t.onCreate();cr.seal(t);this.plugins.push(t)}this.objectRefTable=cr.getObjectRefTable();c=0;for(b=a[3].length;c<b;c++){p=a[3][c];m=this.GetObjectReference(p[1]);t=null;f=0;for(d=this.plugins.length;f<d;f++)if(this.plugins[f]instanceof m){t=this.plugins[f];break}g=new t.Type(t);g.name=p[0];g.is_family=p[2];g.instvar_sids=p[3].slice(0);g.vars_count=p[3].length;g.behs_count=
p[4];g.fx_count=p[5];g.sid=p[11];g.is_family?(g.members=[],g.family_index=this.family_count++,g.families=null):(g.members=null,g.family_index=-1,g.families=[]);g.family_var_map=null;g.family_beh_map=null;g.family_fx_map=null;g.is_contained=!1;g.container=null;p[6]?(g.texture_file=p[6][0],g.texture_filesize=p[6][1],g.texture_pixelformat=p[6][2]):(g.texture_file=null,g.texture_filesize=0,g.texture_pixelformat=0);g.animations=p[7]?p[7]:null;g.index=c;g.instances=[];g.deadCache=[];g.solstack=[new cr.selection(g)];
g.cur_sol=0;g.default_instance=null;g.default_layerindex=0;g.stale_iids=!0;g.updateIIDs=cr.type_updateIIDs;g.getFirstPicked=cr.type_getFirstPicked;g.getPairedInstance=cr.type_getPairedInstance;g.getCurrentSol=cr.type_getCurrentSol;g.pushCleanSol=cr.type_pushCleanSol;g.pushCopySol=cr.type_pushCopySol;g.popSol=cr.type_popSol;g.getBehaviorByName=cr.type_getBehaviorByName;g.getBehaviorIndexByName=cr.type_getBehaviorIndexByName;g.getEffectIndexByName=cr.type_getEffectIndexByName;g.applySolToContainer=
cr.type_applySolToContainer;g.getInstanceByIID=cr.type_getInstanceByIID;g.collision_grid=new cr.SparseGrid(this.original_width,this.original_height);g.any_cell_changed=!0;g.any_instance_parallaxed=!1;g.extra={};g.toString=cr.type_toString;g.behaviors=[];f=0;for(d=p[8].length;f<d;f++){k=p[8][f];q=this.GetObjectReference(k[1]);w=null;m=0;for(e=this.behaviors.length;m<e;m++)if(this.behaviors[m]instanceof q){w=this.behaviors[m];break}if(!w){w=new q(this);w.my_types=[];w.my_instances=new cr.ObjectSet;
if(w.onCreate)w.onCreate();cr.seal(w);this.behaviors.push(w);cr.behaviors.solid&&w instanceof cr.behaviors.solid&&(this.solidBehavior=w);cr.behaviors.jumpthru&&w instanceof cr.behaviors.jumpthru&&(this.jumpthruBehavior=w);cr.behaviors.shadowcaster&&w instanceof cr.behaviors.shadowcaster&&(this.shadowcasterBehavior=w)}-1===w.my_types.indexOf(g)&&w.my_types.push(g);m=new w.Type(w,g);m.name=k[0];m.sid=k[2];m.onCreate();cr.seal(m);g.behaviors.push(m)}g.global=p[9];g.isOnLoaderLayout=p[10];g.effect_types=
[];f=0;for(d=p[12].length;f<d;f++)g.effect_types.push({id:p[12][f][0],name:p[12][f][1],shaderindex:-1,preservesOpaqueness:!1,active:!0,index:f});g.tile_poly_data=p[13];if(!this.uses_loader_layout||g.is_family||g.isOnLoaderLayout||!t.is_world)g.onCreate(),cr.seal(g);g.name&&(this.types[g.name]=g);this.types_by_index.push(g);t.singleglobal&&(f=new t.Instance(g),f.uid=this.next_uid++,f.puid=this.next_puid++,f.iid=0,f.get_iid=cr.inst_get_iid,f.toString=cr.inst_toString,f.properties=p[14],f.onCreate(),
cr.seal(f),g.instances.push(f),this.objectsByUid[f.uid.toString()]=f)}c=0;for(b=a[4].length;c<b;c++)for(m=a[4][c],e=this.types_by_index[m[0]],f=1,d=m.length;f<d;f++)p=this.types_by_index[m[f]],p.families.push(e),e.members.push(p);c=0;for(b=a[28].length;c<b;c++){m=a[28][c];e=[];f=0;for(d=m.length;f<d;f++)e.push(this.types_by_index[m[f]]);f=0;for(d=e.length;f<d;f++)e[f].is_contained=!0,e[f].container=e}if(0<this.family_count)for(c=0,b=this.types_by_index.length;c<b;c++)if(p=this.types_by_index[c],!p.is_family&&
p.families.length){p.family_var_map=Array(this.family_count);p.family_beh_map=Array(this.family_count);p.family_fx_map=Array(this.family_count);g=[];f=w=q=k=0;for(d=p.families.length;f<d;f++)for(t=p.families[f],p.family_var_map[t.family_index]=k,k+=t.vars_count,p.family_beh_map[t.family_index]=q,q+=t.behs_count,p.family_fx_map[t.family_index]=w,w+=t.fx_count,m=0,e=t.effect_types.length;m<e;m++)g.push(cr.shallowCopy({},t.effect_types[m]));p.effect_types=g.concat(p.effect_types);f=0;for(d=p.effect_types.length;f<
d;f++)p.effect_types[f].index=f}c=0;for(b=a[5].length;c<b;c++)p=a[5][c],f=new cr.layout(this,p),cr.seal(f),this.layouts[f.name]=f,this.layouts_by_index.push(f);c=0;for(b=a[6].length;c<b;c++)p=a[6][c],f=new cr.eventsheet(this,p),cr.seal(f),this.eventsheets[f.name]=f,this.eventsheets_by_index.push(f);c=0;for(b=this.eventsheets_by_index.length;c<b;c++)this.eventsheets_by_index[c].postInit();c=0;for(b=this.eventsheets_by_index.length;c<b;c++)this.eventsheets_by_index[c].updateDeepIncludes();c=0;for(b=
this.triggers_to_postinit.length;c<b;c++)this.triggers_to_postinit[c].postInit();cr.clearArray(this.triggers_to_postinit);this.audio_to_preload=a[7];this.files_subfolder=a[8];this.pixel_rounding=a[9];this.aspect_scale=1;this.enableWebGL=a[13];this.linearSampling=a[14];this.clearBackground=a[15];this.versionstr=a[16];this.useHighDpi=a[17];this.orientations=a[20];this.autoLockOrientation=0<this.orientations;this.pauseOnBlur=a[22];this.fullscreenScalingQuality=this.wantFullscreenScalingQuality=a[23];
this.downscalingQuality=a[24];this.preloadSounds=a[25];this.projectName=a[26];this.enableFrontToBack=a[27]&&!this.isIE;this.start_time=Date.now();cr.clearArray(this.objectRefTable);this.initRendererAndLoader()};var r=!1,c=0,f=[];a.prototype.queueImageLoad=function(a,b){var d=this,m=function(){c--;d.maybeLoadNextImages()};a.addEventListener("load",m);a.addEventListener("error",m);f.push([a,b]);this.maybeLoadNextImages()};a.prototype.maybeLoadNextImages=function(){for(var a;f.length&&100>c;)c++,a=f.shift(),
this.setImageSrc(a[0],a[1])};a.prototype.waitForImageLoad=function(a,c){a.cocoonLazyLoad=!0;a.onerror=function(c){r=a.c2error=!0;console&&console.error&&console.error("Error loading image '"+a.src+"': ",c)};this.isEjecta?a.src=c:a.src||("undefined"!==typeof XAPKReader?XAPKReader.get(c,function(c){a.src=c},function(f){r=a.c2error=!0;console&&console.error&&console.error("Error extracting image '"+c+"' from expansion file: ",f)}):(a.crossOrigin="anonymous",this.queueImageLoad(a,c)));this.wait_for_textures.push(a)};
a.prototype.findWaitingTexture=function(a){var c;var f=0;for(c=this.wait_for_textures.length;f<c;f++)if(this.wait_for_textures[f].cr_src===a)return this.wait_for_textures[f];return null};var q=0,y=!1;a.prototype.getready=function(){this.audioInstance&&(q=this.audioInstance.setPreloadList(this.audio_to_preload))};a.prototype.areAllTexturesAndSoundsLoaded=function(){var a=q,c=0,f=!0,b;var d=0;for(b=this.wait_for_textures.length;d<b;d++){var m=this.wait_for_textures[d];var e=m.cr_filesize;if(!e||0>=
e)e=5E4;a+=e;m.src&&(m.complete||m.loaded)&&!m.c2error?c+=e:f=!1}f&&this.preloadSounds&&this.audioInstance&&(y||(this.audioInstance.startPreloads(),y=!0),d=this.audioInstance.getPreloadedSize(),c+=d,d<q&&(f=!1));this.progress=0==a?1:c/a;return f};var z=!1;a.prototype.go=function(){if(this.ctx||this.glwrap){var a=this.ctx||this.overlay_ctx;this.overlay_canvas&&this.positionOverlayCanvas();var c=window.innerWidth,f=window.innerHeight;this.lastWindowWidth===c&&this.lastWindowHeight===f||this.setSize(c,
f);this.progress=0;this.last_progress=-1;var b=this;if(this.areAllTexturesAndSoundsLoaded()&&(4!==this.loaderstyle||z))this.go_loading_finished();else{f=Date.now()-this.start_time;if(a){var d=this.width,m=this.height;c=this.devicePixelRatio;if(3>this.loaderstyle&&(this.isCocoonJs||500<=f&&this.last_progress!=this.progress)){a.clearRect(0,0,d,m);f=d/2;m/=2;d=0===this.loaderstyle&&this.loaderlogos.logo.complete;var e=40*c,p=0,g=80*c;if(d){var t=this.loaderlogos.logo;g=t.width*c;var q=t.height*c;e=g/
2;p=q/2;a.drawImage(t,cr.floor(f-e),cr.floor(m-p),g,q)}1>=this.loaderstyle?(m+=p+(d?12*c:0),f=cr.floor(f-e)+.5,m=cr.floor(m)+.5,a.fillStyle=r?"red":"DodgerBlue",a.fillRect(f,m,Math.floor(g*this.progress),6*c),a.strokeStyle="black",a.strokeRect(f,m,g,6*c),a.strokeStyle="white",a.strokeRect(f-1*c,m-1*c,g+2*c,8*c)):2===this.loaderstyle&&(a.font=this.isEjecta?"12pt ArialMT":"12pt Arial",a.fillStyle=r?"#f00":"#999",a.textBaseLine="middle",c=Math.round(100*this.progress)+"%",d=a.measureText?a.measureText(c):
null,a.fillText(c,f-(d?d.width:0)/2,m));this.last_progress=this.progress}else if(4===this.loaderstyle){this.draw_c2_splash_loader(a);k?k(function(){b.go()}):setTimeout(function(){b.go()},16);return}}setTimeout(function(){b.go()},this.isCocoonJs?10:100)}}};var x=-1,C="undefined"===typeof cr_is_preview?200:0,v=!0,t=!1,A=0,B=0,E="undefined"===typeof cr_is_preview?3E3:0,m=null,p=null,K=0;a.prototype.draw_c2_splash_loader=function(a){if(!z){for(var c=Math.ceil(this.width),f=Math.ceil(this.height),d=this.loaderlogos.logo,
e=this.loaderlogos.powered,g=this.loaderlogos.website,k=0;4>k;++k)if(!d[k].complete||!e[k].complete||!g[k].complete)return;0===K&&(x=Date.now());k=Date.now();var q=!1,w=a;v||t?(a.clearRect(0,0,c,f),m&&m.width===c&&m.height===f||(m=document.createElement("canvas"),m.width=c,m.height=f,p=m.getContext("2d")),w=p,q=!0,v&&1===K&&(x=Date.now())):a.globalAlpha=1;w.fillStyle="#333333";w.fillRect(0,0,c,f);if(256<this.cssHeight){var h=cr.clamp(.22*f,105,.6*c);var n=.25*h;w.drawImage(b(e,h),.5*c-h/2,.2*f-n/
2,h,n);n=h=Math.min(.395*f,.95*c);w.drawImage(b(d,h),.5*c-h/2,.485*f-n/2,h,n);h=cr.clamp(.22*f,105,.6*c);n=.25*h;w.drawImage(b(g,h),.5*c-h/2,.868*f-n/2,h,n);w.fillStyle="#3C3C3C";n=Math.max(.005*f,2);w.fillRect(0,.8*f-n/2,c,n);w.fillStyle=r?"red":"#E0FF65";h=c*this.progress;w.fillRect(.5*c-h/2,.8*f-n/2,h,n)}else n=h=.55*f,w.drawImage(b(d,h),.5*c-h/2,.45*f-n/2,h,n),w.fillStyle="#3C3C3C",n=Math.max(.005*f,2),w.fillRect(0,.85*f-n/2,c,n),w.fillStyle=r?"red":"#E0FF65",h=c*this.progress,w.fillRect(.5*c-
h/2,.85*f-n/2,h,n);q&&(v?a.globalAlpha=0===K?0:Math.min((k-x)/300,1):t&&(a.globalAlpha=Math.max(1-(k-B)/300,0)),a.drawImage(m,0,0,c,f));v&&300<=k-x&&2<=K&&(v=!1,A=k);!v&&k-A>=E&&!t&&1<=this.progress&&(t=!0,B=k);if(t&&k-B>=300+C||"undefined"!==typeof cr_is_preview&&1<=this.progress&&500>Date.now()-x)z=!0,t=v=!1,this.loaderlogos=p=m=null;++K}};a.prototype.go_loading_finished=function(){this.overlay_canvas&&(this.canvas.parentNode.removeChild(this.overlay_canvas),this.overlay_canvas=this.overlay_ctx=
null);this.start_time=Date.now();this.last_fps_time=cr.performance_now();var a;if(this.uses_loader_layout){var c=0;for(a=this.types_by_index.length;c<a;c++){var f=this.types_by_index[c];f.is_family||f.isOnLoaderLayout||!f.plugin.is_world||(f.onCreate(),cr.seal(f))}}else this.isloading=!1;c=0;for(a=this.layouts_by_index.length;c<a;c++)this.layouts_by_index[c].createGlobalNonWorlds();2<=this.fullscreen_mode&&(c=this.original_width/this.original_height,a=this.width/this.height,this.aspect_scale=2!==
this.fullscreen_mode&&a>c||2===this.fullscreen_mode&&a<c?this.height/this.original_height:this.width/this.original_width);this.first_layout?this.layouts[this.first_layout].startRunning():this.layouts_by_index[0].startRunning();this.uses_loader_layout||(this.loadingprogress=1,this.trigger(cr.system_object.prototype.cnds.OnLoadFinished,null),window.C2_RegisterSW&&window.C2_RegisterSW());navigator.splashscreen&&navigator.splashscreen.hide&&navigator.splashscreen.hide();c=0;for(a=this.types_by_index.length;c<
a;c++)if(f=this.types_by_index[c],f.onAppBegin)f.onAppBegin();document.hidden||document.webkitHidden||document.mozHidden||document.msHidden?window.cr_setSuspended(!0):this.tick(!1);this.isDirectCanvas&&AppMobi.webview.execute("onGameReady();")};a.prototype.tick=function(a,c,f){if(this.running_layout){var b=cr.performance_now();if(f||!this.isSuspended||a){a||(k?this.raf_id=k(this.tickFunc):this.timeout_id=setTimeout(this.tickFunc,this.isMobile?1:16));c=c||b;var d=this.fullscreen_mode;((f=(document.mozFullScreen||
document.webkitIsFullScreen||document.fullScreen||!!document.msFullscreenElement)&&!this.isCordova)||this.isNodeFullscreen)&&0<this.fullscreen_scaling&&(d=this.fullscreen_scaling);if(0<d){d=window.innerWidth;var m=window.innerHeight;this.lastWindowWidth===d&&this.lastWindowHeight===m||this.setSize(d,m)}this.isDomFree||(f?this.firstInFullscreen||(this.firstInFullscreen=!0):this.firstInFullscreen?(this.firstInFullscreen=!1,0===this.fullscreen_mode&&this.setSize(Math.round(this.oldWidth/this.devicePixelRatio),
Math.round(this.oldHeight/this.devicePixelRatio),!0)):(this.oldWidth=this.width,this.oldHeight=this.height));this.isloading&&(f=this.areAllTexturesAndSoundsLoaded(),this.loadingprogress=this.progress,f&&(this.isloading=!1,this.progress=1,this.trigger(cr.system_object.prototype.cnds.OnLoadFinished,null),window.C2_RegisterSW&&window.C2_RegisterSW()));this.logic(c);!this.redraw&&!this.isCocoonJs||this.is_WebGL_context_lost||this.suspendDrawing||a||(this.redraw=!1,this.glwrap?this.drawGL():this.draw(),
this.snapshotCanvas&&(this.canvas&&this.canvas.toDataURL&&(this.snapshotData=this.canvas.toDataURL(this.snapshotCanvas[0],this.snapshotCanvas[1]),window.cr_onSnapshot&&window.cr_onSnapshot(this.snapshotData),this.trigger(cr.system_object.prototype.cnds.OnCanvasSnapshot,null)),this.snapshotCanvas=null));this.hit_breakpoint||(this.tickcount++,this.tickcount_nosave++,this.execcount++,this.framecount++);this.logictime+=cr.performance_now()-b}}};a.prototype.logic=function(a){var c;1E3<=a-this.last_fps_time&&
(this.last_fps_time+=1E3,1E3<=a-this.last_fps_time&&(this.last_fps_time=a),this.fps=this.framecount,this.framecount=0,this.cpuutilisation=this.logictime,this.logictime=0);var f=0;0!==this.last_tick_time&&(f=a-this.last_tick_time,0>f&&(f=0),this.dt1=f/=1E3,.5<this.dt1?this.dt1=0:this.dt1>1/this.minimumFramerate&&(this.dt1=1/this.minimumFramerate));this.last_tick_time=a;this.dt=this.dt1*this.timescale;this.kahanTime.add(this.dt);this.wallTime.add(f);a=(document.mozFullScreen||document.webkitIsFullScreen||
document.fullScreen||!!document.msFullscreenElement||this.isNodeFullscreen)&&!this.isCordova;if(2<=this.fullscreen_mode||a&&0<this.fullscreen_scaling){f=this.original_width/this.original_height;var b=this.width/this.height;var d=this.fullscreen_mode;a&&0<this.fullscreen_scaling&&(d=this.fullscreen_scaling);this.aspect_scale=2!==d&&b>f||2===d&&b<f?this.height/this.original_height:this.width/this.original_width;this.running_layout&&(this.running_layout.scrollToX(this.running_layout.scrollX),this.running_layout.scrollToY(this.running_layout.scrollY))}else this.aspect_scale=
this.isRetina?this.devicePixelRatio:1;this.ClearDeathRow();this.isInOnDestroy++;this.system.runWaits();this.isInOnDestroy--;this.ClearDeathRow();this.isInOnDestroy++;b=this.objects_to_pretick.valuesRef();a=0;for(f=b.length;a<f;a++)b[a].pretick();a=0;for(f=this.types_by_index.length;a<f;a++){var m=this.types_by_index[a];if(!m.is_family&&(m.behaviors.length||m.families.length))for(b=0,d=m.instances.length;b<d;b++){var e=m.instances[b];var p=0;for(c=e.behavior_insts.length;p<c;p++)e.behavior_insts[p].tick()}}a=
0;for(f=this.types_by_index.length;a<f;a++)if(m=this.types_by_index[a],!m.is_family&&(m.behaviors.length||m.families.length))for(b=0,d=m.instances.length;b<d;b++)for(e=m.instances[b],p=0,c=e.behavior_insts.length;p<c;p++){var g=e.behavior_insts[p];g.posttick&&g.posttick()}b=this.objects_to_tick.valuesRef();a=0;for(f=b.length;a<f;a++)b[a].tick();this.isInOnDestroy--;this.handleSaveLoad();for(a=0;this.changelayout&&10>a++;)this.doChangeLayout(this.changelayout);a=0;for(f=this.eventsheets_by_index.length;a<
f;a++)this.eventsheets_by_index[a].hasRun=!1;this.running_layout.event_sheet&&this.running_layout.event_sheet.run();cr.clearArray(this.registered_collisions);this.layout_first_tick=!1;this.isInOnDestroy++;a=0;for(f=this.types_by_index.length;a<f;a++)if(m=this.types_by_index[a],!m.is_family&&(m.behaviors.length||m.families.length))for(b=0,d=m.instances.length;b<d;b++)for(e=m.instances[b],p=0,c=e.behavior_insts.length;p<c;p++)g=e.behavior_insts[p],g.tick2&&g.tick2();b=this.objects_to_tick2.valuesRef();
a=0;for(f=b.length;a<f;a++)b[a].tick2();this.isInOnDestroy--};a.prototype.onWindowBlur=function(){var a,c,f;var b=0;for(a=this.types_by_index.length;b<a;b++){var d=this.types_by_index[b];if(!d.is_family){var m=0;for(c=d.instances.length;m<c;m++){var e=d.instances[m];if(e.onWindowBlur)e.onWindowBlur();if(e.behavior_insts){var p=0;for(f=e.behavior_insts.length;p<f;p++){var g=e.behavior_insts[p];if(g.onWindowBlur)g.onWindowBlur()}}}}}};a.prototype.doChangeLayout=function(a){var c=this.running_layout;
this.running_layout.stopRunning();var f;if(this.glwrap){var b=0;for(f=this.types_by_index.length;b<f;b++){var d=this.types_by_index[b];d.is_family||!d.unloadTextures||d.global&&0!==d.instances.length||-1!==a.initial_types.indexOf(d)||d.unloadTextures()}}c==a&&cr.clearArray(this.system.waits);cr.clearArray(this.registered_collisions);this.runLayoutChangeMethods(!0);a.startRunning();this.runLayoutChangeMethods(!1);this.layout_first_tick=this.redraw=!0;this.ClearDeathRow()};a.prototype.runLayoutChangeMethods=
function(a){var c,f,b;var d=0;for(c=this.behaviors.length;d<c;d++){var m=this.behaviors[d];if(a){if(m.onBeforeLayoutChange)m.onBeforeLayoutChange()}else if(m.onLayoutChange)m.onLayoutChange()}d=0;for(c=this.types_by_index.length;d<c;d++)if(m=this.types_by_index[d],m.global||m.plugin.singleglobal){var e=0;for(f=m.instances.length;e<f;e++){var p=m.instances[e];if(a){if(p.onBeforeLayoutChange)p.onBeforeLayoutChange()}else if(p.onLayoutChange)p.onLayoutChange();if(p.behavior_insts){var g=0;for(b=p.behavior_insts.length;g<
b;g++){var t=p.behavior_insts[g];if(a){if(t.onBeforeLayoutChange)t.onBeforeLayoutChange()}else if(t.onLayoutChange)t.onLayoutChange()}}}}};a.prototype.pretickMe=function(a){this.objects_to_pretick.add(a)};a.prototype.unpretickMe=function(a){this.objects_to_pretick.remove(a)};a.prototype.tickMe=function(a){this.objects_to_tick.add(a)};a.prototype.untickMe=function(a){this.objects_to_tick.remove(a)};a.prototype.tick2Me=function(a){this.objects_to_tick2.add(a)};a.prototype.untick2Me=function(a){this.objects_to_tick2.remove(a)};
a.prototype.getDt=function(a){return a&&-1!==a.my_timescale?this.dt1*a.my_timescale:this.dt};a.prototype.draw=function(){this.running_layout.draw(this.ctx);this.isDirectCanvas&&this.ctx.present()};a.prototype.drawGL=function(){this.enableFrontToBack&&(this.earlyz_index=1,this.running_layout.drawGL_earlyZPass(this.glwrap));this.running_layout.drawGL(this.glwrap);this.glwrap.present()};a.prototype.addDestroyCallback=function(a){a&&this.destroycallbacks.push(a)};a.prototype.removeDestroyCallback=function(a){cr.arrayFindRemove(this.destroycallbacks,
a)};a.prototype.getObjectByUID=function(a){a=a.toString();return this.objectsByUid.hasOwnProperty(a)?this.objectsByUid[a]:null};var I=[];a.prototype.DestroyInstance=function(a){var c;var f=a.type.name;if(this.deathRow.hasOwnProperty(f)){var b=this.deathRow[f];if(b.contains(a))return}else b=I.length?I.pop():new cr.ObjectSet,this.deathRow[f]=b;b.add(a);this.hasPendingInstances=!0;if(a.is_contained)for(f=0,c=a.siblings.length;f<c;f++)this.DestroyInstance(a.siblings[f]);this.isInClearDeathRow&&b.values_cache.push(a);
this.isEndingLayout||(this.isInOnDestroy++,this.trigger(Object.getPrototypeOf(a.type.plugin).cnds.OnDestroyed,a),this.isInOnDestroy--)};a.prototype.ClearDeathRow=function(){if(this.hasPendingInstances){var a,c;this.isInClearDeathRow=!0;var f=0;for(a=this.createRow.length;f<a;++f){var b=this.createRow[f];var d=b.type;d.instances.push(b);var m=0;for(c=d.families.length;m<c;++m)d.families[m].instances.push(b),d.families[m].stale_iids=!0}cr.clearArray(this.createRow);this.IterateDeathRow();cr.wipe(this.deathRow);
this.hasPendingInstances=this.isInClearDeathRow=!1}};a.prototype.IterateDeathRow=function(){for(var a in this.deathRow)this.deathRow.hasOwnProperty(a)&&this.ClearDeathRowForType(this.deathRow[a])};a.prototype.ClearDeathRowForType=function(a){var c=a.valuesRef(),f=c[0].type,b,d;cr.arrayRemoveAllFromObjectSet(f.instances,a);f.stale_iids=!0;0===f.instances.length&&(f.any_instance_parallaxed=!1);var m=0;for(b=f.families.length;m<b;++m){var e=f.families[m];cr.arrayRemoveAllFromObjectSet(e.instances,a);
e.stale_iids=!0}m=0;for(b=this.system.waits.length;m<b;++m){var p=this.system.waits[m];p.sols.hasOwnProperty(f.index)&&cr.arrayRemoveAllFromObjectSet(p.sols[f.index].insts,a);if(!f.is_family){var g=0;for(d=f.families.length;g<d;++g)e=f.families[g],p.sols.hasOwnProperty(e.index)&&cr.arrayRemoveAllFromObjectSet(p.sols[e.index].insts,a)}}if(p=c[0].layer){if(p.useRenderCells)for(g=p.instances,m=0,b=g.length;m<b;++m)d=g[m],a.contains(d)&&(d.update_bbox(),p.render_grid.update(d,d.rendercells,null),d.rendercells.set(0,
0,-1,-1));cr.arrayRemoveAllFromObjectSet(p.instances,a);p.setZIndicesStaleFrom(0)}for(m=0;m<c.length;++m)this.ClearDeathRowForSingleInstance(c[m],f);a.clear();I.push(a);this.redraw=!0};a.prototype.ClearDeathRowForSingleInstance=function(a,c){var f;var b=0;for(f=this.destroycallbacks.length;b<f;++b)this.destroycallbacks[b](a);a.collcells&&c.collision_grid.update(a,a.collcells,null);(b=a.layer)&&b.removeFromInstanceList(a,!0);if(a.behavior_insts)for(b=0,f=a.behavior_insts.length;b<f;++b){var d=a.behavior_insts[b];
if(d.onDestroy)d.onDestroy();d.behavior.my_instances.remove(a)}this.objects_to_pretick.remove(a);this.objects_to_tick.remove(a);this.objects_to_tick2.remove(a);if(a.onDestroy)a.onDestroy();this.objectsByUid.hasOwnProperty(a.uid.toString())&&delete this.objectsByUid[a.uid.toString()];this.objectcount--;100>c.deadCache.length&&c.deadCache.push(a)};a.prototype.createInstance=function(a,c,f,b){if(a.is_family){var d=cr.floor(Math.random()*a.members.length);return this.createInstance(a.members[d],c,f,b)}return a.default_instance?
this.createInstanceFromInit(a.default_instance,c,!1,f,b,!1):null};var M=[];a.prototype.createInstanceFromInit=function(a,c,f,b,d,m){var e,p;if(!a)return null;var g=this.types_by_index[a[1]],t=g.plugin.is_world;if(this.isloading&&t&&!g.isOnLoaderLayout||t&&!this.glwrap&&11===a[0][11])return null;var k=c;t||(c=null);if(g.deadCache.length){var q=g.deadCache.pop();q.recycled=!0;g.plugin.Instance.call(q,g)}else q=new g.plugin.Instance(g),q.recycled=!1;!f||m||this.objectsByUid.hasOwnProperty(a[2].toString())?
q.uid=this.next_uid++:q.uid=a[2];this.objectsByUid[q.uid.toString()]=q;q.puid=this.next_puid++;q.iid=g.instances.length;var h=0;for(e=this.createRow.length;h<e;++h)this.createRow[h].type===g&&q.iid++;q.get_iid=cr.inst_get_iid;q.toString=cr.inst_toString;var v=a[3];if(q.recycled)cr.wipe(q.extra);else{q.extra={};if("undefined"!==typeof cr_is_preview)for(q.instance_var_names=[],q.instance_var_names.length=v.length,h=0,e=v.length;h<e;h++)q.instance_var_names[h]=v[h][1];q.instance_vars=[];q.instance_vars.length=
v.length}h=0;for(e=v.length;h<e;h++)q.instance_vars[h]=v[h][0];if(t){var n=a[0];q.x=cr.is_undefined(b)?n[0]:b;q.y=cr.is_undefined(d)?n[1]:d;q.z=n[2];q.width=n[3];q.height=n[4];q.depth=n[5];q.angle=n[6];q.opacity=n[7];q.hotspotX=n[8];q.hotspotY=n[9];q.blend_mode=n[10];h=n[11];!this.glwrap&&g.effect_types.length&&(q.blend_mode=h);q.compositeOp=cr.effectToCompositeOp(q.blend_mode);this.gl&&cr.setGLBlend(q,q.blend_mode,this.gl);if(q.recycled){h=0;for(e=n[12].length;h<e;h++)for(v=0,p=n[12][h].length;v<
p;v++)q.effect_params[h][v]=n[12][h][v];q.bbox.set(0,0,0,0);q.collcells.set(0,0,-1,-1);q.rendercells.set(0,0,-1,-1);q.bquad.set_from_rect(q.bbox);cr.clearArray(q.bbox_changed_callbacks)}else{q.effect_params=n[12].slice(0);h=0;for(e=q.effect_params.length;h<e;h++)q.effect_params[h]=n[12][h].slice(0);q.active_effect_types=[];q.active_effect_flags=[];q.active_effect_flags.length=g.effect_types.length;q.bbox=new cr.rect(0,0,0,0);q.collcells=new cr.rect(0,0,-1,-1);q.rendercells=new cr.rect(0,0,-1,-1);
q.bquad=new cr.quad;q.bbox_changed_callbacks=[];q.set_bbox_changed=cr.set_bbox_changed;q.add_bbox_changed_callback=cr.add_bbox_changed_callback;q.contains_pt=cr.inst_contains_pt;q.update_bbox=cr.update_bbox;q.update_render_cell=cr.update_render_cell;q.update_collision_cell=cr.update_collision_cell;q.get_zindex=cr.inst_get_zindex}q.tilemap_exists=!1;q.tilemap_width=0;q.tilemap_height=0;q.tilemap_data=null;14===n.length&&(q.tilemap_exists=!0,q.tilemap_width=n[13][0],q.tilemap_height=n[13][1],q.tilemap_data=
n[13][2]);h=0;for(e=g.effect_types.length;h<e;h++)q.active_effect_flags[h]=!0;q.shaders_preserve_opaqueness=!0;q.updateActiveEffects=cr.inst_updateActiveEffects;q.updateActiveEffects();q.uses_shaders=!!q.active_effect_types.length;q.bbox_changed=!0;q.cell_changed=!0;g.any_cell_changed=!0;q.visible=!0;q.my_timescale=-1;q.layer=c;q.zindex=c.instances.length;q.earlyz_index=0;"undefined"===typeof q.collision_poly&&(q.collision_poly=null);this.redraw=q.collisionsEnabled=!0}cr.clearArray(M);h=0;for(e=g.families.length;h<
e;h++)M.push.apply(M,g.families[h].behaviors);M.push.apply(M,g.behaviors);if(q.recycled)for(h=0,e=M.length;h<e;h++){var r=M[h];var A=q.behavior_insts[h];A.recycled=!0;r.behavior.Instance.call(A,r,q);n=a[4][h];v=0;for(p=n.length;v<p;v++)A.properties[v]=n[v];A.onCreate();r.behavior.my_instances.add(q)}else for(q.behavior_insts=[],h=0,e=M.length;h<e;h++)r=M[h],A=new r.behavior.Instance(r,q),A.recycled=!1,A.properties=a[4][h].slice(0),A.onCreate(),cr.seal(A),q.behavior_insts.push(A),r.behavior.my_instances.add(q);
n=a[5];if(q.recycled)for(h=0,e=n.length;h<e;h++)q.properties[h]=n[h];else q.properties=n.slice(0);this.createRow.push(q);this.hasPendingInstances=!0;c&&(c.appendToInstanceList(q,!0),1!==c.parallaxX||1!==c.parallaxY)&&(g.any_instance_parallaxed=!0);this.objectcount++;if(g.is_contained){if(q.is_contained=!0,q.recycled?cr.clearArray(q.siblings):q.siblings=[],!f&&!m){h=0;for(e=g.container.length;h<e;h++)if(g.container[h]!==g){if(!g.container[h].default_instance)return null;q.siblings.push(this.createInstanceFromInit(g.container[h].default_instance,
k,!1,t?q.x:b,t?q.y:d,!0))}h=0;for(e=q.siblings.length;h<e;h++)for(q.siblings[h].siblings.push(q),v=0;v<e;v++)h!==v&&q.siblings[h].siblings.push(q.siblings[v])}}else q.is_contained=!1,q.siblings=null;q.onCreate();q.recycled||cr.seal(q);h=0;for(e=q.behavior_insts.length;h<e;h++)q.behavior_insts[h].postCreate&&q.behavior_insts[h].postCreate();return q};a.prototype.getLayerByName=function(a){var c;var f=0;for(c=this.running_layout.layers.length;f<c;f++){var b=this.running_layout.layers[f];if(cr.equals_nocase(b.name,
a))return b}return null};a.prototype.getLayerByNumber=function(a){a=cr.floor(a);0>a&&(a=0);a>=this.running_layout.layers.length&&(a=this.running_layout.layers.length-1);return this.running_layout.layers[a]};a.prototype.getLayer=function(a){return cr.is_number(a)?this.getLayerByNumber(a):this.getLayerByName(a.toString())};a.prototype.clearSol=function(a){var c;var f=0;for(c=a.length;f<c;f++)a[f].getCurrentSol().select_all=!0};a.prototype.pushCleanSol=function(a){var c;var f=0;for(c=a.length;f<c;f++)a[f].pushCleanSol()};
a.prototype.pushCopySol=function(a){var c;var f=0;for(c=a.length;f<c;f++)a[f].pushCopySol()};a.prototype.popSol=function(a){var c;var f=0;for(c=a.length;f<c;f++)a[f].popSol()};a.prototype.updateAllCells=function(a){if(a.any_cell_changed){var c,f=a.instances;var b=0;for(c=f.length;b<c;++b)f[b].update_collision_cell();f=this.createRow;b=0;for(c=f.length;b<c;++b)f[b].type===a&&f[b].update_collision_cell();a.any_cell_changed=!1}};a.prototype.getCollisionCandidates=function(a,c,f,b){var d,m=a?1!==a.parallaxX||
1!==a.parallaxY:!1;if(c.is_family)for(a=0,d=c.members.length;a<d;++a){var e=c.members[a];m||e.any_instance_parallaxed?cr.appendArray(b,e.instances):(this.updateAllCells(e),e.collision_grid.queryRange(f,b))}else m||c.any_instance_parallaxed?cr.appendArray(b,c.instances):(this.updateAllCells(c),c.collision_grid.queryRange(f,b))};a.prototype.getTypesCollisionCandidates=function(a,c,f,b){var d;var m=0;for(d=c.length;m<d;++m)this.getCollisionCandidates(a,c[m],f,b)};a.prototype.getSolidCollisionCandidates=
function(a,c,f){var b=this.getSolidBehavior();if(!b)return null;this.getTypesCollisionCandidates(a,b.my_types,c,f)};a.prototype.getJumpthruCollisionCandidates=function(a,c,f){var b=this.getJumpthruBehavior();if(!b)return null;this.getTypesCollisionCandidates(a,b.my_types,c,f)};a.prototype.testAndSelectCanvasPointOverlap=function(a,c,f,b){var d=a.getCurrentSol(),m,e=this.getCurrentEventStack().current_event.orblock;if(d.select_all){b||(d.select_all=!1,cr.clearArray(d.instances));var p=0;for(m=a.instances.length;p<
m;p++){var g=a.instances[p];g.update_bbox();var t=g.layer.canvasToLayer(c,f,!0);var q=g.layer.canvasToLayer(c,f,!1);if(g.contains_pt(t,q)){if(b)return!1;d.instances.push(g)}else e&&d.else_instances.push(g)}}else{var k=0;var h=e?d.else_instances:d.instances;p=0;for(m=h.length;p<m;p++)if(g=h[p],g.update_bbox(),t=g.layer.canvasToLayer(c,f,!0),q=g.layer.canvasToLayer(c,f,!1),g.contains_pt(t,q)){if(b)return!1;e?d.instances.push(g):(d.instances[k]=d.instances[p],k++)}b||(h.length=k)}a.applySolToContainer();
return b?!0:d.hasObjects()};a.prototype.testOverlap=function(a,c){if(!(a&&c&&a!==c&&a.collisionsEnabled&&c.collisionsEnabled))return!1;a.update_bbox();c.update_bbox();var f=a.layer,b=c.layer,d;if(f===b||f.parallaxX===b.parallaxX&&b.parallaxY===b.parallaxY&&f.scale===b.scale&&f.angle===b.angle&&f.zoomRate===b.zoomRate){if(!a.bbox.intersects_rect(c.bbox)||!a.bquad.intersects_quad(c.bquad)||a.tilemap_exists&&c.tilemap_exists)return!1;if(a.tilemap_exists)return this.testTilemapOverlap(a,c);if(c.tilemap_exists)return this.testTilemapOverlap(c,
a);var m=a.collision_poly&&!a.collision_poly.is_empty();var e=c.collision_poly&&!c.collision_poly.is_empty();if(!m&&!e)return!0;m?(a.collision_poly.cache_poly(a.width,a.height,a.angle),m=a.collision_poly):(this.temp_poly.set_from_quad(a.bquad,a.x,a.y,a.width,a.height),m=this.temp_poly);if(e){c.collision_poly.cache_poly(c.width,c.height,c.angle);var p=c.collision_poly}else this.temp_poly.set_from_quad(c.bquad,c.x,c.y,c.width,c.height),p=this.temp_poly;return m.intersects_poly(p,c.x-a.x,c.y-a.y)}m=
a.collision_poly&&!a.collision_poly.is_empty();e=c.collision_poly&&!c.collision_poly.is_empty();m?(a.collision_poly.cache_poly(a.width,a.height,a.angle),this.temp_poly.set_from_poly(a.collision_poly)):this.temp_poly.set_from_quad(a.bquad,a.x,a.y,a.width,a.height);m=this.temp_poly;e?(c.collision_poly.cache_poly(c.width,c.height,c.angle),this.temp_poly2.set_from_poly(c.collision_poly)):this.temp_poly2.set_from_quad(c.bquad,c.x,c.y,c.width,c.height);p=this.temp_poly2;e=0;for(d=m.pts_count;e<d;e++){var g=
2*e;var t=g+1;var q=m.pts_cache[g];var k=m.pts_cache[t];m.pts_cache[g]=f.layerToCanvas(q+a.x,k+a.y,!0);m.pts_cache[t]=f.layerToCanvas(q+a.x,k+a.y,!1)}m.update_bbox();e=0;for(d=p.pts_count;e<d;e++)g=2*e,t=g+1,q=p.pts_cache[g],k=p.pts_cache[t],p.pts_cache[g]=b.layerToCanvas(q+c.x,k+c.y,!0),p.pts_cache[t]=b.layerToCanvas(q+c.x,k+c.y,!1);p.update_bbox();return m.intersects_poly(p,0,0)};var O=new cr.quad,G=new cr.rect(0,0,0,0),H=[];a.prototype.testTilemapOverlap=function(a,c){var f,b=c.bbox,d=a.x,m=a.y;
a.getCollisionRectCandidates(b,H);var e=c.collision_poly&&!c.collision_poly.is_empty();a=0;for(f=H.length;a<f;++a){var p=H[a];var g=p.rc;if(b.intersects_rect_off(g,d,m)&&(O.set_from_rect(g),O.offset(d,m),O.intersects_quad(c.bquad)))if(e)if(c.collision_poly.cache_poly(c.width,c.height,c.angle),p.poly){if(p.poly.intersects_poly(c.collision_poly,c.x-(d+g.left),c.y-(m+g.top)))return cr.clearArray(H),!0}else{if(this.temp_poly.set_from_quad(O,0,0,g.right-g.left,g.bottom-g.top),this.temp_poly.intersects_poly(c.collision_poly,
c.x,c.y))return cr.clearArray(H),!0}else if(p.poly){if(this.temp_poly.set_from_quad(c.bquad,0,0,c.width,c.height),p.poly.intersects_poly(this.temp_poly,-(d+g.left),-(m+g.top)))return cr.clearArray(H),!0}else return cr.clearArray(H),!0}cr.clearArray(H);return!1};a.prototype.testRectOverlap=function(a,c){if(!c||!c.collisionsEnabled)return!1;c.update_bbox();if(!c.bbox.intersects_rect(a))return!1;if(c.tilemap_exists){c.getCollisionRectCandidates(a,H);var f,b=c.x,d=c.y;c=0;for(f=H.length;c<f;++c){var m=
H[c];var e=m.rc;if(a.intersects_rect_off(e,b,d))if(m.poly){if(this.temp_poly.set_from_rect(a,0,0),m.poly.intersects_poly(this.temp_poly,-(b+e.left),-(d+e.top)))return cr.clearArray(H),!0}else return cr.clearArray(H),!0}cr.clearArray(H);return!1}O.set_from_rect(a);if(!c.bquad.intersects_quad(O))return!1;if(!c.collision_poly||c.collision_poly.is_empty())return!0;c.collision_poly.cache_poly(c.width,c.height,c.angle);O.offset(-a.left,-a.top);this.temp_poly.set_from_quad(O,0,0,1,1);return c.collision_poly.intersects_poly(this.temp_poly,
a.left-c.x,a.top-c.y)};a.prototype.testSegmentOverlap=function(a,c,f,b,d){if(!d||!d.collisionsEnabled)return!1;d.update_bbox();G.set(cr.min(a,f),cr.min(c,b),cr.max(a,f),cr.max(c,b));if(!d.bbox.intersects_rect(G))return!1;if(d.tilemap_exists){d.getCollisionRectCandidates(G,H);var m,e=d.x,p=d.y;d=0;for(m=H.length;d<m;++d){var g=H[d];var t=g.rc;if(G.intersects_rect_off(t,e,p)&&(O.set_from_rect(t),O.offset(e,p),O.intersects_segment(a,c,f,b)))if(g.poly){if(g.poly.intersects_segment(e+t.left,p+t.top,a,
c,f,b))return cr.clearArray(H),!0}else return cr.clearArray(H),!0}cr.clearArray(H);return!1}if(!d.bquad.intersects_segment(a,c,f,b))return!1;if(!d.collision_poly||d.collision_poly.is_empty())return!0;d.collision_poly.cache_poly(d.width,d.height,d.angle);return d.collision_poly.intersects_segment(d.x,d.y,a,c,f,b)};a.prototype.typeHasBehavior=function(a,c){if(!c)return!1;var f,b;var d=0;for(f=a.behaviors.length;d<f;d++)if(a.behaviors[d].behavior instanceof c)return!0;if(!a.is_family)for(d=0,f=a.families.length;d<
f;d++){var m=a.families[d];var e=0;for(b=m.behaviors.length;e<b;e++)if(m.behaviors[e].behavior instanceof c)return!0}return!1};a.prototype.typeHasNoSaveBehavior=function(a){return this.typeHasBehavior(a,cr.behaviors.NoSave)};a.prototype.typeHasPersistBehavior=function(a){return this.typeHasBehavior(a,cr.behaviors.Persist)};a.prototype.getSolidBehavior=function(){return this.solidBehavior};a.prototype.getJumpthruBehavior=function(){return this.jumpthruBehavior};var F=[];a.prototype.testOverlapSolid=
function(a){var c;a.update_bbox();this.getSolidCollisionCandidates(a.layer,a.bbox,F);var f=0;for(c=F.length;f<c;++f){var b=F[f];if(b.extra.solidEnabled&&this.testOverlap(a,b))return cr.clearArray(F),b}cr.clearArray(F);return null};a.prototype.testRectOverlapSolid=function(a){var c;this.getSolidCollisionCandidates(null,a,F);var f=0;for(c=F.length;f<c;++f){var b=F[f];if(b.extra.solidEnabled&&this.testRectOverlap(a,b))return cr.clearArray(F),b}cr.clearArray(F);return null};var J=[];a.prototype.testOverlapJumpThru=
function(a,c){var f=null;c&&(f=J,cr.clearArray(f));a.update_bbox();this.getJumpthruCollisionCandidates(a.layer,a.bbox,F);var b;var d=0;for(b=F.length;d<b;++d){var m=F[d];if(m.extra.jumpthruEnabled&&this.testOverlap(a,m))if(c)f.push(m);else return cr.clearArray(F),m}cr.clearArray(F);return f};a.prototype.pushOutSolid=function(a,c,f,b,d,m){b=b||50;var e=a.x,p=a.y,g,t=null,q=null;for(g=0;g<b;g++)if(a.x=e+c*g,a.y=p+f*g,a.set_bbox_changed(),!this.testOverlap(a,t)&&((t=this.testOverlapSolid(a))&&(q=t),
!t&&(d&&(t=m?this.testOverlap(a,m)?m:null:this.testOverlapJumpThru(a))&&(q=t),!t)))return q&&this.pushInFractional(a,c,f,q,16),!0;a.x=e;a.y=p;a.set_bbox_changed();return!1};a.prototype.pushOutSolidAxis=function(a,c,f,b){b=b||50;var d=a.x,m=a.y,e=null,p=null,g,t;for(g=0;g<b;++g)for(t=0;2>t;++t){var q=2*t-1;a.x=d+c*g*q;a.y=m+f*g*q;a.set_bbox_changed();if(!this.testOverlap(a,e))if(e=this.testOverlapSolid(a))p=e;else return p&&this.pushInFractional(a,c*q,f*q,p,16),!0}a.x=d;a.y=m;a.set_bbox_changed();
return!1};a.prototype.pushOut=function(a,c,f,b,d){b=b||50;var m=a.x,e=a.y,p;for(p=0;p<b;p++)if(a.x=m+c*p,a.y=e+f*p,a.set_bbox_changed(),!this.testOverlap(a,d))return!0;a.x=m;a.y=e;a.set_bbox_changed();return!1};a.prototype.pushInFractional=function(a,c,f,b,d){var m=2,e=!1;var p=!1;for(var g=a.x,t=a.y;m<=d;)p=1/m,m*=2,a.x+=c*p*(e?1:-1),a.y+=f*p*(e?1:-1),a.set_bbox_changed(),this.testOverlap(a,b)?p=e=!0:(p=e=!1,g=a.x,t=a.y);p&&(a.x=g,a.y=t,a.set_bbox_changed())};a.prototype.pushOutSolidNearest=function(a,
c){c=cr.is_undefined(c)?100:c;var f=0,b=a.x,d=a.y,m=0,e=0,p=0,g=this.testOverlapSolid(a);if(!g)return!0;for(;f<=c;){switch(m){case 0:e=0;p=-1;f++;break;case 1:e=1;p=-1;break;case 2:e=1;p=0;break;case 3:p=e=1;break;case 4:e=0;p=1;break;case 5:e=-1;p=1;break;case 6:e=-1;p=0;break;case 7:p=e=-1}m=(m+1)%8;a.x=cr.floor(b+e*f);a.y=cr.floor(d+p*f);a.set_bbox_changed();if(!this.testOverlap(a,g)&&(g=this.testOverlapSolid(a),!g))return!0}a.x=b;a.y=d;a.set_bbox_changed();return!1};a.prototype.registerCollision=
function(a,c){a.collisionsEnabled&&c.collisionsEnabled&&this.registered_collisions.push([a,c])};a.prototype.addRegisteredCollisionCandidates=function(a,c,f){var b;var d=0;for(b=this.registered_collisions.length;d<b;++d){var m=this.registered_collisions[d];if(m[0]===a)m=m[1];else if(m[1]===a)m=m[0];else continue;if(c.is_family){if(-1===c.members.indexOf(c))continue}else if(m.type!==c)continue;-1===f.indexOf(m)&&f.push(m)}};a.prototype.checkRegisteredCollision=function(a,c){var f;var b=0;for(f=this.registered_collisions.length;b<
f;b++){var d=this.registered_collisions[b];if(d[0]===a&&d[1]===c||d[0]===c&&d[1]===a)return!0}return!1};a.prototype.calculateSolidBounceAngle=function(a,c,f,b){var d=a.x,m=a.y,e=cr.max(10,cr.distanceTo(c,f,d,m)),p=cr.angleTo(c,f,d,m),g=b||this.testOverlapSolid(a);if(!g)return cr.clamp_angle(p+cr.PI);var t=g,q,k=cr.to_radians(5);for(q=1;36>q;q++){var h=p-q*k;a.x=c+Math.cos(h)*e;a.y=f+Math.sin(h)*e;a.set_bbox_changed();if(!this.testOverlap(a,t)&&(t=b?null:this.testOverlapSolid(a),!t)){var v=h;break}}36===
q&&(v=cr.clamp_angle(p+cr.PI));t=g;for(q=1;36>q;q++)if(h=p+q*k,a.x=c+Math.cos(h)*e,a.y=f+Math.sin(h)*e,a.set_bbox_changed(),!this.testOverlap(a,t)&&(t=b?null:this.testOverlapSolid(a),!t)){var n=h;break}36===q&&(n=cr.clamp_angle(p+cr.PI));a.x=d;a.y=m;a.set_bbox_changed();if(n===v)return n;a=cr.angleDiff(n,v)/2;a=cr.angleClockwise(n,v)?cr.clamp_angle(v+a+cr.PI):cr.clamp_angle(n+a);v=Math.cos(p);p=Math.sin(p);n=Math.cos(a);a=Math.sin(a);c=v*n+p*a;return cr.angleTo(0,0,v-2*c*n,p-2*c*a)};var P=-1;a.prototype.trigger=
function(a,c,f){if(!this.running_layout)return!1;var b=this.running_layout.event_sheet;if(!b)return!1;var d=!1,m;P++;var e=b.deep_includes;var p=0;for(m=e.length;p<m;++p){var g=this.triggerOnSheet(a,c,e[p],f);d=d||g}g=this.triggerOnSheet(a,c,b,f);P--;return d||g};a.prototype.triggerOnSheet=function(a,c,f,b){var d=!1,m;if(c){var e=this.triggerOnSheetForTypeName(a,c,c.type.name,f,b);d=d||e;var p=c.type.families;var g=0;for(m=p.length;g<m;++g)e=this.triggerOnSheetForTypeName(a,c,p[g].name,f,b),d=d||
e}else e=this.triggerOnSheetForTypeName(a,c,"system",f,b),d=d||e;return d};a.prototype.triggerOnSheetForTypeName=function(a,c,f,b,d){var m,e=!1;var p="undefined"!==typeof d;var g=(p?b.fasttriggers:b.triggers)[f];if(!g)return e;var t=null;b=0;for(m=g.length;b<m;++b)if(g[b].method==a){t=g[b].evs;break}if(!t)return e;a=p?t[d]:t;if(!a)return null;b=0;for(m=a.length;b<m;b++)d=a[b][0],p=a[b][1],d=this.executeSingleTrigger(c,f,d,p),e=e||d;return e};a.prototype.executeSingleTrigger=function(a,c,f,b){var d,
m=!1;this.trigger_depth++;var e=this.getCurrentEventStack().current_event;e&&this.pushCleanSol(e.solModifiersIncludingParents);var p=1<this.trigger_depth;this.pushCleanSol(f.solModifiersIncludingParents);p&&this.pushLocalVarStack();var g=this.pushEventStack(f);g.current_event=f;if(a){var t=this.types[c].getCurrentSol();t.select_all=!1;cr.clearArray(t.instances);t.instances[0]=a;this.types[c].applySolToContainer()}a=!0;if(f.parent){c=g.temp_parents_arr;for(t=f.parent;t;)c.push(t),t=t.parent;c.reverse();
t=0;for(d=c.length;t<d;t++)if(!c[t].run_pretrigger()){a=!1;break}}a&&(this.execcount++,f.orblock?f.run_orblocktrigger(b):f.run(),m=m||g.last_event_true);this.popEventStack();p&&this.popLocalVarStack();this.popSol(f.solModifiersIncludingParents);e&&this.popSol(e.solModifiersIncludingParents);this.hasPendingInstances&&0===this.isInOnDestroy&&0===P&&!this.isRunningEvents&&this.ClearDeathRow();this.trigger_depth--;return m};a.prototype.getCurrentCondition=function(){var a=this.getCurrentEventStack();
return a.current_event.conditions[a.cndindex]};a.prototype.getCurrentConditionObjectType=function(){return this.getCurrentCondition().type};a.prototype.isCurrentConditionFirst=function(){return 0===this.getCurrentEventStack().cndindex};a.prototype.getCurrentAction=function(){var a=this.getCurrentEventStack();return a.current_event.actions[a.actindex]};a.prototype.pushLocalVarStack=function(){this.localvar_stack_index++;this.localvar_stack_index>=this.localvar_stack.length&&this.localvar_stack.push([])};
a.prototype.popLocalVarStack=function(){this.localvar_stack_index--};a.prototype.getCurrentLocalVarStack=function(){return this.localvar_stack[this.localvar_stack_index]};a.prototype.pushEventStack=function(a){this.event_stack_index++;this.event_stack_index>=this.event_stack.length&&this.event_stack.push(new cr.eventStackFrame);var c=this.getCurrentEventStack();c.reset(a);return c};a.prototype.popEventStack=function(){this.event_stack_index--};a.prototype.getCurrentEventStack=function(){return this.event_stack[this.event_stack_index]};
a.prototype.pushLoopStack=function(a){this.loop_stack_index++;this.loop_stack_index>=this.loop_stack.length&&this.loop_stack.push(cr.seal({name:a,index:0,stopped:!1}));var c=this.getCurrentLoop();c.name=a;c.index=0;c.stopped=!1;return c};a.prototype.popLoopStack=function(){this.loop_stack_index--};a.prototype.getCurrentLoop=function(){return this.loop_stack[this.loop_stack_index]};a.prototype.getEventVariableByName=function(a,c){for(var f,b,d,m,e;c;){f=0;for(b=c.subevents.length;f<b;f++)if(e=c.subevents[f],
e instanceof cr.eventvariable&&cr.equals_nocase(a,e.name))return e;c=c.parent}f=0;for(b=this.eventsheets_by_index.length;f<b;f++)for(m=this.eventsheets_by_index[f],c=0,d=m.events.length;c<d;c++)if(e=m.events[c],e instanceof cr.eventvariable&&cr.equals_nocase(a,e.name))return e;return null};a.prototype.getLayoutBySid=function(a){var c;var f=0;for(c=this.layouts_by_index.length;f<c;f++)if(this.layouts_by_index[f].sid===a)return this.layouts_by_index[f];return null};a.prototype.getObjectTypeBySid=function(a){var c;
var f=0;for(c=this.types_by_index.length;f<c;f++)if(this.types_by_index[f].sid===a)return this.types_by_index[f];return null};a.prototype.getGroupBySid=function(a){var c;var f=0;for(c=this.allGroups.length;f<c;f++)if(this.allGroups[f].sid===a)return this.allGroups[f];return null};a.prototype.doCanvasSnapshot=function(a,c){this.snapshotCanvas=[a,c];this.redraw=!0};a.prototype.signalContinuousPreview=function(){this.signalledContinuousPreview=!0};a.prototype.handleSaveLoad=function(){var a=this,c=this.saveToSlot,
f=this.lastSaveJson,b=this.loadFromSlot,d=!1;this.signalledContinuousPreview&&(d=!0,c="__c2_continuouspreview",this.signalledContinuousPreview=!1);if(c.length){this.ClearDeathRow();f=this.saveToJSONString();if(e()&&!this.isCocoonJs)h(c,f,function(){cr.logexport("Saved state to IndexedDB storage ("+f.length+" bytes)");a.lastSaveJson=f;a.trigger(cr.system_object.prototype.cnds.OnSaveComplete,null);f=a.lastSaveJson="";d&&g()},function(b){try{localStorage.setItem("__c2save_"+c,f),cr.logexport("Saved state to WebStorage ("+
f.length+" bytes)"),a.lastSaveJson=f,a.trigger(cr.system_object.prototype.cnds.OnSaveComplete,null),f=a.lastSaveJson="",d&&g()}catch(R){cr.logexport("Failed to save game state: "+b+"; "+R),a.trigger(cr.system_object.prototype.cnds.OnSaveFailed,null)}});else try{localStorage.setItem("__c2save_"+c,f),cr.logexport("Saved state to WebStorage ("+f.length+" bytes)"),a.lastSaveJson=f,this.trigger(cr.system_object.prototype.cnds.OnSaveComplete,null),f=a.lastSaveJson="",d&&g()}catch(U){cr.logexport("Error saving to WebStorage: "+
U),a.trigger(cr.system_object.prototype.cnds.OnSaveFailed,null)}this.loadFromSlot=this.saveToSlot="";this.loadFromJson=null}if(b.length){if(e()&&!this.isCocoonJs)n(b,function(c){c?(a.loadFromJson=c,cr.logexport("Loaded state from IndexedDB storage ("+a.loadFromJson.length+" bytes)")):(a.loadFromJson=localStorage.getItem("__c2save_"+b)||"",cr.logexport("Loaded state from WebStorage ("+a.loadFromJson.length+" bytes)"));a.suspendDrawing=!1;a.loadFromJson||(a.loadFromJson=null,a.trigger(cr.system_object.prototype.cnds.OnLoadFailed,
null))},function(c){a.loadFromJson=localStorage.getItem("__c2save_"+b)||"";cr.logexport("Loaded state from WebStorage ("+a.loadFromJson.length+" bytes)");a.suspendDrawing=!1;a.loadFromJson||(a.loadFromJson=null,a.trigger(cr.system_object.prototype.cnds.OnLoadFailed,null))});else{try{this.loadFromJson=localStorage.getItem("__c2save_"+b)||"",cr.logexport("Loaded state from WebStorage ("+this.loadFromJson.length+" bytes)")}catch(U){this.loadFromJson=null}this.suspendDrawing=!1;a.loadFromJson||(a.loadFromJson=
null,a.trigger(cr.system_object.prototype.cnds.OnLoadFailed,null))}this.saveToSlot=this.loadFromSlot=""}null!==this.loadFromJson&&(this.ClearDeathRow(),this.loadFromJSONString(this.loadFromJson)?(this.lastSaveJson=this.loadFromJson,this.trigger(cr.system_object.prototype.cnds.OnLoadComplete,null),this.lastSaveJson=""):a.trigger(cr.system_object.prototype.cnds.OnLoadFailed,null),this.loadFromJson=null)};a.prototype.saveToJSONString=function(){var a,c,f,b={c2save:!0,version:1,rt:{time:this.kahanTime.sum,
walltime:this.wallTime.sum,timescale:this.timescale,tickcount:this.tickcount,execcount:this.execcount,next_uid:this.next_uid,running_layout:this.running_layout.sid,start_time_offset:Date.now()-this.start_time},types:{},layouts:{},events:{groups:{},cnds:{},acts:{},vars:{}}};var m=0;for(a=this.types_by_index.length;m<a;m++){var e=this.types_by_index[m];if(!e.is_family&&!this.typeHasNoSaveBehavior(e)){var p={instances:[]};cr.hasAnyOwnProperty(e.extra)&&(p.ex=d(e.extra));var g=0;for(c=e.instances.length;g<
c;g++)p.instances.push(this.saveInstanceToJSON(e.instances[g]));b.types[e.sid.toString()]=p}}m=0;for(a=this.layouts_by_index.length;m<a;m++)g=this.layouts_by_index[m],b.layouts[g.sid.toString()]=g.saveToJSON();c=b.events.groups;m=0;for(a=this.allGroups.length;m<a;m++)g=this.allGroups[m],c[g.sid.toString()]=this.groups_by_name[g.group_name].group_active;a=b.events.cnds;for(f in this.cndsBySid)this.cndsBySid.hasOwnProperty(f)&&(m=this.cndsBySid[f],cr.hasAnyOwnProperty(m.extra)&&(a[f]={ex:d(m.extra)}));
a=b.events.acts;for(f in this.actsBySid)this.actsBySid.hasOwnProperty(f)&&(m=this.actsBySid[f],cr.hasAnyOwnProperty(m.extra)&&(a[f]={ex:d(m.extra)}));a=b.events.vars;for(f in this.varsBySid)this.varsBySid.hasOwnProperty(f)&&(m=this.varsBySid[f],m.is_constant||m.parent&&!m.is_static||(a[f]=m.data));b.system=this.system.saveToJSON();return JSON.stringify(b)};a.prototype.refreshUidMap=function(){var a,c;this.objectsByUid={};var f=0;for(a=this.types_by_index.length;f<a;f++){var b=this.types_by_index[f];
if(!b.is_family){var d=0;for(c=b.instances.length;d<c;d++){var m=b.instances[d];this.objectsByUid[m.uid.toString()]=m}}}};a.prototype.loadFromJSONString=function(a){try{var c=JSON.parse(a)}catch(W){return!1}if(!c.c2save||1<c.version)return!1;this.isLoadingState=!0;a=c.rt;this.kahanTime.reset();this.kahanTime.sum=a.time;this.wallTime.reset();this.wallTime.sum=a.walltime||0;this.timescale=a.timescale;this.tickcount=a.tickcount;this.execcount=a.execcount;this.start_time=Date.now()-a.start_time_offset;
var f=a.running_layout;if(f!==this.running_layout.sid)if(f=this.getLayoutBySid(f))this.doChangeLayout(f);else return;var b,d,m;var e=c.types;for(d in e)if(e.hasOwnProperty(d)&&(m=this.getObjectTypeBySid(parseInt(d,10)))&&!m.is_family&&!this.typeHasNoSaveBehavior(m)){e[d].ex?m.extra=e[d].ex:cr.wipe(m.extra);var p=m.instances;var g=e[d].instances;f=0;for(b=cr.min(p.length,g.length);f<b;f++)this.loadInstanceFromJSON(p[f],g[f]);f=g.length;for(b=p.length;f<b;f++)this.DestroyInstance(p[f]);f=p.length;for(b=
g.length;f<b;f++){p=null;if(m.plugin.is_world&&(p=this.running_layout.getLayerBySid(g[f].w.l),!p))continue;p=this.createInstanceFromInit(m.default_instance,p,!1,0,0,!0);this.loadInstanceFromJSON(p,g[f])}m.stale_iids=!0}this.ClearDeathRow();this.refreshUidMap();b=c.layouts;for(d in b)b.hasOwnProperty(d)&&(f=this.getLayoutBySid(parseInt(d,10)))&&f.loadFromJSON(b[d]);b=c.events.groups;for(d in b)b.hasOwnProperty(d)&&(f=this.getGroupBySid(parseInt(d,10)))&&this.groups_by_name[f.group_name]&&this.groups_by_name[f.group_name].setGroupActive(b[d]);
f=c.events.cnds;for(d in this.cndsBySid)this.cndsBySid.hasOwnProperty(d)&&(f.hasOwnProperty(d)?this.cndsBySid[d].extra=f[d].ex:this.cndsBySid[d].extra={});f=c.events.acts;for(d in this.actsBySid)this.actsBySid.hasOwnProperty(d)&&(f.hasOwnProperty(d)?this.actsBySid[d].extra=f[d].ex:this.actsBySid[d].extra={});f=c.events.vars;for(d in f)f.hasOwnProperty(d)&&this.varsBySid.hasOwnProperty(d)&&(this.varsBySid[d].data=f[d]);this.next_uid=a.next_uid;this.isLoadingState=!1;f=0;for(b=this.fireOnCreateAfterLoad.length;f<
b;++f)p=this.fireOnCreateAfterLoad[f],this.trigger(Object.getPrototypeOf(p.type.plugin).cnds.OnCreated,p);cr.clearArray(this.fireOnCreateAfterLoad);this.system.loadFromJSON(c.system);f=0;for(b=this.types_by_index.length;f<b;f++)if(m=this.types_by_index[f],!m.is_family&&!this.typeHasNoSaveBehavior(m))for(c=0,d=m.instances.length;c<d;c++){p=m.instances[c];if(m.is_contained)for(e=p.get_iid(),cr.clearArray(p.siblings),a=0,g=m.container.length;a<g;a++){var t=m.container[a];m!==t&&p.siblings.push(t.instances[e])}p.afterLoad&&
p.afterLoad();if(p.behavior_insts)for(a=0,g=p.behavior_insts.length;a<g;a++)e=p.behavior_insts[a],e.afterLoad&&e.afterLoad()}return this.redraw=!0};a.prototype.saveInstanceToJSON=function(a,c){var f;var b=a.type;var m=b.plugin;var e={};c?e.c2=!0:e.uid=a.uid;cr.hasAnyOwnProperty(a.extra)&&(e.ex=d(a.extra));if(a.instance_vars&&a.instance_vars.length)for(e.ivs={},c=0,f=a.instance_vars.length;c<f;c++)e.ivs[a.type.instvar_sids[c].toString()]=a.instance_vars[c];if(m.is_world){m={x:a.x,y:a.y,w:a.width,h:a.height,
l:a.layer.sid,zi:a.get_zindex()};0!==a.angle&&(m.a=a.angle);1!==a.opacity&&(m.o=a.opacity);.5!==a.hotspotX&&(m.hX=a.hotspotX);.5!==a.hotspotY&&(m.hY=a.hotspotY);0!==a.blend_mode&&(m.bm=a.blend_mode);a.visible||(m.v=a.visible);a.collisionsEnabled||(m.ce=a.collisionsEnabled);-1!==a.my_timescale&&(m.mts=a.my_timescale);if(b.effect_types.length)for(m.fx=[],c=0,f=b.effect_types.length;c<f;c++){var p=b.effect_types[c];m.fx.push({name:p.name,active:a.active_effect_flags[p.index],params:a.effect_params[p.index]})}e.w=
m}if(a.behavior_insts&&a.behavior_insts.length)for(e.behs={},c=0,f=a.behavior_insts.length;c<f;c++)b=a.behavior_insts[c],b.saveToJSON&&(e.behs[b.type.sid.toString()]=b.saveToJSON());a.saveToJSON&&(e.data=a.saveToJSON());return e};a.prototype.getInstanceVarIndexBySid=function(a,c){var f;var b=0;for(f=a.instvar_sids.length;b<f;b++)if(a.instvar_sids[b]===c)return b;return-1};a.prototype.getBehaviorIndexBySid=function(a,c){var f;var b=0;for(f=a.behavior_insts.length;b<f;b++)if(a.behavior_insts[b].type.sid===
c)return b;return-1};a.prototype.loadInstanceFromJSON=function(a,c,f){var b,d;var m=a.type;var e=m.plugin;if(f){if(!c.c2)return}else a.uid=c.uid;c.ex?a.extra=c.ex:cr.wipe(a.extra);if(d=c.ivs)for(b in d)if(d.hasOwnProperty(b)){var p=this.getInstanceVarIndexBySid(m,parseInt(b,10));if(!(0>p||p>=a.instance_vars.length)){var g=d[b];null===g&&(g=NaN);a.instance_vars[p]=g}}if(e.is_world){p=c.w;a.layer.sid!==p.l&&(d=a.layer,a.layer=this.running_layout.getLayerBySid(p.l),a.layer?(d.removeFromInstanceList(a,
!0),a.layer.appendToInstanceList(a,!0),a.set_bbox_changed(),a.layer.setZIndicesStaleFrom(0)):(a.layer=d,f||this.DestroyInstance(a)));a.x=p.x;a.y=p.y;a.width=p.w;a.height=p.h;a.zindex=p.zi;a.angle=p.hasOwnProperty("a")?p.a:0;a.opacity=p.hasOwnProperty("o")?p.o:1;a.hotspotX=p.hasOwnProperty("hX")?p.hX:.5;a.hotspotY=p.hasOwnProperty("hY")?p.hY:.5;a.visible=p.hasOwnProperty("v")?p.v:!0;a.collisionsEnabled=p.hasOwnProperty("ce")?p.ce:!0;a.my_timescale=p.hasOwnProperty("mts")?p.mts:-1;a.blend_mode=p.hasOwnProperty("bm")?
p.bm:0;a.compositeOp=cr.effectToCompositeOp(a.blend_mode);this.gl&&cr.setGLBlend(a,a.blend_mode,this.gl);a.set_bbox_changed();if(p.hasOwnProperty("fx"))for(f=0,d=p.fx.length;f<d;f++)g=m.getEffectIndexByName(p.fx[f].name),0>g||(a.active_effect_flags[g]=p.fx[f].active,a.effect_params[g]=p.fx[f].params);a.updateActiveEffects()}if(m=c.behs)for(b in m)m.hasOwnProperty(b)&&(f=this.getBehaviorIndexBySid(a,parseInt(b,10)),0>f||a.behavior_insts[f].loadFromJSON(m[b]));c.data&&a.loadFromJSON(c.data)};a.prototype.fetchLocalFileViaCordova=
function(a,c,f){window.resolveLocalFileSystemURL(cordova.file.applicationDirectory+"www/"+a,function(a){a.file(c,f)},f)};a.prototype.fetchLocalFileViaCordovaAsText=function(a,c,f){this.fetchLocalFileViaCordova(a,function(a){var b=new FileReader;b.onload=function(a){c(a.target.result)};b.onerror=f;b.readAsText(a)},f)};var S=[],N=0;a.prototype.maybeStartNextArrayBufferRead=function(){if(S.length&&!(8<=N)){N++;var a=S.shift();this.doFetchLocalFileViaCordovaAsArrayBuffer(a.filename,a.successCallback,
a.errorCallback)}};a.prototype.fetchLocalFileViaCordovaAsArrayBuffer=function(a,c,f){var b=this;S.push({filename:a,successCallback:function(a){N--;b.maybeStartNextArrayBufferRead();c(a)},errorCallback:function(a){N--;b.maybeStartNextArrayBufferRead();f(a)}});this.maybeStartNextArrayBufferRead()};a.prototype.doFetchLocalFileViaCordovaAsArrayBuffer=function(a,c,f){this.fetchLocalFileViaCordova(a,function(a){var f=new FileReader;f.onload=function(a){c(a.target.result)};f.readAsArrayBuffer(a)},f)};a.prototype.fetchLocalFileViaCordovaAsURL=
function(a,c,f){var b="",d=a.toLowerCase(),m=d.substr(d.length-4);d=d.substr(d.length-5);".mp4"===m?b="video/mp4":".webm"===d?b="video/webm":".m4a"===m?b="audio/mp4":".mp3"===m&&(b="audio/mpeg");this.fetchLocalFileViaCordovaAsArrayBuffer(a,function(a){a=new Blob([a],{type:b});a=URL.createObjectURL(a);c(a)},f)};a.prototype.isAbsoluteUrl=function(a){return/^(?:[a-z]+:)?\/\//.test(a)||"data:"===a.substr(0,5)||"blob:"===a.substr(0,5)};a.prototype.setImageSrc=function(a,c){this.isWKWebView&&!this.isAbsoluteUrl(c)?
this.fetchLocalFileViaCordovaAsURL(c,function(c){a.src=c},function(a){alert("Failed to load image: "+a)}):a.src=c};a.prototype.setCtxImageSmoothingEnabled=function(a,c){"undefined"!==typeof a.imageSmoothingEnabled?a.imageSmoothingEnabled=c:(a.webkitImageSmoothingEnabled=c,a.mozImageSmoothingEnabled=c,a.msImageSmoothingEnabled=c)};cr.runtime=a;cr.createRuntime=function(c){return new a(document.getElementById(c))};cr.createDCRuntime=function(c,f){return new a({dc:!0,width:c,height:f})};window.cr_createRuntime=
cr.createRuntime;window.cr_createDCRuntime=cr.createDCRuntime;window.createCocoonJSRuntime=function(){window.c2cocoonjs=!0;var c=document.createElement("screencanvas")||document.createElement("canvas");c.screencanvas=!0;document.body.appendChild(c);c=new a(c);window.c2runtime=c;window.addEventListener("orientationchange",function(){window.c2runtime.setSize(window.innerWidth,window.innerHeight)});window.c2runtime.setSize(window.innerWidth,window.innerHeight);return c};window.createEjectaRuntime=function(){var c=
document.getElementById("canvas");c=new a(c);window.c2runtime=c;window.c2runtime.setSize(window.innerWidth,window.innerHeight);return c}})();window.cr_getC2Runtime=function(){var a=document.getElementById("c2canvas");return a?a.c2runtime:window.c2runtime?window.c2runtime:null};window.cr_getSnapshot=function(a,b){var e=window.cr_getC2Runtime();e&&e.doCanvasSnapshot(a,b)};window.cr_sizeCanvas=function(a,b){if(0!==a&&0!==b){var e=window.cr_getC2Runtime();e&&e.setSize(a,b)}};
window.cr_setSuspended=function(a){var b=window.cr_getC2Runtime();b&&b.setSuspended(a)};
(function(){function a(a,f){this.runtime=a;this.event_sheet=null;this.scrollX=this.runtime.original_width/2;this.scrollY=this.runtime.original_height/2;this.scale=1;this.angle=0;this.first_visit=!0;this.name=f[0];this.originalWidth=f[1];this.originalHeight=f[2];this.width=f[1];this.height=f[2];this.unbounded_scrolling=f[3];this.sheetname=f[4];this.sid=f[5];var c=f[6],b;this.layers=[];this.initial_types=[];a=0;for(b=c.length;a<b;a++){var d=new cr.layer(this,c[a]);d.number=a;cr.seal(d);this.layers.push(d)}c=
f[7];this.initial_nonworld=[];a=0;for(b=c.length;a<b;a++){d=c[a];var e=this.runtime.types_by_index[d[1]];e.default_instance||(e.default_instance=d);this.initial_nonworld.push(d);-1===this.initial_types.indexOf(e)&&this.initial_types.push(e)}this.effect_types=[];this.active_effect_types=[];this.shaders_preserve_opaqueness=!0;this.effect_params=[];a=0;for(b=f[8].length;a<b;a++)this.effect_types.push({id:f[8][a][0],name:f[8][a][1],shaderindex:-1,preservesOpaqueness:!1,active:!0,index:a}),this.effect_params.push(f[8][a][2].slice(0));
this.updateActiveEffects();this.rcTex=new cr.rect(0,0,1,1);this.rcTex2=new cr.rect(0,0,1,1);this.persist_data={}}function b(a,f){return a.zindex-f.zindex}function e(a,f){this.layout=a;this.runtime=a.runtime;this.instances=[];this.scale=1;this.angle=0;this.disableAngle=!1;this.tmprect=new cr.rect(0,0,0,0);this.tmpquad=new cr.quad;this.viewBottom=this.viewTop=this.viewRight=this.viewLeft=0;this.zindices_stale=!1;this.zindices_stale_from=-1;this.clear_earlyz_index=0;this.name=f[0];this.index=f[1];this.sid=
f[2];this.visible=f[3];this.background_color=f[4];this.transparent=f[5];this.parallaxX=f[6];this.parallaxY=f[7];this.opacity=f[8];this.forceOwnTexture=f[9];this.useRenderCells=f[10];this.zoomRate=f[11];this.blend_mode=f[12];this.effect_fallback=f[13];this.compositeOp="source-over";this.destBlend=this.srcBlend=0;this.render_grid=null;this.last_render_list=l();this.render_list_stale=!0;this.last_render_cells=new cr.rect(0,0,-1,-1);this.cur_render_cells=new cr.rect(0,0,-1,-1);this.useRenderCells&&(this.render_grid=
new cr.RenderGrid(this.runtime.original_width,this.runtime.original_height));this.render_offscreen=!1;a=f[14];var c;this.startup_initial_instances=[];this.initial_instances=[];this.created_globals=[];var b=0;for(c=a.length;b<c;b++){var d=a[b],e=this.runtime.types_by_index[d[1]];e.default_instance||(e.default_instance=d,e.default_layerindex=this.index);this.initial_instances.push(d);-1===this.layout.initial_types.indexOf(e)&&this.layout.initial_types.push(e)}cr.shallowAssignArray(this.startup_initial_instances,
this.initial_instances);this.effect_types=[];this.active_effect_types=[];this.shaders_preserve_opaqueness=!0;this.effect_params=[];b=0;for(c=f[15].length;b<c;b++)this.effect_types.push({id:f[15][b][0],name:f[15][b][1],shaderindex:-1,preservesOpaqueness:!1,active:!0,index:b}),this.effect_params.push(f[15][b][2].slice(0));this.updateActiveEffects();this.rcTex=new cr.rect(0,0,1,1);this.rcTex2=new cr.rect(0,0,1,1)}function l(){return k.length?k.pop():[]}function h(a){cr.clearArray(a);k.push(a)}a.prototype.saveObjectToPersist=
function(a){var c=a.type.sid.toString();this.persist_data.hasOwnProperty(c)||(this.persist_data[c]=[]);this.persist_data[c].push(this.runtime.saveInstanceToJSON(a))};a.prototype.hasOpaqueBottomLayer=function(){var a=this.layers[0];return!a.transparent&&1===a.opacity&&!a.forceOwnTexture&&a.visible};a.prototype.updateActiveEffects=function(){cr.clearArray(this.active_effect_types);this.shaders_preserve_opaqueness=!0;var a;var f=0;for(a=this.effect_types.length;f<a;f++){var b=this.effect_types[f];b.active&&
(this.active_effect_types.push(b),b.preservesOpaqueness||(this.shaders_preserve_opaqueness=!1))}};a.prototype.getEffectByName=function(a){var c;var b=0;for(c=this.effect_types.length;b<c;b++){var d=this.effect_types[b];if(d.name===a)return d}return null};var n=[],g=!0;a.prototype.startRunning=function(){this.sheetname&&(this.event_sheet=this.runtime.eventsheets[this.sheetname],this.event_sheet.updateDeepIncludes());this.runtime.running_layout=this;this.width=this.originalWidth;this.height=this.originalHeight;
this.scrollX=this.runtime.original_width/2;this.scrollY=this.runtime.original_height/2;var a,f;var d=0;for(a=this.runtime.types_by_index.length;d<a;d++){var e=this.runtime.types_by_index[d];if(!e.is_family){var k=e.instances;e=0;for(f=k.length;e<f;e++){var h=k[e];if(h.layer){var r=h.layer.number;r>=this.layers.length&&(r=this.layers.length-1);h.layer=this.layers[r];-1===h.layer.instances.indexOf(h)&&h.layer.instances.push(h);h.layer.zindices_stale=!0}}}}if(!g)for(d=0,a=this.layers.length;d<a;++d)this.layers[d].instances.sort(b);
cr.clearArray(n);this.boundScrolling();d=0;for(a=this.layers.length;d<a;d++)h=this.layers[d],h.createInitialInstances(),h.updateViewport(null);k=!1;if(!this.first_visit){for(v in this.persist_data)if(this.persist_data.hasOwnProperty(v)&&(e=this.runtime.getObjectTypeBySid(parseInt(v,10)))&&!e.is_family&&this.runtime.typeHasPersistBehavior(e)){f=this.persist_data[v];d=0;for(a=f.length;d<a;d++){h=null;if(e.plugin.is_world&&(h=this.getLayerBySid(f[d].w.l),!h))continue;h=this.runtime.createInstanceFromInit(e.default_instance,
h,!1,0,0,!0);this.runtime.loadInstanceFromJSON(h,f[d]);k=!0;n.push(h)}cr.clearArray(f)}d=0;for(a=this.layers.length;d<a;d++)this.layers[d].instances.sort(b),this.layers[d].zindices_stale=!0}k&&(this.runtime.ClearDeathRow(),this.runtime.refreshUidMap());for(d=0;d<n.length;d++)if(h=n[d],h.type.is_contained)for(a=h.get_iid(),e=0,f=h.type.container.length;e<f;e++){var v=h.type.container[e];h.type!==v&&(v.instances.length>a?h.siblings.push(v.instances[a]):v.default_instance&&(k=this.runtime.createInstanceFromInit(v.default_instance,
h.layer,!0,h.x,h.y,!0),this.runtime.ClearDeathRow(),v.updateIIDs(),h.siblings.push(k),n.push(k)))}d=0;for(a=this.initial_nonworld.length;d<a;d++)h=this.initial_nonworld[d],e=this.runtime.types_by_index[h[1]],e.is_contained||this.runtime.createInstanceFromInit(this.initial_nonworld[d],null,!0);this.runtime.changelayout=null;this.runtime.ClearDeathRow();if(this.runtime.ctx&&!this.runtime.isDomFree)for(d=0,a=this.runtime.types_by_index.length;d<a;d++)v=this.runtime.types_by_index[d],!v.is_family&&v.instances.length&&
v.preloadCanvas2D&&v.preloadCanvas2D(this.runtime.ctx);if(this.runtime.isLoadingState)cr.shallowAssignArray(this.runtime.fireOnCreateAfterLoad,n);else for(d=0,a=n.length;d<a;d++)h=n[d],this.runtime.trigger(Object.getPrototypeOf(h.type.plugin).cnds.OnCreated,h);cr.clearArray(n);this.runtime.isLoadingState||this.runtime.trigger(cr.system_object.prototype.cnds.OnLayoutStart,null);this.first_visit=!1};a.prototype.createGlobalNonWorlds=function(){var a,f;var b=a=0;for(f=this.initial_nonworld.length;a<
f;a++){var d=this.initial_nonworld[a];var e=this.runtime.types_by_index[d[1]];e.global?e.is_contained||this.runtime.createInstanceFromInit(d,null,!0):(this.initial_nonworld[b]=d,b++)}cr.truncateArray(this.initial_nonworld,b)};a.prototype.stopRunning=function(){this.runtime.isLoadingState||this.runtime.trigger(cr.system_object.prototype.cnds.OnLayoutEnd,null);this.runtime.isEndingLayout=!0;cr.clearArray(this.runtime.system.waits);var a,f;if(!this.first_visit){var b=0;for(a=this.layers.length;b<a;b++){this.layers[b].updateZIndices();
var d=this.layers[b].instances;var e=0;for(f=d.length;e<f;e++){var k=d[e];k.type.global||this.runtime.typeHasPersistBehavior(k.type)&&this.saveObjectToPersist(k)}}}b=0;for(a=this.layers.length;b<a;b++){d=this.layers[b].instances;e=0;for(f=d.length;e<f;e++)k=d[e],k.type.global||this.runtime.DestroyInstance(k);this.runtime.ClearDeathRow();cr.clearArray(d);this.layers[b].zindices_stale=!0}b=0;for(a=this.runtime.types_by_index.length;b<a;b++)if(d=this.runtime.types_by_index[b],!(d.global||d.plugin.is_world||
d.plugin.singleglobal||d.is_family)){e=0;for(f=d.instances.length;e<f;e++)this.runtime.DestroyInstance(d.instances[e]);this.runtime.ClearDeathRow()}g=!1;this.runtime.isEndingLayout=!1};var d=new cr.rect(0,0,0,0);a.prototype.recreateInitialObjects=function(a,f,b,e,g){d.set(f,b,e,g);f=0;for(b=this.layers.length;f<b;f++)this.layers[f].recreateInitialObjects(a,d)};a.prototype.draw=function(a){var c=a,b=!1,d=!this.runtime.fullscreenScalingQuality;if(d){if(!this.runtime.layout_canvas){this.runtime.layout_canvas=
document.createElement("canvas");var e=this.runtime.layout_canvas;e.width=this.runtime.draw_width;e.height=this.runtime.draw_height;this.runtime.layout_ctx=e.getContext("2d");b=!0}e=this.runtime.layout_canvas;c=this.runtime.layout_ctx;e.width!==this.runtime.draw_width&&(e.width=this.runtime.draw_width,b=!0);e.height!==this.runtime.draw_height&&(e.height=this.runtime.draw_height,b=!0);b&&this.runtime.setCtxImageSmoothingEnabled(c,this.runtime.linearSampling)}c.globalAlpha=1;c.globalCompositeOperation=
"source-over";this.runtime.clearBackground&&!this.hasOpaqueBottomLayer()&&c.clearRect(0,0,this.runtime.draw_width,this.runtime.draw_height);var g;b=0;for(g=this.layers.length;b<g;b++){var k=this.layers[b];k.visible&&0<k.opacity&&11!==k.blend_mode&&(k.instances.length||!k.transparent)?k.draw(c):k.updateViewport(null)}d&&a.drawImage(e,0,0,this.runtime.width,this.runtime.height)};a.prototype.drawGL_earlyZPass=function(a){a.setEarlyZPass(!0);this.runtime.layout_tex||(this.runtime.layout_tex=a.createEmptyTexture(this.runtime.draw_width,
this.runtime.draw_height,this.runtime.linearSampling));if(this.runtime.layout_tex.c2width!==this.runtime.draw_width||this.runtime.layout_tex.c2height!==this.runtime.draw_height)a.deleteTexture(this.runtime.layout_tex),this.runtime.layout_tex=a.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);a.setRenderingToTexture(this.runtime.layout_tex);this.runtime.fullscreenScalingQuality||a.setSize(this.runtime.draw_width,this.runtime.draw_height);var c;for(c=
this.layers.length-1;0<=c;--c){var b=this.layers[c];b.visible&&1===b.opacity&&b.shaders_preserve_opaqueness&&0===b.blend_mode&&(b.instances.length||!b.transparent)?b.drawGL_earlyZPass(a):b.updateViewport(null)}a.setEarlyZPass(!1)};a.prototype.drawGL=function(a){var c=0<this.active_effect_types.length||this.runtime.uses_background_blending||!this.runtime.fullscreenScalingQuality||this.runtime.enableFrontToBack;if(c){this.runtime.layout_tex||(this.runtime.layout_tex=a.createEmptyTexture(this.runtime.draw_width,
this.runtime.draw_height,this.runtime.linearSampling));if(this.runtime.layout_tex.c2width!==this.runtime.draw_width||this.runtime.layout_tex.c2height!==this.runtime.draw_height)a.deleteTexture(this.runtime.layout_tex),this.runtime.layout_tex=a.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);a.setRenderingToTexture(this.runtime.layout_tex);this.runtime.fullscreenScalingQuality||a.setSize(this.runtime.draw_width,this.runtime.draw_height)}else this.runtime.layout_tex&&
(a.setRenderingToTexture(null),a.deleteTexture(this.runtime.layout_tex),this.runtime.layout_tex=null);this.runtime.clearBackground&&!this.hasOpaqueBottomLayer()&&a.clear(0,0,0,0);var b;var d=0;for(b=this.layers.length;d<b;d++){var e=this.layers[d];e.visible&&0<e.opacity&&(e.instances.length||!e.transparent)?e.drawGL(a):e.updateViewport(null)}c&&(0===this.active_effect_types.length||1===this.active_effect_types.length&&this.runtime.fullscreenScalingQuality?(1===this.active_effect_types.length?(c=this.active_effect_types[0].index,
a.switchProgram(this.active_effect_types[0].shaderindex),a.setProgramParameters(null,1/this.runtime.draw_width,1/this.runtime.draw_height,0,0,1,1,this.scale,this.angle,0,0,this.runtime.draw_width/2,this.runtime.draw_height/2,this.runtime.kahanTime.sum,this.effect_params[c]),a.programIsAnimated(this.active_effect_types[0].shaderindex)&&(this.runtime.redraw=!0)):a.switchProgram(0),this.runtime.fullscreenScalingQuality||a.setSize(this.runtime.width,this.runtime.height),a.setRenderingToTexture(null),
a.setDepthTestEnabled(!1),a.setOpacity(1),a.setTexture(this.runtime.layout_tex),a.setAlphaBlend(),a.resetModelView(),a.updateModelView(),c=this.runtime.width/2,d=this.runtime.height/2,a.quad(-c,d,c,d,c,-d,-c,-d),a.setTexture(null),a.setDepthTestEnabled(!0)):this.renderEffectChain(a,null,null,null))};a.prototype.getRenderTarget=function(){return 0<this.active_effect_types.length||this.runtime.uses_background_blending||!this.runtime.fullscreenScalingQuality||this.runtime.enableFrontToBack?this.runtime.layout_tex:
null};a.prototype.getMinLayerScale=function(){var a=this.layers[0].getScale(),f;var b=1;for(f=this.layers.length;b<f;b++){var d=this.layers[b];(0!==d.parallaxX||0!==d.parallaxY)&&d.getScale()<a&&(a=d.getScale())}return a};a.prototype.scrollToX=function(a){if(!this.unbounded_scrolling){var c=this.runtime.draw_width*(1/this.getMinLayerScale())/2;a>this.width-c&&(a=this.width-c);a<c&&(a=c)}this.scrollX!==a&&(this.scrollX=a,this.runtime.redraw=!0)};a.prototype.scrollToY=function(a){if(!this.unbounded_scrolling){var c=
this.runtime.draw_height*(1/this.getMinLayerScale())/2;a>this.height-c&&(a=this.height-c);a<c&&(a=c)}this.scrollY!==a&&(this.scrollY=a,this.runtime.redraw=!0)};a.prototype.boundScrolling=function(){this.scrollToX(this.scrollX);this.scrollToY(this.scrollY)};a.prototype.renderEffectChain=function(a,f,b,d){var c=b?b.active_effect_types:f?f.active_effect_types:this.active_effect_types,e=1,g=0,k=0,t=0,h=this.runtime.draw_width,q=this.runtime.draw_height;b?(e=b.layer.getScale(),g=b.layer.getAngle(),k=b.layer.viewLeft,
t=b.layer.viewTop,h=b.layer.viewRight,q=b.layer.viewBottom):f&&(e=f.getScale(),g=f.getAngle(),k=f.viewLeft,t=f.viewTop,h=f.viewRight,q=f.viewBottom);var n=this.runtime.fx_tex,m,p,r=0,l=1,u=this.runtime.draw_width,y=this.runtime.draw_height,G=u/2,H=y/2,F=f?f.rcTex:this.rcTex,J=f?f.rcTex2:this.rcTex2,P=0,S=0,N=0,w=0,D=u,Q=u,L=y,V=y,U=p=0;var R=b?b.layer.getAngle():0;if(b){var T=0;for(m=c.length;T<m;T++)p+=a.getProgramBoxExtendHorizontal(c[T].shaderindex),U+=a.getProgramBoxExtendVertical(c[T].shaderindex);
w=b.bbox;P=f.layerToCanvas(w.left,w.top,!0,!0);N=f.layerToCanvas(w.left,w.top,!1,!0);D=f.layerToCanvas(w.right,w.bottom,!0,!0);L=f.layerToCanvas(w.right,w.bottom,!1,!0);0!==R&&(T=f.layerToCanvas(w.right,w.top,!0,!0),m=f.layerToCanvas(w.right,w.top,!1,!0),S=f.layerToCanvas(w.left,w.bottom,!0,!0),w=f.layerToCanvas(w.left,w.bottom,!1,!0),R=Math.min(P,D,T,S),D=Math.max(P,D,T,S),P=R,R=Math.min(N,L,m,w),L=Math.max(N,L,m,w),N=R);P-=p;N-=U;D+=p;L+=U;J.left=P/u;J.top=1-N/y;J.right=D/u;J.bottom=1-L/y;S=P=cr.floor(P);
w=N=cr.floor(N);Q=D=cr.ceil(D);V=L=cr.ceil(L);S-=p;w-=U;Q+=p;V+=U;0>P&&(P=0);0>N&&(N=0);D>u&&(D=u);L>y&&(L=y);0>S&&(S=0);0>w&&(w=0);Q>u&&(Q=u);V>y&&(V=y);F.left=P/u;F.top=1-N/y;F.right=D/u;F.bottom=1-L/y}else F.left=J.left=0,F.top=J.top=0,F.right=J.right=1,F.bottom=J.bottom=1;U=b&&(a.programUsesDest(c[0].shaderindex)||0!==p||0!==U||1!==b.opacity||b.type.plugin.must_predraw)||f&&!b&&1!==f.opacity;a.setAlphaBlend();if(U){n[r]||(n[r]=a.createEmptyTexture(u,y,this.runtime.linearSampling));if(n[r].c2width!==
u||n[r].c2height!==y)a.deleteTexture(n[r]),n[r]=a.createEmptyTexture(u,y,this.runtime.linearSampling);a.switchProgram(0);a.setRenderingToTexture(n[r]);var X=V-w;a.clearRect(S,y-w-X,Q-S,X);b?b.drawGL(a):(a.setTexture(this.runtime.layer_tex),a.setOpacity(f.opacity),a.resetModelView(),a.translate(-G,-H),a.updateModelView(),a.quadTex(P,L,D,L,D,N,P,N,F));J.left=J.top=0;J.right=J.bottom=1;b&&(R=F.top,F.top=F.bottom,F.bottom=R);r=1;l=0}a.setOpacity(1);p=c.length-1;var Y=a.programUsesCrossSampling(c[p].shaderindex)||
!f&&!b&&!this.runtime.fullscreenScalingQuality;T=0;for(m=c.length;T<m;T++){n[r]||(n[r]=a.createEmptyTexture(u,y,this.runtime.linearSampling));if(n[r].c2width!==u||n[r].c2height!==y)a.deleteTexture(n[r]),n[r]=a.createEmptyTexture(u,y,this.runtime.linearSampling);a.switchProgram(c[T].shaderindex);R=c[T].index;a.programIsAnimated(c[T].shaderindex)&&(this.runtime.redraw=!0);if(0!=T||U){a.setProgramParameters(d,1/u,1/y,J.left,J.top,J.right,J.bottom,e,g,k,t,(k+h)/2,(t+q)/2,this.runtime.kahanTime.sum,b?
b.effect_params[R]:f?f.effect_params[R]:this.effect_params[R]);a.setTexture(null);if(T!==p||Y){a.setRenderingToTexture(n[r]);X=V-w;var W=y-w-X;a.clearRect(S,W,Q-S,X)}else b?a.setBlend(b.srcBlend,b.destBlend):f&&a.setBlend(f.srcBlend,f.destBlend),a.setRenderingToTexture(d);a.setTexture(n[l]);a.resetModelView();a.translate(-G,-H);a.updateModelView();a.quadTex(P,L,D,L,D,N,P,N,F);T!==p||Y||a.setTexture(null)}else a.setRenderingToTexture(n[r]),X=V-w,W=y-w-X,a.clearRect(S,W,Q-S,X),b?(b.curFrame&&b.curFrame.texture_img?
(W=b.curFrame.texture_img,l=1/W.width,W=1/W.height):(l=1/b.width,W=1/b.height),a.setProgramParameters(d,l,W,J.left,J.top,J.right,J.bottom,e,g,k,t,(k+h)/2,(t+q)/2,this.runtime.kahanTime.sum,b.effect_params[R]),b.drawGL(a)):(a.setProgramParameters(d,1/u,1/y,0,0,1,1,e,g,k,t,(k+h)/2,(t+q)/2,this.runtime.kahanTime.sum,f?f.effect_params[R]:this.effect_params[R]),a.setTexture(f?this.runtime.layer_tex:this.runtime.layout_tex),a.resetModelView(),a.translate(-G,-H),a.updateModelView(),a.quadTex(P,L,D,L,D,N,
P,N,F)),J.left=J.top=0,J.right=J.bottom=1,b&&!Y&&(R=L,L=N,N=R);r=0===r?1:0;l=0===r?1:0}Y&&(a.switchProgram(0),b?a.setBlend(b.srcBlend,b.destBlend):f?a.setBlend(f.srcBlend,f.destBlend):this.runtime.fullscreenScalingQuality||(a.setSize(this.runtime.width,this.runtime.height),G=this.runtime.width/2,H=this.runtime.height/2,N=P=0,D=this.runtime.width,L=this.runtime.height),a.setRenderingToTexture(d),a.setTexture(n[l]),a.resetModelView(),a.translate(-G,-H),a.updateModelView(),b&&1===c.length&&!U?a.quadTex(P,
N,D,N,D,L,P,L,F):a.quadTex(P,L,D,L,D,N,P,N,F),a.setTexture(null))};a.prototype.getLayerBySid=function(a){var c;var b=0;for(c=this.layers.length;b<c;b++)if(this.layers[b].sid===a)return this.layers[b];return null};a.prototype.saveToJSON=function(){var a,b={sx:this.scrollX,sy:this.scrollY,s:this.scale,a:this.angle,w:this.width,h:this.height,fv:this.first_visit,persist:this.persist_data,fx:[],layers:{}};var d=0;for(a=this.effect_types.length;d<a;d++){var e=this.effect_types[d];b.fx.push({name:e.name,
active:e.active,params:this.effect_params[e.index]})}d=0;for(a=this.layers.length;d<a;d++)e=this.layers[d],b.layers[e.sid.toString()]=e.saveToJSON();return b};a.prototype.loadFromJSON=function(a){var c,b,d;this.scrollX=a.sx;this.scrollY=a.sy;this.scale=a.s;this.angle=a.a;this.width=a.w;this.height=a.h;this.persist_data=a.persist;"undefined"!==typeof a.fv&&(this.first_visit=a.fv);var e=a.fx;var g=0;for(c=e.length;g<c;g++)if(b=this.getEffectByName(e[g].name))b.active=e[g].active,this.effect_params[b.index]=
e[g].params;this.updateActiveEffects();g=a.layers;for(d in g)g.hasOwnProperty(d)&&(a=this.getLayerBySid(parseInt(d,10)))&&a.loadFromJSON(g[d])};cr.layout=a;e.prototype.updateActiveEffects=function(){cr.clearArray(this.active_effect_types);this.shaders_preserve_opaqueness=!0;var a;var b=0;for(a=this.effect_types.length;b<a;b++){var d=this.effect_types[b];d.active&&(this.active_effect_types.push(d),d.preservesOpaqueness||(this.shaders_preserve_opaqueness=!1))}};e.prototype.getEffectByName=function(a){var c;
var b=0;for(c=this.effect_types.length;b<c;b++){var d=this.effect_types[b];if(d.name===a)return d}return null};e.prototype.createInitialInstances=function(){var a,b;var d=a=0;for(b=this.initial_instances.length;a<b;a++){var e=this.initial_instances[a];var g=this.runtime.types_by_index[e[1]];var k=this.runtime.typeHasPersistBehavior(g);g=!0;if(!k||this.layout.first_visit){e=this.runtime.createInstanceFromInit(e,this,!0);if(!e)continue;n.push(e);e.type.global&&(g=!1,this.created_globals.push(e.uid))}g&&
(this.initial_instances[d]=this.initial_instances[a],d++)}this.initial_instances.length=d;this.runtime.ClearDeathRow();!this.runtime.glwrap&&this.effect_types.length&&(this.blend_mode=this.effect_fallback);this.compositeOp=cr.effectToCompositeOp(this.blend_mode);this.runtime.gl&&cr.setGLBlend(this,this.blend_mode,this.runtime.gl);this.render_list_stale=!0};e.prototype.recreateInitialObjects=function(a,b){var c,f=this.runtime.types_by_index,d=a.is_family,e=a.members;var g=0;for(c=this.initial_instances.length;g<
c;++g){var k=this.initial_instances[g];var t=k[0];var h=t[0];t=t[1];if(b.contains_pt(h,t)){h=f[k[1]];if(h!==a)if(d){if(0>e.indexOf(h))continue}else continue;k=this.runtime.createInstanceFromInit(k,this,!1);this.runtime.isInOnDestroy++;this.runtime.trigger(Object.getPrototypeOf(h.plugin).cnds.OnCreated,k);if(k.is_contained)for(h=0,t=k.siblings.length;h<t;h++){var n=k.siblings[g];this.runtime.trigger(Object.getPrototypeOf(n.type.plugin).cnds.OnCreated,n)}this.runtime.isInOnDestroy--}}};e.prototype.removeFromInstanceList=
function(a,b){var c=cr.fastIndexOf(this.instances,a);0>c||(b&&this.useRenderCells&&a.rendercells&&a.rendercells.right>=a.rendercells.left&&(a.update_bbox(),this.render_grid.update(a,a.rendercells,null),a.rendercells.set(0,0,-1,-1)),c===this.instances.length-1?this.instances.pop():(cr.arrayRemove(this.instances,c),this.setZIndicesStaleFrom(c)),this.render_list_stale=!0)};e.prototype.appendToInstanceList=function(a,b){a.zindex=this.instances.length;this.instances.push(a);b&&this.useRenderCells&&a.rendercells&&
a.set_bbox_changed();this.render_list_stale=!0};e.prototype.prependToInstanceList=function(a,b){this.instances.unshift(a);this.setZIndicesStaleFrom(0);b&&this.useRenderCells&&a.rendercells&&a.set_bbox_changed()};e.prototype.moveInstanceAdjacent=function(a,b,d){var c=a.get_zindex();b=b.get_zindex();cr.arrayRemove(this.instances,c);c<b&&b--;d&&b++;b===this.instances.length?this.instances.push(a):this.instances.splice(b,0,a);this.setZIndicesStaleFrom(c<b?c:b)};e.prototype.setZIndicesStaleFrom=function(a){-1===
this.zindices_stale_from?this.zindices_stale_from=a:a<this.zindices_stale_from&&(this.zindices_stale_from=a);this.render_list_stale=this.zindices_stale=!0};e.prototype.updateZIndices=function(){if(this.zindices_stale){-1===this.zindices_stale_from&&(this.zindices_stale_from=0);var a;if(this.useRenderCells){var b=this.zindices_stale_from;for(a=this.instances.length;b<a;++b){var d=this.instances[b];d.zindex=b;this.render_grid.markRangeChanged(d.rendercells)}}else for(b=this.zindices_stale_from,a=this.instances.length;b<
a;++b)this.instances[b].zindex=b;this.zindices_stale=!1;this.zindices_stale_from=-1}};e.prototype.getScale=function(a){return this.getNormalScale()*(this.runtime.fullscreenScalingQuality||a?this.runtime.aspect_scale:1)};e.prototype.getNormalScale=function(){return(this.scale*this.layout.scale-1)*this.zoomRate+1};e.prototype.getAngle=function(){return this.disableAngle?0:cr.clamp_angle(this.layout.angle+this.angle)};var k=[],u=[],r=[];e.prototype.getRenderCellInstancesToDraw=function(){this.updateZIndices();
this.render_grid.queryRange(this.viewLeft,this.viewTop,this.viewRight,this.viewBottom,r);if(!r.length)return l();if(1===r.length){var a=l();cr.shallowAssignArray(a,r[0]);cr.clearArray(r);return a}for(var b=!0;1<r.length;){var d;a=r;var e=b;var g=0;for(d=a.length;g<d-1;g+=2){var k=a[g];var n=a[g+1];b=l();var v=k,t=n,A=b,B=0,E=0,m=0,p=v.length,K=t.length;for(A.length=p+K;B<p&&E<K;++m){var I=v[B];var M=t[E];I.zindex<M.zindex?(A[m]=I,++B):(A[m]=M,++E)}for(;B<p;++B,++m)A[m]=v[B];for(;E<K;++E,++m)A[m]=
t[E];e||(h(k),h(n));u.push(b)}1===d%2&&(e?(k=l(),cr.shallowAssignArray(k,a[d-1]),u.push(k)):u.push(a[d-1]));cr.shallowAssignArray(a,u);cr.clearArray(u);b=!1}a=r[0];cr.clearArray(r);return a};e.prototype.draw=function(a){this.render_offscreen=this.forceOwnTexture||1!==this.opacity||0!==this.blend_mode;var c=this.runtime.canvas,b=a,d=!1;this.render_offscreen&&(this.runtime.layer_canvas||(this.runtime.layer_canvas=document.createElement("canvas"),c=this.runtime.layer_canvas,c.width=this.runtime.draw_width,
c.height=this.runtime.draw_height,this.runtime.layer_ctx=c.getContext("2d"),d=!0),c=this.runtime.layer_canvas,b=this.runtime.layer_ctx,c.width!==this.runtime.draw_width&&(c.width=this.runtime.draw_width,d=!0),c.height!==this.runtime.draw_height&&(c.height=this.runtime.draw_height,d=!0),d&&this.runtime.setCtxImageSmoothingEnabled(b,this.runtime.linearSampling),this.transparent&&b.clearRect(0,0,this.runtime.draw_width,this.runtime.draw_height));b.globalAlpha=1;b.globalCompositeOperation="source-over";
this.transparent||(b.fillStyle="rgb("+this.background_color[0]+","+this.background_color[1]+","+this.background_color[2]+")",b.fillRect(0,0,this.runtime.draw_width,this.runtime.draw_height));b.save();this.disableAngle=!0;d=this.canvasToLayer(0,0,!0,!0);var e=this.canvasToLayer(0,0,!1,!0);this.disableAngle=!1;this.runtime.pixel_rounding&&(d=Math.round(d),e=Math.round(e));this.rotateViewport(d,e,b);var g=this.getScale();b.scale(g,g);b.translate(-d,-e);this.useRenderCells?(this.cur_render_cells.left=
this.render_grid.XToCell(this.viewLeft),this.cur_render_cells.top=this.render_grid.YToCell(this.viewTop),this.cur_render_cells.right=this.render_grid.XToCell(this.viewRight),this.cur_render_cells.bottom=this.render_grid.YToCell(this.viewBottom),this.render_list_stale||!this.cur_render_cells.equals(this.last_render_cells)?(h(this.last_render_list),d=this.getRenderCellInstancesToDraw(),this.render_list_stale=!1,this.last_render_cells.copy(this.cur_render_cells)):d=this.last_render_list):d=this.instances;
var k=null;e=0;for(g=d.length;e<g;++e){var n=d[e];n!==k&&(this.drawInstance(n,b),k=n)}this.useRenderCells&&(this.last_render_list=d);b.restore();this.render_offscreen&&(a.globalCompositeOperation=this.compositeOp,a.globalAlpha=this.opacity,a.drawImage(c,0,0))};e.prototype.drawInstance=function(a,b){if(a.visible&&0!==a.width&&0!==a.height){a.update_bbox();var c=a.bbox;c.right<this.viewLeft||c.bottom<this.viewTop||c.left>this.viewRight||c.top>this.viewBottom||(b.globalCompositeOperation=a.compositeOp,
a.draw(b))}};e.prototype.updateViewport=function(a){this.disableAngle=!0;var c=this.canvasToLayer(0,0,!0,!0),b=this.canvasToLayer(0,0,!1,!0);this.disableAngle=!1;this.runtime.pixel_rounding&&(c=Math.round(c),b=Math.round(b));this.rotateViewport(c,b,a)};e.prototype.rotateViewport=function(a,b,d){var c=this.getScale();this.viewLeft=a;this.viewTop=b;this.viewRight=a+1/c*this.runtime.draw_width;this.viewBottom=b+1/c*this.runtime.draw_height;this.viewLeft>this.viewRight&&(a=this.viewLeft,this.viewLeft=
this.viewRight,this.viewRight=a);this.viewTop>this.viewBottom&&(a=this.viewTop,this.viewTop=this.viewBottom,this.viewBottom=a);a=this.getAngle();0!==a&&(d&&(d.translate(this.runtime.draw_width/2,this.runtime.draw_height/2),d.rotate(-a),d.translate(this.runtime.draw_width/-2,this.runtime.draw_height/-2)),this.tmprect.set(this.viewLeft,this.viewTop,this.viewRight,this.viewBottom),this.tmprect.offset((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2),this.tmpquad.set_from_rotated_rect(this.tmprect,
a),this.tmpquad.bounding_box(this.tmprect),this.tmprect.offset((this.viewLeft+this.viewRight)/2,(this.viewTop+this.viewBottom)/2),this.viewLeft=this.tmprect.left,this.viewTop=this.tmprect.top,this.viewRight=this.tmprect.right,this.viewBottom=this.tmprect.bottom)};e.prototype.drawGL_earlyZPass=function(a){if(this.render_offscreen=this.forceOwnTexture){this.runtime.layer_tex||(this.runtime.layer_tex=a.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling));
if(this.runtime.layer_tex.c2width!==this.runtime.draw_width||this.runtime.layer_tex.c2height!==this.runtime.draw_height)a.deleteTexture(this.runtime.layer_tex),this.runtime.layer_tex=a.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);a.setRenderingToTexture(this.runtime.layer_tex)}this.disableAngle=!0;var c=this.canvasToLayer(0,0,!0,!0),b=this.canvasToLayer(0,0,!1,!0);this.disableAngle=!1;this.runtime.pixel_rounding&&(c=Math.round(c),b=Math.round(b));
this.rotateViewport(c,b,null);c=this.getScale();a.resetModelView();a.scale(c,c);a.rotateZ(-this.getAngle());a.translate((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2);a.updateModelView();this.useRenderCells?(this.cur_render_cells.left=this.render_grid.XToCell(this.viewLeft),this.cur_render_cells.top=this.render_grid.YToCell(this.viewTop),this.cur_render_cells.right=this.render_grid.XToCell(this.viewRight),this.cur_render_cells.bottom=this.render_grid.YToCell(this.viewBottom),
this.render_list_stale||!this.cur_render_cells.equals(this.last_render_cells)?(h(this.last_render_list),c=this.getRenderCellInstancesToDraw(),this.render_list_stale=!1,this.last_render_cells.copy(this.cur_render_cells)):c=this.last_render_list):c=this.instances;var d=null;for(b=c.length-1;0<=b;--b){var e=c[b];e!==d&&(this.drawInstanceGL_earlyZPass(c[b],a),d=e)}this.useRenderCells&&(this.last_render_list=c);this.transparent||(this.clear_earlyz_index=this.runtime.earlyz_index++,a.setEarlyZIndex(this.clear_earlyz_index),
a.setColorFillMode(1,1,1,1),a.fullscreenQuad(),a.restoreEarlyZMode())};e.prototype.drawGL=function(a){if(this.render_offscreen=this.forceOwnTexture||1!==this.opacity||0<this.active_effect_types.length||0!==this.blend_mode){this.runtime.layer_tex||(this.runtime.layer_tex=a.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling));if(this.runtime.layer_tex.c2width!==this.runtime.draw_width||this.runtime.layer_tex.c2height!==this.runtime.draw_height)a.deleteTexture(this.runtime.layer_tex),
this.runtime.layer_tex=a.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);a.setRenderingToTexture(this.runtime.layer_tex);this.transparent&&a.clear(0,0,0,0)}this.transparent||(this.runtime.enableFrontToBack?(a.setEarlyZIndex(this.clear_earlyz_index),a.setColorFillMode(this.background_color[0]/255,this.background_color[1]/255,this.background_color[2]/255,1),a.fullscreenQuad(),a.setTextureFillMode()):a.clear(this.background_color[0]/255,this.background_color[1]/
255,this.background_color[2]/255,1));this.disableAngle=!0;var c=this.canvasToLayer(0,0,!0,!0);var b=this.canvasToLayer(0,0,!1,!0);this.disableAngle=!1;this.runtime.pixel_rounding&&(c=Math.round(c),b=Math.round(b));this.rotateViewport(c,b,null);c=this.getScale();a.resetModelView();a.scale(c,c);a.rotateZ(-this.getAngle());a.translate((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2);a.updateModelView();this.useRenderCells?(this.cur_render_cells.left=this.render_grid.XToCell(this.viewLeft),
this.cur_render_cells.top=this.render_grid.YToCell(this.viewTop),this.cur_render_cells.right=this.render_grid.XToCell(this.viewRight),this.cur_render_cells.bottom=this.render_grid.YToCell(this.viewBottom),this.render_list_stale||!this.cur_render_cells.equals(this.last_render_cells)?(h(this.last_render_list),b=this.getRenderCellInstancesToDraw(),this.render_list_stale=!1,this.last_render_cells.copy(this.cur_render_cells)):b=this.last_render_list):b=this.instances;var d,e=null;var g=0;for(d=b.length;g<
d;++g){var k=b[g];k!==e&&(this.drawInstanceGL(b[g],a),e=k)}this.useRenderCells&&(this.last_render_list=b);this.render_offscreen&&(b=this.active_effect_types.length?this.active_effect_types[0].shaderindex:0,g=this.active_effect_types.length?this.active_effect_types[0].index:0,0===this.active_effect_types.length||1===this.active_effect_types.length&&!a.programUsesCrossSampling(b)&&1===this.opacity?(1===this.active_effect_types.length?(a.switchProgram(b),a.setProgramParameters(this.layout.getRenderTarget(),
1/this.runtime.draw_width,1/this.runtime.draw_height,0,0,1,1,c,this.getAngle(),this.viewLeft,this.viewTop,(this.viewLeft+this.viewRight)/2,(this.viewTop+this.viewBottom)/2,this.runtime.kahanTime.sum,this.effect_params[g]),a.programIsAnimated(b)&&(this.runtime.redraw=!0)):a.switchProgram(0),a.setRenderingToTexture(this.layout.getRenderTarget()),a.setOpacity(this.opacity),a.setTexture(this.runtime.layer_tex),a.setBlend(this.srcBlend,this.destBlend),a.resetModelView(),a.updateModelView(),c=this.runtime.draw_width/
2,b=this.runtime.draw_height/2,a.quad(-c,b,c,b,c,-b,-c,-b),a.setTexture(null)):this.layout.renderEffectChain(a,this,null,this.layout.getRenderTarget()))};e.prototype.drawInstanceGL=function(a,b){if(a.visible&&0!==a.width&&0!==a.height){a.update_bbox();var c=a.bbox;c.right<this.viewLeft||c.bottom<this.viewTop||c.left>this.viewRight||c.top>this.viewBottom||(b.setEarlyZIndex(a.earlyz_index),a.uses_shaders?this.drawInstanceWithShadersGL(a,b):(b.switchProgram(0),b.setBlend(a.srcBlend,a.destBlend),a.drawGL(b)))}};
e.prototype.drawInstanceGL_earlyZPass=function(a,b){if(a.visible&&0!==a.width&&0!==a.height){a.update_bbox();var c=a.bbox;c.right<this.viewLeft||c.bottom<this.viewTop||c.left>this.viewRight||c.top>this.viewBottom||(a.earlyz_index=this.runtime.earlyz_index++,0===a.blend_mode&&1===a.opacity&&a.shaders_preserve_opaqueness&&a.drawGL_earlyZPass&&(b.setEarlyZIndex(a.earlyz_index),a.drawGL_earlyZPass(b)))}};e.prototype.drawInstanceWithShadersGL=function(a,b){var c=a.active_effect_types[0].shaderindex,d=
a.active_effect_types[0].index,f=this.getScale();if(1!==a.active_effect_types.length||b.programUsesCrossSampling(c)||b.programExtendsBox(c)||(a.angle||a.layer.getAngle())&&b.programUsesDest(c)||1!==a.opacity||a.type.plugin.must_predraw)this.layout.renderEffectChain(b,this,a,this.render_offscreen?this.runtime.layer_tex:this.layout.getRenderTarget()),b.resetModelView(),b.scale(f,f),b.rotateZ(-this.getAngle()),b.translate((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2),b.updateModelView();
else{b.switchProgram(c);b.setBlend(a.srcBlend,a.destBlend);b.programIsAnimated(c)&&(this.runtime.redraw=!0);var e=0,g=0,k=0,t=0;b.programUsesDest(c)&&(t=a.bbox,e=this.layerToCanvas(t.left,t.top,!0,!0),g=this.layerToCanvas(t.left,t.top,!1,!0),k=this.layerToCanvas(t.right,t.bottom,!0,!0),t=this.layerToCanvas(t.right,t.bottom,!1,!0),e/=windowWidth,g=1-g/windowHeight,k/=windowWidth,t=1-t/windowHeight);if(a.curFrame&&a.curFrame.texture_img){var h=a.curFrame.texture_img;c=1/h.width;h=1/h.height}else c=
1/a.width,h=1/a.height;b.setProgramParameters(this.render_offscreen?this.runtime.layer_tex:this.layout.getRenderTarget(),c,h,e,g,k,t,f,this.getAngle(),this.viewLeft,this.viewTop,(this.viewLeft+this.viewRight)/2,(this.viewTop+this.viewBottom)/2,this.runtime.kahanTime.sum,a.effect_params[d]);a.drawGL(b)}};e.prototype.canvasToLayer=function(a,b,d,e){var c=this.runtime.devicePixelRatio;this.runtime.isRetina&&(a*=c,b*=c);c=this.runtime.parallax_x_origin;var f=this.runtime.parallax_y_origin;c=(this.layout.scrollX-
c)*this.parallaxX+c;f=(this.layout.scrollY-f)*this.parallaxY+f;var g=c,k=f,t=1/this.getScale(!e);e?(g-=this.runtime.draw_width*t/2,k-=this.runtime.draw_height*t/2):(g-=this.runtime.width*t/2,k-=this.runtime.height*t/2);g+=a*t;k+=b*t;b=this.getAngle();0!==b&&(g-=c,k-=f,a=Math.cos(b),b=Math.sin(b),e=g*a-k*b,k=k*a+g*b,g=e+c,k+=f);return d?g:k};e.prototype.layerToCanvas=function(a,b,d,e){var c=this.runtime.parallax_x_origin,f=this.runtime.parallax_y_origin,g=(this.layout.scrollX-c)*this.parallaxX+c,k=
(this.layout.scrollY-f)*this.parallaxY+f;f=g;c=k;var t=this.getAngle();if(0!==t){a-=g;b-=k;var h=Math.cos(-t);t=Math.sin(-t);var n=a*h-b*t;b=b*h+a*t;a=n+g;b+=k}g=1/this.getScale(!e);e?(f-=this.runtime.draw_width*g/2,c-=this.runtime.draw_height*g/2):(f-=this.runtime.width*g/2,c-=this.runtime.height*g/2);f=(a-f)/g;c=(b-c)/g;a=this.runtime.devicePixelRatio;this.runtime.isRetina&&!e&&(f/=a,c/=a);return d?f:c};e.prototype.rotatePt=function(a,b,d){if(0===this.getAngle())return d?a:b;var c=this.layerToCanvas(a,
b,!0);b=this.layerToCanvas(a,b,!1);this.disableAngle=!0;a=this.canvasToLayer(c,b,!0);c=this.canvasToLayer(c,b,!0);this.disableAngle=!1;return d?a:c};e.prototype.saveToJSON=function(){var a,b={s:this.scale,a:this.angle,vl:this.viewLeft,vt:this.viewTop,vr:this.viewRight,vb:this.viewBottom,v:this.visible,bc:this.background_color,t:this.transparent,px:this.parallaxX,py:this.parallaxY,o:this.opacity,zr:this.zoomRate,fx:[],cg:this.created_globals,instances:[]};var d=0;for(a=this.effect_types.length;d<a;d++){var e=
this.effect_types[d];b.fx.push({name:e.name,active:e.active,params:this.effect_params[e.index]})}return b};e.prototype.loadFromJSON=function(a){var c;this.scale=a.s;this.angle=a.a;this.viewLeft=a.vl;this.viewTop=a.vt;this.viewRight=a.vr;this.viewBottom=a.vb;this.visible=a.v;this.background_color=a.bc;this.transparent=a.t;this.parallaxX=a.px;this.parallaxY=a.py;this.opacity=a.o;this.zoomRate=a.zr;this.created_globals=a.cg||[];cr.shallowAssignArray(this.initial_instances,this.startup_initial_instances);
var d=new cr.ObjectSet;var e=0;for(c=this.created_globals.length;e<c;++e)d.add(this.created_globals[e]);var g=e=0;for(c=this.initial_instances.length;e<c;++e)d.contains(this.initial_instances[e][2])||(this.initial_instances[g]=this.initial_instances[e],++g);cr.truncateArray(this.initial_instances,g);g=a.fx;e=0;for(c=g.length;e<c;e++)if(a=this.getEffectByName(g[e].name))a.active=g[e].active,this.effect_params[a.index]=g[e].params;this.updateActiveEffects();this.instances.sort(b);this.zindices_stale=
!0};cr.layer=e})();
(function(){function a(a,c){var b,d=a.length;switch(d){case 0:return!0;case 1:return a[0]===c[0];case 2:return a[0]===c[0]&&a[1]===c[1];default:for(b=0;b<d;b++)if(a[b]!==c[b])return!1;return!0}}function b(a,c){return a.index-c.index}function e(c){var d;if(2===c.length){if(c[0].index>c[1].index){var f=c[0];c[0]=c[1];c[1]=f}}else 2<c.length&&c.sort(b);c.length>=y.length&&(y.length=c.length+1);y[c.length]||(y[c.length]=[]);var e=y[c.length];f=0;for(d=e.length;f<d;f++){var g=e[f];if(a(c,g))return g}e.push(c);
return c}function l(a,c){this.runtime=a;this.triggers={};this.fasttriggers={};this.hasRun=!1;this.includes=new cr.ObjectSet;this.deep_includes=[];this.already_included_sheets=[];this.name=c[0];a=c[1];this.events=[];var b;c=0;for(b=a.length;c<b;c++)this.init_event(a[c],null,this.events)}function h(a){this.type=a;this.instances=[];this.else_instances=[];this.select_all=!0}function n(a,c,b){this.sheet=a;this.parent=c;this.runtime=a.runtime;this.solModifiers=[];this.solModifiersIncludingParents=[];this.has_else_block=
this.toplevelgroup=this.toplevelevent=this.initially_activated=this.group=this.solWriterAfterCnds=!1;this.conditions=[];this.actions=[];this.subevents=[];this.group_name="";this.group_active=this.initially_activated=this.group=!1;this.contained_includes=null;b[1]&&(this.group_name=b[1][1].toLowerCase(),this.group=!0,this.initially_activated=!!b[1][0],this.contained_includes=[],this.group_active=this.initially_activated,this.runtime.allGroups.push(this),this.runtime.groups_by_name[this.group_name]=
this);this.orblock=b[2];this.sid=b[4];this.group||(this.runtime.blocksBySid[this.sid.toString()]=this);var d=b[5];a=0;for(c=d.length;a<c;a++){var f=new cr.condition(this,d[a]);f.index=a;cr.seal(f);this.conditions.push(f);this.addSolModifier(f.type)}d=b[6];a=0;for(c=d.length;a<c;a++)f=new cr.action(this,d[a]),f.index=a,cr.seal(f),this.actions.push(f);if(8===b.length)for(b=b[7],a=0,c=b.length;a<c;a++)this.sheet.init_event(b[a],this,this.subevents);this.is_else_block=!1;this.conditions.length&&(this.is_else_block=
null==this.conditions[0].type&&this.conditions[0].func==cr.system_object.prototype.cnds.Else)}function g(a,c){var b;if(a&&(-1===c.indexOf(a)&&c.push(a),a.is_contained)){var d=0;for(b=a.container.length;d<b;d++){var f=a.container[d];a!==f&&-1===c.indexOf(f)&&c.push(f)}}}function d(a,c){this.block=a;this.sheet=a.sheet;this.runtime=a.runtime;this.parameters=[];this.results=[];this.extra={};this.index=-1;this.anyParamVariesPerInstance=!1;this.func=this.runtime.GetObjectReference(c[1]);this.trigger=0<
c[3];this.fasttrigger=2===c[3];this.looping=c[4];this.inverted=c[5];this.isstatic=c[6];this.sid=c[7];this.runtime.cndsBySid[this.sid.toString()]=this;-1===c[0]?(this.type=null,this.run=this.run_system,this.behaviortype=null,this.beh_index=-1):(this.type=this.runtime.types_by_index[c[0]],this.run=this.isstatic?this.run_static:this.run_object,c[2]?(this.behaviortype=this.type.getBehaviorByName(c[2]),this.beh_index=this.type.getBehaviorIndexByName(c[2])):(this.behaviortype=null,this.beh_index=-1),this.block.parent&&
this.block.parent.setSolWriterAfterCnds());this.fasttrigger&&(this.run=this.run_true);if(10===c.length){var b=c[9];a=0;for(c=b.length;a<c;a++){var d=new cr.parameter(this,b[a]);cr.seal(d);this.parameters.push(d)}this.results.length=b.length}}function k(a,c){this.block=a;this.sheet=a.sheet;this.runtime=a.runtime;this.parameters=[];this.results=[];this.extra={};this.index=-1;this.anyParamVariesPerInstance=!1;this.func=this.runtime.GetObjectReference(c[1]);-1===c[0]?(this.type=null,this.run=this.run_system,
this.behaviortype=null,this.beh_index=-1):(this.type=this.runtime.types_by_index[c[0]],this.run=this.run_object,c[2]?(this.behaviortype=this.type.getBehaviorByName(c[2]),this.beh_index=this.type.getBehaviorIndexByName(c[2])):(this.behaviortype=null,this.beh_index=-1));this.sid=c[3];this.runtime.actsBySid[this.sid.toString()]=this;if(6===c.length){var b=c[5];a=0;for(c=b.length;a<c;a++){var d=new cr.parameter(this,b[a]);cr.seal(d);this.parameters.push(d)}this.results.length=b.length}}function u(){x++;
z.length===x&&z.push(new cr.expvalue);return z[x]}function r(a,c){this.owner=a;this.block=a.block;this.sheet=a.sheet;this.runtime=a.runtime;this.type=c[0];this.expression=null;this.solindex=0;this.get=null;this.combosel=0;this.layout=null;this.key=0;this.object=null;this.index=0;this.variadicret=this.subparams=this.fileinfo=this.eventvar=this.varname=null;this.variesPerInstance=!1;var b;switch(c[0]){case 0:case 7:this.expression=new cr.expNode(this,c[1]);this.solindex=0;this.get=this.get_exp;break;
case 1:this.expression=new cr.expNode(this,c[1]);this.solindex=0;this.get=this.get_exp_str;break;case 5:this.expression=new cr.expNode(this,c[1]);this.solindex=0;this.get=this.get_layer;break;case 3:case 8:this.combosel=c[1];this.get=this.get_combosel;break;case 6:this.layout=this.runtime.layouts[c[1]];this.get=this.get_layout;break;case 9:this.key=c[1];this.get=this.get_key;break;case 4:this.object=this.runtime.types_by_index[c[1]];this.get=this.get_object;this.block.addSolModifier(this.object);
this.owner instanceof cr.action?this.block.setSolWriterAfterCnds():this.block.parent&&this.block.parent.setSolWriterAfterCnds();break;case 10:this.index=c[1];a.type&&a.type.is_family?(this.get=this.get_familyvar,this.variesPerInstance=!0):this.get=this.get_instvar;break;case 11:this.varname=c[1];this.eventvar=null;this.get=this.get_eventvar;break;case 2:case 12:this.fileinfo=c[1];this.get=this.get_audiofile;break;case 13:for(this.get=this.get_variadic,this.subparams=[],this.variadicret=[],a=1,b=c.length;a<
b;a++){var d=new cr.parameter(this.owner,c[a]);cr.seal(d);this.subparams.push(d);this.variadicret.push(0)}}}function c(a,c,b){this.sheet=a;this.parent=c;this.runtime=a.runtime;this.solModifiers=[];this.name=b[1];this.vartype=b[2];this.initial=b[3];this.is_static=!!b[4];this.is_constant=!!b[5];this.sid=b[6];this.runtime.varsBySid[this.sid.toString()]=this;this.data=this.initial;this.parent?(this.localIndex=this.is_static||this.is_constant?-1:this.runtime.stackLocalCount++,this.runtime.all_local_vars.push(this)):
(this.localIndex=-1,this.runtime.all_global_vars.push(this))}function f(a,c,b){this.sheet=a;this.parent=c;this.runtime=a.runtime;this.solModifiers=[];this.include_sheet=null;this.include_sheet_name=b[1];this.active=!0}function q(){this.temp_parents_arr=[];this.reset(null);cr.seal(this)}var y=[];l.prototype.toString=function(){return this.name};l.prototype.init_event=function(a,c,b){switch(a[0]){case 0:a=new cr.eventblock(this,c,a);cr.seal(a);if(a.orblock)for(b.push(a),b=0,c=a.conditions.length;b<
c;b++)a.conditions[b].trigger&&this.init_trigger(a,b);else a.is_trigger()?this.init_trigger(a,0):b.push(a);break;case 1:a=new cr.eventvariable(this,c,a);cr.seal(a);b.push(a);break;case 2:a=new cr.eventinclude(this,c,a),cr.seal(a),b.push(a)}};l.prototype.postInit=function(){var a;var c=0;for(a=this.events.length;c<a;c++)this.events[c].postInit(c<a-1&&this.events[c+1].is_else_block)};l.prototype.updateDeepIncludes=function(){cr.clearArray(this.deep_includes);cr.clearArray(this.already_included_sheets);
this.addDeepIncludes(this);cr.clearArray(this.already_included_sheets)};l.prototype.addDeepIncludes=function(a){var c,b=a.deep_includes,d=a.already_included_sheets,f=this.includes.valuesRef();var e=0;for(c=f.length;e<c;++e){var m=f[e];var p=m.include_sheet;!m.isActive()||a===p||-1<d.indexOf(p)||(d.push(p),p.addDeepIncludes(a),b.push(p))}};l.prototype.run=function(a){this.runtime.resuming_breakpoint||(this.hasRun=!0,a||(this.runtime.isRunningEvents=!0));var c;var b=0;for(c=this.events.length;b<c;b++){var d=
this.events[b];d.run();this.runtime.clearSol(d.solModifiers);this.runtime.hasPendingInstances&&this.runtime.ClearDeathRow()}a||(this.runtime.isRunningEvents=!1)};l.prototype.init_trigger=function(a,c){a.orblock||this.runtime.triggers_to_postinit.push(a);var b,d,f=a.conditions[c];var e=f.type?f.type.name:"system";var m=(b=f.fasttrigger)?this.fasttriggers:this.triggers;m[e]||(m[e]=[]);e=m[e];m=f.func;if(b){if(f.parameters.length&&(f=f.parameters[0],1===f.type&&2===f.expression.type)){f=f.expression.value.toLowerCase();
b=0;for(d=e.length;b<d;b++)if(e[b].method==m){b=e[b].evs;b[f]?b[f].push([a,c]):b[f]=[[a,c]];return}b={};b[f]=[[a,c]];e.push({method:m,evs:b})}}else{b=0;for(d=e.length;b<d;b++)if(e[b].method==m){e[b].evs.push([a,c]);return}f=cr.plugins_.Sprite&&m===cr.plugins_.Sprite.prototype.cnds.OnFrameChanged?!0:!1;f?e.unshift({method:m,evs:[[a,c]]}):e.push({method:m,evs:[[a,c]]})}};cr.eventsheet=l;h.prototype.hasObjects=function(){return this.select_all?this.type.instances.length:this.instances.length};h.prototype.getObjects=
function(){return this.select_all?this.type.instances:this.instances};h.prototype.pick_one=function(a){a&&(a.runtime.getCurrentEventStack().current_event.orblock?(this.select_all&&(cr.clearArray(this.instances),cr.shallowAssignArray(this.else_instances,a.type.instances),this.select_all=!1),a=this.else_instances.indexOf(a),-1!==a&&(this.instances.push(this.else_instances[a]),this.else_instances.splice(a,1))):(this.select_all=!1,cr.clearArray(this.instances),this.instances[0]=a))};cr.selection=h;window._c2hh_=
"CF4BD01569DCA121D76845B4FE35F9DC1B4B6115";n.prototype.postInit=function(a){var c,b=this.parent;if(this.group)for(this.toplevelgroup=!0;b;){if(!b.group){this.toplevelgroup=!1;break}b=b.parent}this.toplevelevent=!this.is_trigger()&&(!this.parent||this.parent.group&&this.parent.toplevelgroup);this.has_else_block=!!a;this.solModifiersIncludingParents=this.solModifiers.slice(0);for(b=this.parent;b;){a=0;for(c=b.solModifiers.length;a<c;a++)this.addParentSolModifier(b.solModifiers[a]);b=b.parent}this.solModifiers=
e(this.solModifiers);this.solModifiersIncludingParents=e(this.solModifiersIncludingParents);a=0;for(c=this.conditions.length;a<c;a++)this.conditions[a].postInit();a=0;for(c=this.actions.length;a<c;a++)this.actions[a].postInit();a=0;for(c=this.subevents.length;a<c;a++)this.subevents[a].postInit(a<c-1&&this.subevents[a+1].is_else_block)};n.prototype.setGroupActive=function(a){if(this.group_active!==!!a){this.group_active=!!a;var c;a=0;for(c=this.contained_includes.length;a<c;++a)this.contained_includes[a].updateActive();
0<c&&this.runtime.running_layout.event_sheet&&this.runtime.running_layout.event_sheet.updateDeepIncludes()}};n.prototype.addSolModifier=function(a){g(a,this.solModifiers)};n.prototype.addParentSolModifier=function(a){g(a,this.solModifiersIncludingParents)};n.prototype.setSolWriterAfterCnds=function(){this.solWriterAfterCnds=!0;this.parent&&this.parent.setSolWriterAfterCnds()};n.prototype.is_trigger=function(){return this.conditions.length?this.conditions[0].trigger:!1};n.prototype.run=function(){var a,
c=!1,b=this.runtime,d=this.runtime.getCurrentEventStack();d.current_event=this;var f=this.conditions;this.is_else_block||(d.else_branch_ran=!1);if(this.orblock){0===f.length&&(c=!0);d.cndindex=0;for(a=f.length;d.cndindex<a;d.cndindex++){var e=f[d.cndindex];e.trigger||(e=e.run())&&(c=!0)}(d.last_event_true=c)&&this.run_actions_and_subevents()}else{d.cndindex=0;for(a=f.length;d.cndindex<a;d.cndindex++)if(e=f[d.cndindex].run(),!e){d.last_event_true=!1;this.toplevelevent&&b.hasPendingInstances&&b.ClearDeathRow();
return}d.last_event_true=!0;this.run_actions_and_subevents()}this.end_run(d)};n.prototype.end_run=function(a){a.last_event_true&&this.has_else_block&&(a.else_branch_ran=!0);this.toplevelevent&&this.runtime.hasPendingInstances&&this.runtime.ClearDeathRow()};n.prototype.run_orblocktrigger=function(a){this.runtime.getCurrentEventStack().current_event=this;this.conditions[a].run()&&(this.run_actions_and_subevents(),this.runtime.getCurrentEventStack().last_event_true=!0)};n.prototype.run_actions_and_subevents=
function(){var a=this.runtime.getCurrentEventStack(),c;a.actindex=0;for(c=this.actions.length;a.actindex<c;a.actindex++)if(this.actions[a.actindex].run())return;this.run_subevents()};n.prototype.resume_actions_and_subevents=function(){var a=this.runtime.getCurrentEventStack(),c;for(c=this.actions.length;a.actindex<c;a.actindex++)if(this.actions[a.actindex].run())return;this.run_subevents()};n.prototype.run_subevents=function(){if(this.subevents.length){var a,c,b=this.subevents.length-1;this.runtime.pushEventStack(this);
if(this.solWriterAfterCnds){var d=0;for(a=this.subevents.length;d<a;d++){var f=this.subevents[d];(c=!this.toplevelgroup||!this.group&&d<b)&&this.runtime.pushCopySol(f.solModifiers);f.run();c?this.runtime.popSol(f.solModifiers):this.runtime.clearSol(f.solModifiers)}}else for(d=0,a=this.subevents.length;d<a;d++)this.subevents[d].run();this.runtime.popEventStack()}};n.prototype.run_pretrigger=function(){var a=this.runtime.getCurrentEventStack();a.current_event=this;var c=!1,b;a.cndindex=0;for(b=this.conditions.length;a.cndindex<
b;a.cndindex++)if(this.conditions[a.cndindex].run())c=!0;else if(!this.orblock)return!1;return this.orblock?c:!0};n.prototype.retrigger=function(){this.runtime.execcount++;var a=this.runtime.getCurrentEventStack().cndindex,c=this.runtime.pushEventStack(this);if(!this.orblock)for(c.cndindex=a+1,a=this.conditions.length;c.cndindex<a;c.cndindex++)if(!this.conditions[c.cndindex].run())return this.runtime.popEventStack(),!1;this.run_actions_and_subevents();this.runtime.popEventStack();return!0};n.prototype.isFirstConditionOfType=
function(a){var c=a.index;if(0===c)return!0;for(--c;0<=c;--c)if(this.conditions[c].type===a.type)return!1;return!0};cr.eventblock=n;d.prototype.postInit=function(){var a;var c=0;for(a=this.parameters.length;c<a;c++){var b=this.parameters[c];b.postInit();b.variesPerInstance&&(this.anyParamVariesPerInstance=!0)}};d.prototype.run_true=function(){return!0};d.prototype.run_system=function(){var a;var c=0;for(a=this.parameters.length;c<a;c++)this.results[c]=this.parameters[c].get();return cr.xor(this.func.apply(this.runtime.system,
this.results),this.inverted)};d.prototype.run_static=function(){var a;var c=0;for(a=this.parameters.length;c<a;c++)this.results[c]=this.parameters[c].get();c=this.func.apply(this.behaviortype?this.behaviortype:this.type,this.results);this.type.applySolToContainer();return c};d.prototype.run_object=function(){var a,c,b,d=this.type,f=d.getCurrentSol(),e=this.block.orblock&&!this.trigger,m=d.is_contained,p=d.is_family,g=d.family_index,k=this.beh_index,h=-1<k,n=this.anyParamVariesPerInstance,r=this.parameters,
q=this.results,l=this.inverted,u=this.func;if(n){var x=0;for(c=r.length;x<c;++x){var y=r[x];y.variesPerInstance||(q[x]=y.get(0))}}else for(x=0,c=r.length;x<c;++x)q[x]=r[x].get(0);if(f.select_all){cr.clearArray(f.instances);cr.clearArray(f.else_instances);var z=d.instances;var w=0;for(a=z.length;w<a;++w){var D=z[w];if(n)for(x=0,c=r.length;x<c;++x)y=r[x],y.variesPerInstance&&(q[x]=y.get(w));h?(x=0,p&&(x=D.type.family_beh_map[g]),x=u.apply(D.behavior_insts[k+x],q)):x=u.apply(D,q);(b=cr.xor(x,l))?f.instances.push(D):
e&&f.else_instances.push(D)}d.finish&&d.finish(!0);f.select_all=!1;d.applySolToContainer();return f.hasObjects()}var Q=0;z=(b=e&&!this.block.isFirstConditionOfType(this))?f.else_instances:f.instances;var L=!1;w=0;for(a=z.length;w<a;++w){D=z[w];if(n)for(x=0,c=r.length;x<c;++x)y=r[x],y.variesPerInstance&&(q[x]=y.get(w));h?(x=0,p&&(x=D.type.family_beh_map[g]),x=u.apply(D.behavior_insts[k+x],q)):x=u.apply(D,q);if(cr.xor(x,l))if(L=!0,b){if(f.instances.push(D),m)for(x=0,c=D.siblings.length;x<c;x++)y=D.siblings[x],
y.type.getCurrentSol().instances.push(y)}else{z[Q]=D;if(m)for(x=0,c=D.siblings.length;x<c;x++)y=D.siblings[x],y.type.getCurrentSol().instances[Q]=y;Q++}else if(b){z[Q]=D;if(m)for(x=0,c=D.siblings.length;x<c;x++)y=D.siblings[x],y.type.getCurrentSol().else_instances[Q]=y;Q++}else if(e&&(f.else_instances.push(D),m))for(x=0,c=D.siblings.length;x<c;x++)y=D.siblings[x],y.type.getCurrentSol().else_instances.push(y)}cr.truncateArray(z,Q);if(m)for(p=d.container,w=0,a=p.length;w<a;w++)D=p[w].getCurrentSol(),
b?cr.truncateArray(D.else_instances,Q):cr.truncateArray(D.instances,Q);Q=L;if(b&&!L)for(w=0,a=f.instances.length;w<a;w++){D=f.instances[w];if(n)for(x=0,c=r.length;x<c;x++)y=r[x],y.variesPerInstance&&(q[x]=y.get(w));x=h?u.apply(D.behavior_insts[k],q):u.apply(D,q);if(cr.xor(x,l)){L=!0;break}}d.finish&&d.finish(Q||e);return e?L:f.hasObjects()};cr.condition=d;k.prototype.postInit=function(){var a;var c=0;for(a=this.parameters.length;c<a;c++){var b=this.parameters[c];b.postInit();b.variesPerInstance&&
(this.anyParamVariesPerInstance=!0)}};k.prototype.run_system=function(){var a=this.runtime,c,b=this.parameters,d=this.results;var f=0;for(c=b.length;f<c;++f)d[f]=b[f].get();return this.func.apply(a.system,d)};k.prototype.run_object=function(){var a=this.type,c=this.beh_index,b=a.family_index,d=this.anyParamVariesPerInstance,f=this.parameters,e=this.results,m=this.func,g=a.getCurrentSol().getObjects();a=a.is_family;var k=-1<c,h,n;if(d){var r=0;for(n=f.length;r<n;++r){var q=f[r];q.variesPerInstance||
(e[r]=q.get(0))}}else for(r=0,n=f.length;r<n;++r)e[r]=f[r].get(0);var l=0;for(h=g.length;l<h;++l){var x=g[l];if(d)for(r=0,n=f.length;r<n;++r)q=f[r],q.variesPerInstance&&(e[r]=q.get(l));k?(r=0,a&&(r=x.type.family_beh_map[b]),m.apply(x.behavior_insts[c+r],e)):m.apply(x,e)}return!1};cr.action=k;var z=[],x=-1;r.prototype.postInit=function(){var a;if(11===this.type)this.eventvar=this.runtime.getEventVariableByName(this.varname,this.block.parent);else if(13===this.type){var c=0;for(a=this.subparams.length;c<
a;c++)this.subparams[c].postInit()}this.expression&&this.expression.postInit()};r.prototype.maybeVaryForType=function(a){this.variesPerInstance||!a||a.plugin.singleglobal||(this.variesPerInstance=!0)};r.prototype.setVaries=function(){this.variesPerInstance=!0};r.prototype.get_exp=function(a){this.solindex=a||0;a=u();this.expression.get(a);x--;return a.data};r.prototype.get_exp_str=function(a){this.solindex=a||0;a=u();this.expression.get(a);x--;return cr.is_string(a.data)?a.data:""};r.prototype.get_object=
function(){return this.object};r.prototype.get_combosel=function(){return this.combosel};r.prototype.get_layer=function(a){this.solindex=a||0;a=u();this.expression.get(a);x--;return a.is_number()?this.runtime.getLayerByNumber(a.data):this.runtime.getLayerByName(a.data)};r.prototype.get_layout=function(){return this.layout};r.prototype.get_key=function(){return this.key};r.prototype.get_instvar=function(){return this.index};r.prototype.get_familyvar=function(a){var c=a||0;a=this.owner.type;var b=a.getCurrentSol(),
d=b.getObjects();if(d.length)c=d[c%d.length].type;else if(b.else_instances.length)c=b.else_instances[c%b.else_instances.length].type;else if(a.instances.length)c=a.instances[c%a.instances.length].type;else return 0;return this.index+c.family_var_map[a.family_index]};r.prototype.get_eventvar=function(){return this.eventvar};r.prototype.get_audiofile=function(){return this.fileinfo};r.prototype.get_variadic=function(){var a;var c=0;for(a=this.subparams.length;c<a;c++)this.variadicret[c]=this.subparams[c].get();
return this.variadicret};cr.parameter=r;c.prototype.postInit=function(){this.solModifiers=e(this.solModifiers)};c.prototype.setValue=function(a){var c=this.runtime.getCurrentLocalVarStack();this.parent&&!this.is_static&&c?(this.localIndex>=c.length&&(c.length=this.localIndex+1),c[this.localIndex]=a):this.data=a};c.prototype.getValue=function(){var a=this.runtime.getCurrentLocalVarStack();return!this.parent||this.is_static||!a||this.is_constant?this.data:this.localIndex>=a.length||"undefined"===typeof a[this.localIndex]?
this.initial:a[this.localIndex]};c.prototype.run=function(){!this.parent||this.is_static||this.is_constant||this.setValue(this.initial)};cr.eventvariable=c;f.prototype.toString=function(){return"include:"+this.include_sheet.toString()};f.prototype.postInit=function(){this.include_sheet=this.runtime.eventsheets[this.include_sheet_name];this.sheet.includes.add(this);this.solModifiers=e(this.solModifiers);for(var a=this.parent;a;)a.group&&a.contained_includes.push(this),a=a.parent;this.updateActive()};
f.prototype.run=function(){this.parent&&this.runtime.pushCleanSol(this.runtime.types_by_index);this.include_sheet.hasRun||this.include_sheet.run(!0);this.parent&&this.runtime.popSol(this.runtime.types_by_index)};f.prototype.updateActive=function(){for(var a=this.parent;a;){if(a.group&&!a.group_active){this.active=!1;return}a=a.parent}this.active=!0};f.prototype.isActive=function(){return this.active};cr.eventinclude=f;q.prototype.reset=function(a){this.current_event=a;this.actindex=this.cndindex=
0;cr.clearArray(this.temp_parents_arr);this.any_true_state=this.else_branch_ran=this.last_event_true=!1};q.prototype.isModifierAfterCnds=function(){return this.current_event.solWriterAfterCnds?!0:this.cndindex<this.current_event.conditions.length-1?!!this.current_event.solModifiers.length:!1};cr.eventStackFrame=q})();
(function(){function a(a,b){this.owner=a;this.runtime=a.runtime;this.type=b[0];this.get=[this.eval_int,this.eval_float,this.eval_string,this.eval_unaryminus,this.eval_add,this.eval_subtract,this.eval_multiply,this.eval_divide,this.eval_mod,this.eval_power,this.eval_and,this.eval_or,this.eval_equal,this.eval_notequal,this.eval_less,this.eval_lessequal,this.eval_greater,this.eval_greaterequal,this.eval_conditional,this.eval_system_exp,this.eval_object_exp,this.eval_instvar_exp,this.eval_behavior_exp,
this.eval_eventvar_exp][this.type];var d=null;this.object_type=this.parameters=this.results=this.func=this.third=this.second=this.first=this.value=null;this.beh_index=-1;this.instance_expr=null;this.varindex=-1;this.eventvar=this.varname=this.behavior_type=null;this.return_string=!1;switch(this.type){case 0:case 1:case 2:this.value=b[1];break;case 3:this.first=new cr.expNode(a,b[1]);break;case 18:this.first=new cr.expNode(a,b[1]);this.second=new cr.expNode(a,b[2]);this.third=new cr.expNode(a,b[3]);
break;case 19:this.func=this.runtime.GetObjectReference(b[1]);this.func!==cr.system_object.prototype.exps.random&&this.func!==cr.system_object.prototype.exps.choose||this.owner.setVaries();this.results=[];this.parameters=[];3===b.length?(d=b[2],this.results.length=d.length+1):this.results.length=1;break;case 20:this.object_type=this.runtime.types_by_index[b[1]];this.beh_index=-1;this.func=this.runtime.GetObjectReference(b[2]);this.return_string=b[3];cr.plugins_.Function&&this.func===cr.plugins_.Function.prototype.exps.Call&&
this.owner.setVaries();this.instance_expr=b[4]?new cr.expNode(a,b[4]):null;this.results=[];this.parameters=[];6===b.length?(d=b[5],this.results.length=d.length+1):this.results.length=1;break;case 21:this.object_type=this.runtime.types_by_index[b[1]];this.return_string=b[2];this.instance_expr=b[3]?new cr.expNode(a,b[3]):null;this.varindex=b[4];break;case 22:this.object_type=this.runtime.types_by_index[b[1]];this.behavior_type=this.object_type.getBehaviorByName(b[2]);this.beh_index=this.object_type.getBehaviorIndexByName(b[2]);
this.func=this.runtime.GetObjectReference(b[3]);this.return_string=b[4];this.instance_expr=b[5]?new cr.expNode(a,b[5]):null;this.results=[];this.parameters=[];7===b.length?(d=b[6],this.results.length=d.length+1):this.results.length=1;break;case 23:this.varname=b[1],this.eventvar=null}this.owner.maybeVaryForType(this.object_type);4<=this.type&&17>=this.type&&(this.first=new cr.expNode(a,b[1]),this.second=new cr.expNode(a,b[2]));if(d){var e;b=0;for(e=d.length;b<e;b++)this.parameters.push(new cr.expNode(a,
d[b]))}cr.seal(this)}function b(){++n;h.length===n&&h.push(new cr.expvalue);return h[n]}function e(a,b,e){var d;var g=0;for(d=a.length;g<d;++g)a[g].get(e),b[g+1]=e.data}function l(a,b){this.type=a||cr.exptype.Integer;this.data=b||0;this.object_class=null;this.type==cr.exptype.Integer&&(this.data=Math.floor(this.data));cr.seal(this)}a.prototype.postInit=function(){23===this.type&&(this.eventvar=this.owner.runtime.getEventVariableByName(this.varname,this.owner.block.parent));this.first&&this.first.postInit();
this.second&&this.second.postInit();this.third&&this.third.postInit();this.instance_expr&&this.instance_expr.postInit();if(this.parameters){var a;var b=0;for(a=this.parameters.length;b<a;b++)this.parameters[b].postInit()}};var h=[],n=-1;a.prototype.eval_system_exp=function(a){var d=this.parameters,g=this.results;g[0]=a;a=b();e(d,g,a);--n;this.func.apply(this.runtime.system,g)};a.prototype.eval_object_exp=function(a){var d=this.object_type,g=this.results,h=this.parameters,r=this.instance_expr,c=this.func,
f=this.owner.solindex,q=d.getCurrentSol(),l=q.getObjects();if(!l.length)if(q.else_instances.length)l=q.else_instances;else{this.return_string?a.set_string(""):a.set_int(0);return}g[0]=a;a.object_class=d;a=b();e(h,g,a);r&&(r.get(a),a.is_number()&&(f=a.data,l=d.instances));--n;d=l.length;if(f>=d||f<=-d)f%=d;0>f&&(f+=d);c.apply(l[f],g)};a.prototype.eval_behavior_exp=function(a){var d=this.object_type,g=this.results,h=this.parameters,r=this.instance_expr,c=this.beh_index,f=this.func,q=this.owner.solindex,
l=d.getCurrentSol(),z=l.getObjects();if(!z.length)if(l.else_instances.length)z=l.else_instances;else{this.return_string?a.set_string(""):a.set_int(0);return}g[0]=a;a.object_class=d;a=b();e(h,g,a);r&&(r.get(a),a.is_number()&&(q=a.data,z=d.instances));--n;h=z.length;if(q>=h||q<=-h)q%=h;0>q&&(q+=h);q=z[q];z=0;d.is_family&&(z=q.type.family_beh_map[d.family_index]);f.apply(q.behavior_insts[c+z],g)};a.prototype.eval_instvar_exp=function(a){var d=this.instance_expr,e=this.object_type,g=this.varindex,h=this.owner.solindex,
c=e.getCurrentSol(),f=c.getObjects();if(!f.length)if(c.else_instances.length)f=c.else_instances;else{this.return_string?a.set_string(""):a.set_int(0);return}if(d){c=b();d.get(c);if(c.is_number()){h=c.data;f=e.instances;0!==f.length&&(h%=f.length,0>h&&(h+=f.length));h=e.getInstanceByIID(h);e=h.instance_vars[g];cr.is_string(e)?a.set_string(e):a.set_float(e);--n;return}--n}d=f.length;if(h>=d||h<=-d)h%=d;0>h&&(h+=d);h=f[h];f=0;e.is_family&&(f=h.type.family_var_map[e.family_index]);e=h.instance_vars[g+
f];cr.is_string(e)?a.set_string(e):a.set_float(e)};a.prototype.eval_int=function(a){a.type=cr.exptype.Integer;a.data=this.value};a.prototype.eval_float=function(a){a.type=cr.exptype.Float;a.data=this.value};a.prototype.eval_string=function(a){a.type=cr.exptype.String;a.data=this.value};a.prototype.eval_unaryminus=function(a){this.first.get(a);a.is_number()&&(a.data=-a.data)};a.prototype.eval_add=function(a){this.first.get(a);var d=b();this.second.get(d);a.is_number()&&d.is_number()&&(a.data+=d.data,
d.is_float()&&a.make_float());--n};a.prototype.eval_subtract=function(a){this.first.get(a);var d=b();this.second.get(d);a.is_number()&&d.is_number()&&(a.data-=d.data,d.is_float()&&a.make_float());--n};a.prototype.eval_multiply=function(a){this.first.get(a);var d=b();this.second.get(d);a.is_number()&&d.is_number()&&(a.data*=d.data,d.is_float()&&a.make_float());--n};a.prototype.eval_divide=function(a){this.first.get(a);var d=b();this.second.get(d);a.is_number()&&d.is_number()&&(a.data/=d.data,a.make_float());
--n};a.prototype.eval_mod=function(a){this.first.get(a);var d=b();this.second.get(d);a.is_number()&&d.is_number()&&(a.data%=d.data,d.is_float()&&a.make_float());--n};a.prototype.eval_power=function(a){this.first.get(a);var d=b();this.second.get(d);a.is_number()&&d.is_number()&&(a.data=Math.pow(a.data,d.data),d.is_float()&&a.make_float());--n};a.prototype.eval_and=function(a){this.first.get(a);var d=b();this.second.get(d);d.is_string()||a.is_string()?this.eval_and_stringconcat(a,d):this.eval_and_logical(a,
d);--n};a.prototype.eval_and_stringconcat=function(a,b){a.is_string()&&b.is_string()?this.eval_and_stringconcat_str_str(a,b):this.eval_and_stringconcat_num(a,b)};a.prototype.eval_and_stringconcat_str_str=function(a,b){a.data+=b.data};a.prototype.eval_and_stringconcat_num=function(a,b){a.is_string()?a.data+=(Math.round(1E10*b.data)/1E10).toString():a.set_string(a.data.toString()+b.data)};a.prototype.eval_and_logical=function(a,b){a.set_int(a.data&&b.data?1:0)};a.prototype.eval_or=function(a){this.first.get(a);
var d=b();this.second.get(d);a.is_number()&&d.is_number()&&(a.data||d.data?a.set_int(1):a.set_int(0));--n};a.prototype.eval_conditional=function(a){this.first.get(a);a.data?this.second.get(a):this.third.get(a)};a.prototype.eval_equal=function(a){this.first.get(a);var d=b();this.second.get(d);a.set_int(a.data===d.data?1:0);--n};a.prototype.eval_notequal=function(a){this.first.get(a);var d=b();this.second.get(d);a.set_int(a.data!==d.data?1:0);--n};a.prototype.eval_less=function(a){this.first.get(a);
var d=b();this.second.get(d);a.set_int(a.data<d.data?1:0);--n};a.prototype.eval_lessequal=function(a){this.first.get(a);var d=b();this.second.get(d);a.set_int(a.data<=d.data?1:0);--n};a.prototype.eval_greater=function(a){this.first.get(a);var d=b();this.second.get(d);a.set_int(a.data>d.data?1:0);--n};a.prototype.eval_greaterequal=function(a){this.first.get(a);var d=b();this.second.get(d);a.set_int(a.data>=d.data?1:0);--n};a.prototype.eval_eventvar_exp=function(a){var b=this.eventvar.getValue();cr.is_number(b)?
a.set_float(b):a.set_string(b)};cr.expNode=a;l.prototype.is_int=function(){return this.type===cr.exptype.Integer};l.prototype.is_float=function(){return this.type===cr.exptype.Float};l.prototype.is_number=function(){return this.type===cr.exptype.Integer||this.type===cr.exptype.Float};l.prototype.is_string=function(){return this.type===cr.exptype.String};l.prototype.make_int=function(){this.is_int()||(this.is_float()?this.data=Math.floor(this.data):this.is_string()&&(this.data=parseInt(this.data,10)),
this.type=cr.exptype.Integer)};l.prototype.make_float=function(){this.is_float()||(this.is_string()&&(this.data=parseFloat(this.data)),this.type=cr.exptype.Float)};l.prototype.make_string=function(){this.is_string()||(this.data=this.data.toString(),this.type=cr.exptype.String)};l.prototype.set_int=function(a){this.type=cr.exptype.Integer;this.data=Math.floor(a)};l.prototype.set_float=function(a){this.type=cr.exptype.Float;this.data=a};l.prototype.set_string=function(a){this.type=cr.exptype.String;
this.data=a};l.prototype.set_any=function(a){cr.is_number(a)?(this.type=cr.exptype.Float,this.data=a):cr.is_string(a)?(this.type=cr.exptype.String,this.data=a.toString()):(this.type=cr.exptype.Integer,this.data=0)};cr.expvalue=l;cr.exptype={Integer:0,Float:1,String:2}})();cr.system_object=function(a){this.runtime=a;this.waits=[]};
cr.system_object.prototype.saveToJSON=function(){var a={},b,e,l;a.waits=[];var h=a.waits;var n=0;for(b=this.waits.length;n<b;n++){var g=this.waits[n];var d={t:g.time,st:g.signaltag,s:g.signalled,ev:g.ev.sid,sm:[],sols:{}};g.ev.actions[g.actindex]&&(d.act=g.ev.actions[g.actindex].sid);var k=0;for(e=g.solModifiers.length;k<e;k++)d.sm.push(g.solModifiers[k].sid);for(l in g.sols)if(g.sols.hasOwnProperty(l)){var u=this.runtime.types_by_index[parseInt(l,10)];var r={sa:g.sols[l].sa,insts:[]};k=0;for(e=g.sols[l].insts.length;k<
e;k++)r.insts.push(g.sols[l].insts[k].uid);d.sols[u.sid.toString()]=r}h.push(d)}return a};
cr.system_object.prototype.loadFromJSON=function(a){a=a.waits;var b,e,l,h,n;cr.clearArray(this.waits);var g=0;for(b=a.length;g<b;g++){var d=a[g];if(h=this.runtime.blocksBySid[d.ev.toString()]){var k=-1;var u=0;for(e=h.actions.length;u<e;u++)if(h.actions[u].sid===d.act){k=u;break}if(-1!==k){var r={sols:{},solModifiers:[],deleteme:!1};r.time=d.t;r.signaltag=d.st||"";r.signalled=!!d.s;r.ev=h;r.actindex=k;u=0;for(e=d.sm.length;u<e;u++)(h=this.runtime.getObjectTypeBySid(d.sm[u]))&&r.solModifiers.push(h);
for(l in d.sols)if(d.sols.hasOwnProperty(l)&&(h=this.runtime.getObjectTypeBySid(parseInt(l,10)))){k=d.sols[l];var c={sa:k.sa,insts:[]};u=0;for(e=k.insts.length;u<e;u++)(n=this.runtime.getObjectByUID(k.insts[u]))&&c.insts.push(n);r.sols[h.index.toString()]=c}this.waits.push(r)}}}};
(function(){function a(){}function b(a,c){a=a.extra.c2_feo_val;c=c.extra.c2_feo_val;if(cr.is_number(a)&&cr.is_number(c))return a-c;a=""+a;c=""+c;return a<c?-1:a>c?1:0}function e(a,c){q&&a===y&&c===z||(q=new RegExp(a,c),y=a,z=c);q.lastIndex=0;return q}function l(){}function h(){var a=C.length?C.pop():{sols:{},solModifiers:[]};a.deleteme=!1;return a}function n(){var a=v.length?v.pop():{insts:[]};a.sa=!1;return a}function g(a,c){var b=a[0]-c[0];return 0!==b?b:a[1]-c[1]}function d(a,c){return a[1]-c[1]}
function k(){}function u(a,c,b){if(a!==A||c!==B||b!==E){var d=e(c,b);t=a.match(d);A=a;B=c;E=b}}var r=cr.system_object.prototype;a.prototype.EveryTick=function(){return!0};a.prototype.OnLayoutStart=function(){return!0};a.prototype.OnLayoutEnd=function(){return!0};a.prototype.Compare=function(a,c,b){return cr.do_cmp(a,c,b)};a.prototype.CompareTime=function(a,c){var b=this.runtime.kahanTime.sum;return 0===a?(a=this.runtime.getCurrentCondition(),!a.extra.CompareTime_executed&&b>=c?a.extra.CompareTime_executed=
!0:!1):cr.do_cmp(b,a,c)};a.prototype.LayerVisible=function(a){return a?a.visible:!1};a.prototype.LayerEmpty=function(a){return a?!a.instances.length:!1};a.prototype.LayerCmpOpacity=function(a,c,b){return a?cr.do_cmp(100*a.opacity,c,b):!1};a.prototype.Repeat=function(a){var c=this.runtime.getCurrentEventStack(),b=c.current_event,d=c.isModifierAfterCnds();c=this.runtime.pushLoopStack();if(d)for(d=0;d<a&&!c.stopped;d++)this.runtime.pushCopySol(b.solModifiers),c.index=d,b.retrigger(),this.runtime.popSol(b.solModifiers);
else for(d=0;d<a&&!c.stopped;d++)c.index=d,b.retrigger();this.runtime.popLoopStack();return!1};a.prototype.While=function(a){var c=this.runtime.getCurrentEventStack();a=c.current_event;var b=c.isModifierAfterCnds();c=this.runtime.pushLoopStack();if(b)for(b=0;!c.stopped;b++)this.runtime.pushCopySol(a.solModifiers),c.index=b,a.retrigger()||(c.stopped=!0),this.runtime.popSol(a.solModifiers);else for(b=0;!c.stopped;b++)c.index=b,a.retrigger()||(c.stopped=!0);this.runtime.popLoopStack();return!1};a.prototype.For=
function(a,c,b){var d=this.runtime.getCurrentEventStack(),f=d.current_event;d=d.isModifierAfterCnds();a=this.runtime.pushLoopStack(a);if(b<c)if(d)for(;c>=b&&!a.stopped;--c)this.runtime.pushCopySol(f.solModifiers),a.index=c,f.retrigger(),this.runtime.popSol(f.solModifiers);else for(;c>=b&&!a.stopped;--c)a.index=c,f.retrigger();else if(d)for(;c<=b&&!a.stopped;++c)this.runtime.pushCopySol(f.solModifiers),a.index=c,f.retrigger(),this.runtime.popSol(f.solModifiers);else for(;c<=b&&!a.stopped;++c)a.index=
c,f.retrigger();this.runtime.popLoopStack();return!1};var c=[],f=-1;a.prototype.ForEach=function(a){var b=a.getCurrentSol();f++;c.length===f&&c.push([]);var d=c[f];cr.shallowAssignArray(d,b.getObjects());var e=this.runtime.getCurrentEventStack(),m=e.current_event,g=e.isModifierAfterCnds();e=this.runtime.pushLoopStack();var h,k,t=a.is_contained;if(g)for(g=0,h=d.length;g<h&&!e.stopped;g++){this.runtime.pushCopySol(m.solModifiers);var n=d[g];b=a.getCurrentSol();b.select_all=!1;cr.clearArray(b.instances);
b.instances[0]=n;if(t){var r=0;for(k=n.siblings.length;r<k;r++){var q=n.siblings[r];var l=q.type.getCurrentSol();l.select_all=!1;cr.clearArray(l.instances);l.instances[0]=q}}e.index=g;m.retrigger();this.runtime.popSol(m.solModifiers)}else for(b.select_all=!1,cr.clearArray(b.instances),g=0,h=d.length;g<h&&!e.stopped;g++){n=d[g];b.instances[0]=n;if(t)for(r=0,k=n.siblings.length;r<k;r++)q=n.siblings[r],l=q.type.getCurrentSol(),l.select_all=!1,cr.clearArray(l.instances),l.instances[0]=q;e.index=g;m.retrigger()}cr.clearArray(d);
this.runtime.popLoopStack();f--;return!1};a.prototype.ForEachOrdered=function(a,d,e){d=a.getCurrentSol();f++;c.length===f&&c.push([]);var m=c[f];cr.shallowAssignArray(m,d.getObjects());var p=this.runtime.getCurrentEventStack(),g=p.current_event,h=this.runtime.getCurrentCondition(),k=p.isModifierAfterCnds();p=this.runtime.pushLoopStack();var t;var n=0;for(t=m.length;n<t;n++)m[n].extra.c2_feo_val=h.parameters[1].get(n);m.sort(b);1===e&&m.reverse();e=a.is_contained;if(k)for(n=0,t=m.length;n<t&&!p.stopped;n++){this.runtime.pushCopySol(g.solModifiers);
var r=m[n];d=a.getCurrentSol();d.select_all=!1;cr.clearArray(d.instances);d.instances[0]=r;if(e)for(h=0,k=r.siblings.length;h<k;h++){var q=r.siblings[h];var l=q.type.getCurrentSol();l.select_all=!1;cr.clearArray(l.instances);l.instances[0]=q}p.index=n;g.retrigger();this.runtime.popSol(g.solModifiers)}else for(d.select_all=!1,cr.clearArray(d.instances),n=0,t=m.length;n<t&&!p.stopped;n++){r=m[n];d.instances[0]=r;if(e)for(h=0,k=r.siblings.length;h<k;h++)q=r.siblings[h],l=q.type.getCurrentSol(),l.select_all=
!1,cr.clearArray(l.instances),l.instances[0]=q;p.index=n;g.retrigger()}cr.clearArray(m);this.runtime.popLoopStack();f--;return!1};a.prototype.PickByComparison=function(a,b,d,e){var m,p;if(a){f++;c.length===f&&c.push([]);var g=c[f],h=a.getCurrentSol();cr.shallowAssignArray(g,h.getObjects());h.select_all&&cr.clearArray(h.else_instances);var k=this.runtime.getCurrentCondition();var t=m=0;for(p=g.length;m<p;m++){var n=g[m];g[t]=n;b=k.parameters[1].get(m);e=k.parameters[3].get(m);cr.do_cmp(b,d,e)?t++:
h.else_instances.push(n)}cr.truncateArray(g,t);h.select_all=!1;cr.shallowAssignArray(h.instances,g);cr.clearArray(g);f--;a.applySolToContainer();return!!h.instances.length}};a.prototype.PickByEvaluate=function(a,b){var d,e;if(a){f++;c.length===f&&c.push([]);var m=c[f],p=a.getCurrentSol();cr.shallowAssignArray(m,p.getObjects());p.select_all&&cr.clearArray(p.else_instances);var g=this.runtime.getCurrentCondition();var h=d=0;for(e=m.length;d<e;d++){var k=m[d];m[h]=k;(b=g.parameters[1].get(d))?h++:p.else_instances.push(k)}cr.truncateArray(m,
h);p.select_all=!1;cr.shallowAssignArray(p.instances,m);cr.clearArray(m);f--;a.applySolToContainer();return!!p.instances.length}};a.prototype.TriggerOnce=function(){var a=this.runtime.getCurrentCondition().extra;"undefined"===typeof a.TriggerOnce_lastTick&&(a.TriggerOnce_lastTick=-1);var c=a.TriggerOnce_lastTick,b=this.runtime.tickcount;a.TriggerOnce_lastTick=b;return this.runtime.layout_first_tick||c!==b-1};a.prototype.Every=function(a){var c=this.runtime.getCurrentCondition(),b=c.extra.Every_lastTime||
0,d=this.runtime.kahanTime.sum;"undefined"===typeof c.extra.Every_seconds&&(c.extra.Every_seconds=a);var f=c.extra.Every_seconds;if(d>=b+f)return c.extra.Every_lastTime=b+f,d>=c.extra.Every_lastTime+.04&&(c.extra.Every_lastTime=d),c.extra.Every_seconds=a,!0;d<b-.1&&(c.extra.Every_lastTime=d);return!1};a.prototype.PickNth=function(a,c){if(!a)return!1;var b=a.getCurrentSol(),d=b.getObjects();c=cr.floor(c);if(0>c||c>=d.length)return!1;b.pick_one(d[c]);a.applySolToContainer();return!0};a.prototype.PickRandom=
function(a){if(!a)return!1;var c=a.getCurrentSol(),b=c.getObjects(),d=cr.floor(Math.random()*b.length);if(d>=b.length)return!1;c.pick_one(b[d]);a.applySolToContainer();return!0};a.prototype.CompareVar=function(a,c,b){return cr.do_cmp(a.getValue(),c,b)};a.prototype.IsGroupActive=function(a){return(a=this.runtime.groups_by_name[a.toLowerCase()])&&a.group_active};a.prototype.IsPreview=function(){return"undefined"!==typeof cr_is_preview};a.prototype.PickAll=function(a){if(!a||!a.instances.length)return!1;
a.getCurrentSol().select_all=!0;a.applySolToContainer();return!0};a.prototype.IsMobile=function(){return this.runtime.isMobile};a.prototype.CompareBetween=function(a,c,b){return a>=c&&a<=b};a.prototype.Else=function(){var a=this.runtime.getCurrentEventStack();return a.else_branch_ran?!1:!a.last_event_true};a.prototype.OnLoadFinished=function(){return!0};a.prototype.OnCanvasSnapshot=function(){return!0};a.prototype.EffectsSupported=function(){return!!this.runtime.glwrap};a.prototype.OnSaveComplete=
function(){return!0};a.prototype.OnSaveFailed=function(){return!0};a.prototype.OnLoadComplete=function(){return!0};a.prototype.OnLoadFailed=function(){return!0};a.prototype.ObjectUIDExists=function(a){return!!this.runtime.getObjectByUID(a)};a.prototype.IsOnPlatform=function(a){var c=this.runtime;switch(a){case 0:return!c.isDomFree&&!c.isNodeWebkit&&!c.isCordova&&!c.isWinJS&&!c.isWindowsPhone8&&!c.isBlackberry10&&!c.isAmazonWebApp;case 1:return c.isiOS;case 2:return c.isAndroid;case 3:return c.isWindows8App;
case 4:return c.isWindowsPhone8;case 5:return c.isBlackberry10;case 6:return c.isTizen;case 7:return c.isCocoonJs;case 8:return c.isCordova;case 9:return c.isArcade;case 10:return c.isNodeWebkit;case 11:return c.isCrosswalk;case 12:return c.isAmazonWebApp;case 13:return c.isWindows10;default:return!1}};var q=null,y="",z="";a.prototype.RegexTest=function(a,c,b){return e(c,b).test(a)};var x=[];a.prototype.PickOverlappingPoint=function(a,c,b){if(!a)return!1;var d=a.getCurrentSol(),f=d.getObjects(),e=
this.runtime.getCurrentEventStack().current_event.orblock,m=this.runtime.getCurrentCondition(),p;d.select_all?(cr.shallowAssignArray(x,f),cr.clearArray(d.else_instances),d.select_all=!1,cr.clearArray(d.instances)):e?(cr.shallowAssignArray(x,d.else_instances),cr.clearArray(d.else_instances)):(cr.shallowAssignArray(x,f),cr.clearArray(d.instances));f=0;for(e=x.length;f<e;++f){var g=x[f];g.update_bbox();(p=cr.xor(g.contains_pt(c,b),m.inverted))?d.instances.push(g):d.else_instances.push(g)}a.applySolToContainer();
return cr.xor(!!d.instances.length,m.inverted)};a.prototype.IsNaN=function(a){return!!isNaN(a)};a.prototype.AngleWithin=function(a,c,b){return cr.angleDiff(cr.to_radians(a),cr.to_radians(b))<=cr.to_radians(c)};a.prototype.IsClockwiseFrom=function(a,c){return cr.angleClockwise(cr.to_radians(a),cr.to_radians(c))};a.prototype.IsBetweenAngles=function(a,c,b){a=cr.to_clamped_radians(a);c=cr.to_clamped_radians(c);b=cr.to_clamped_radians(b);return cr.angleClockwise(b,c)?cr.angleClockwise(a,c)&&!cr.angleClockwise(a,
b):!(!cr.angleClockwise(a,c)&&cr.angleClockwise(a,b))};a.prototype.IsValueType=function(a,c){return"number"===typeof a?0===c:1===c};r.cnds=new a;l.prototype.GoToLayout=function(a){this.runtime.isloading||this.runtime.changelayout||(this.runtime.changelayout=a)};l.prototype.NextPrevLayout=function(a){if(!this.runtime.isloading&&!this.runtime.changelayout){var c=this.runtime.layouts_by_index.indexOf(this.runtime.running_layout);if(!a||0!==c)if(a||c!==this.runtime.layouts_by_index.length-1)this.runtime.changelayout=
this.runtime.layouts_by_index[c+(a?-1:1)]}};l.prototype.CreateObject=function(a,c,b,d){if(c&&a&&(c=this.runtime.createInstance(a,c,b,d))){this.runtime.isInOnDestroy++;this.runtime.trigger(Object.getPrototypeOf(a.plugin).cnds.OnCreated,c);if(c.is_contained)for(b=0,d=c.siblings.length;b<d;b++){var f=c.siblings[b];this.runtime.trigger(Object.getPrototypeOf(f.type.plugin).cnds.OnCreated,f)}this.runtime.isInOnDestroy--;a=a.getCurrentSol();a.select_all=!1;cr.clearArray(a.instances);a.instances[0]=c;if(c.is_contained)for(b=
0,d=c.siblings.length;b<d;b++)f=c.siblings[b],a=f.type.getCurrentSol(),a.select_all=!1,cr.clearArray(a.instances),a.instances[0]=f}};l.prototype.SetLayerVisible=function(a,c){a&&a.visible!==c&&(a.visible=c,this.runtime.redraw=!0)};l.prototype.SetLayerOpacity=function(a,c){a&&(c=cr.clamp(c/100,0,1),a.opacity!==c&&(a.opacity=c,this.runtime.redraw=!0))};l.prototype.SetLayerScaleRate=function(a,c){a&&a.zoomRate!==c&&(a.zoomRate=c,this.runtime.redraw=!0)};l.prototype.SetLayerForceOwnTexture=function(a,
c){a&&(c=!!c,a.forceOwnTexture!==c&&(a.forceOwnTexture=c,this.runtime.redraw=!0))};l.prototype.SetLayoutScale=function(a){this.runtime.running_layout&&this.runtime.running_layout.scale!==a&&(this.runtime.running_layout.scale=a,this.runtime.running_layout.boundScrolling(),this.runtime.redraw=!0)};l.prototype.ScrollX=function(a){this.runtime.running_layout.scrollToX(a)};l.prototype.ScrollY=function(a){this.runtime.running_layout.scrollToY(a)};l.prototype.Scroll=function(a,c){this.runtime.running_layout.scrollToX(a);
this.runtime.running_layout.scrollToY(c)};l.prototype.ScrollToObject=function(a){if(a=a.getFirstPicked())this.runtime.running_layout.scrollToX(a.x),this.runtime.running_layout.scrollToY(a.y)};l.prototype.SetVar=function(a,c){0===a.vartype?cr.is_number(c)?a.setValue(c):a.setValue(parseFloat(c)):1===a.vartype&&a.setValue(c.toString())};l.prototype.AddVar=function(a,c){0===a.vartype?cr.is_number(c)?a.setValue(a.getValue()+c):a.setValue(a.getValue()+parseFloat(c)):1===a.vartype&&a.setValue(a.getValue()+
c.toString())};l.prototype.SubVar=function(a,c){0===a.vartype&&(cr.is_number(c)?a.setValue(a.getValue()-c):a.setValue(a.getValue()-parseFloat(c)))};l.prototype.SetGroupActive=function(a,c){if(a=this.runtime.groups_by_name[a.toLowerCase()])switch(c){case 0:a.setGroupActive(!1);break;case 1:a.setGroupActive(!0);break;case 2:a.setGroupActive(!a.group_active)}};l.prototype.SetTimescale=function(a){0>a&&(a=0);this.runtime.timescale=a};l.prototype.SetObjectTimescale=function(a,c){0>c&&(c=0);if(a){a=a.getCurrentSol().getObjects();
var b;var d=0;for(b=a.length;d<b;d++)a[d].my_timescale=c}};l.prototype.RestoreObjectTimescale=function(a){if(!a)return!1;a=a.getCurrentSol().getObjects();var c;var b=0;for(c=a.length;b<c;b++)a[b].my_timescale=-1};var C=[],v=[];l.prototype.Wait=function(a){if(!(0>a)){var c,b=this.runtime.getCurrentEventStack(),d=h();d.time=this.runtime.kahanTime.sum+a;d.signaltag="";d.signalled=!1;d.ev=b.current_event;d.actindex=b.actindex+1;a=0;for(c=this.runtime.types_by_index.length;a<c;a++){var f=this.runtime.types_by_index[a];
var e=f.getCurrentSol();e.select_all&&-1===b.current_event.solModifiers.indexOf(f)||(d.solModifiers.push(f),f=n(),f.sa=e.select_all,cr.shallowAssignArray(f.insts,e.instances),d.sols[a.toString()]=f)}this.waits.push(d);return!0}};l.prototype.WaitForSignal=function(a){var c,b=this.runtime.getCurrentEventStack(),d=h();d.time=-1;d.signaltag=a.toLowerCase();d.signalled=!1;d.ev=b.current_event;d.actindex=b.actindex+1;a=0;for(c=this.runtime.types_by_index.length;a<c;a++){var f=this.runtime.types_by_index[a];
var e=f.getCurrentSol();e.select_all&&-1===b.current_event.solModifiers.indexOf(f)||(d.solModifiers.push(f),f=n(),f.sa=e.select_all,cr.shallowAssignArray(f.insts,e.instances),d.sols[a.toString()]=f)}this.waits.push(d);return!0};l.prototype.Signal=function(a){a=a.toLowerCase();var c;var b=0;for(c=this.waits.length;b<c;++b){var d=this.waits[b];-1===d.time&&d.signaltag===a&&(d.signalled=!0)}};l.prototype.SetLayerScale=function(a,c){a&&a.scale!==c&&(a.scale=c,this.runtime.redraw=!0)};l.prototype.ResetGlobals=
function(){var a;var c=0;for(a=this.runtime.all_global_vars.length;c<a;c++){var b=this.runtime.all_global_vars[c];b.data=b.initial}};l.prototype.SetLayoutAngle=function(a){a=cr.to_radians(a);a=cr.clamp_angle(a);this.runtime.running_layout&&this.runtime.running_layout.angle!==a&&(this.runtime.running_layout.angle=a,this.runtime.redraw=!0)};l.prototype.SetLayerAngle=function(a,c){a&&(c=cr.to_radians(c),c=cr.clamp_angle(c),a.angle!==c&&(a.angle=c,this.runtime.redraw=!0))};l.prototype.SetLayerParallax=
function(a,c,b){if(a&&(a.parallaxX!==c/100||a.parallaxY!==b/100)){a.parallaxX=c/100;a.parallaxY=b/100;if(1!==a.parallaxX||1!==a.parallaxY)for(b=a.instances,a=0,c=b.length;a<c;++a)b[a].type.any_instance_parallaxed=!0;this.runtime.redraw=!0}};l.prototype.SetLayerBackground=function(a,c){if(a){var b=cr.GetRValue(c),d=cr.GetGValue(c);c=cr.GetBValue(c);if(a.background_color[0]!==b||a.background_color[1]!==d||a.background_color[2]!==c)a.background_color[0]=b,a.background_color[1]=d,a.background_color[2]=
c,this.runtime.redraw=!0}};l.prototype.SetLayerTransparent=function(a,c){a&&!!c!==!!a.transparent&&(a.transparent=!!c,this.runtime.redraw=!0)};l.prototype.SetLayerBlendMode=function(a,c){a&&a.blend_mode!==c&&(a.blend_mode=c,a.compositeOp=cr.effectToCompositeOp(a.blend_mode),this.runtime.gl&&cr.setGLBlend(a,a.blend_mode,this.runtime.gl),this.runtime.redraw=!0)};l.prototype.StopLoop=function(){0>this.runtime.loop_stack_index||(this.runtime.getCurrentLoop().stopped=!0)};l.prototype.GoToLayoutByName=
function(a){if(!this.runtime.isloading&&!this.runtime.changelayout)for(var c in this.runtime.layouts)if(this.runtime.layouts.hasOwnProperty(c)&&cr.equals_nocase(c,a)){this.runtime.changelayout=this.runtime.layouts[c];break}};l.prototype.RestartLayout=function(a){if(!this.runtime.isloading&&!this.runtime.changelayout&&this.runtime.running_layout){this.runtime.changelayout=this.runtime.running_layout;var c;a=0;for(c=this.runtime.allGroups.length;a<c;a++){var b=this.runtime.allGroups[a];b.setGroupActive(b.initially_activated)}}};
l.prototype.SnapshotCanvas=function(a,c){this.runtime.doCanvasSnapshot(0===a?"image/png":"image/jpeg",c/100)};l.prototype.SetCanvasSize=function(a,c){if(!(0>=a||0>=c)){var b=this.runtime.fullscreen_mode;(document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement||document.fullScreen||this.runtime.isNodeFullscreen)&&0<this.runtime.fullscreen_scaling&&(b=this.runtime.fullscreen_scaling);0===b?this.runtime.setSize(a,c,!0):(this.runtime.original_width=a,this.runtime.original_height=
c,this.runtime.setSize(this.runtime.lastWindowWidth,this.runtime.lastWindowHeight,!0))}};l.prototype.SetLayoutEffectEnabled=function(a,c){this.runtime.running_layout&&this.runtime.glwrap&&(c=this.runtime.running_layout.getEffectByName(c))&&(a=1===a,c.active!=a&&(c.active=a,this.runtime.running_layout.updateActiveEffects(),this.runtime.redraw=!0))};l.prototype.SetLayerEffectEnabled=function(a,c,b){a&&this.runtime.glwrap&&(b=a.getEffectByName(b))&&(c=1===c,b.active!=c&&(b.active=c,a.updateActiveEffects(),
this.runtime.redraw=!0))};l.prototype.SetLayoutEffectParam=function(a,c,b){if(this.runtime.running_layout&&this.runtime.glwrap&&(a=this.runtime.running_layout.getEffectByName(a))){var d=this.runtime.running_layout.effect_params[a.index];c=Math.floor(c);0>c||c>=d.length||(1===this.runtime.glwrap.getProgramParameterType(a.shaderindex,c)&&(b/=100),d[c]!==b&&(d[c]=b,a.active&&(this.runtime.redraw=!0)))}};l.prototype.SetLayerEffectParam=function(a,c,b,d){a&&this.runtime.glwrap&&(c=a.getEffectByName(c))&&
(a=a.effect_params[c.index],b=Math.floor(b),0>b||b>=a.length||(1===this.runtime.glwrap.getProgramParameterType(c.shaderindex,b)&&(d/=100),a[b]!==d&&(a[b]=d,c.active&&(this.runtime.redraw=!0))))};l.prototype.SaveState=function(a){this.runtime.saveToSlot=a};l.prototype.LoadState=function(a){this.runtime.loadFromSlot=a};l.prototype.LoadStateJSON=function(a){this.runtime.loadFromJson=a};l.prototype.SetHalfFramerateMode=function(a){this.runtime.halfFramerateMode=0!==a};l.prototype.SetFullscreenQuality=
function(a){if(document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement||document.fullScreen||this.isNodeFullscreen||0!==this.runtime.fullscreen_mode)this.runtime.wantFullscreenScalingQuality=0!==a,this.runtime.setSize(this.runtime.lastWindowWidth,this.runtime.lastWindowHeight,!0)};l.prototype.ResetPersisted=function(){var a;var c=0;for(a=this.runtime.layouts_by_index.length;c<a;++c)this.runtime.layouts_by_index[c].persist_data={},this.runtime.layouts_by_index[c].first_visit=
!0};l.prototype.RecreateInitialObjects=function(a,c,b,d,f){a&&this.runtime.running_layout.recreateInitialObjects(a,c,b,d,f)};l.prototype.SetPixelRounding=function(a){this.runtime.pixel_rounding=0!==a;this.runtime.redraw=!0};l.prototype.SetMinimumFramerate=function(a){1>a&&(a=1);120<a&&(a=120);this.runtime.minimumFramerate=a};l.prototype.SortZOrderByInstVar=function(a,c){if(a){var b;var f=a.getCurrentSol().getObjects();var e=[],m=[],h=this.runtime.running_layout,p=a.is_family,k=a.family_index;a=0;
for(b=f.length;a<b;++a){var t=f[a];if(t.layer){var n=p?t.instance_vars[c+t.type.family_var_map[k]]:t.instance_vars[c];e.push([t.layer.index,t.get_zindex()]);m.push([t,n])}}if(e.length)for(e.sort(g),m.sort(d),a=0,b=e.length;a<b;++a)t=m[a][0],c=h.layers[e[a][0]],f=e[a][1],c.instances[f]!==t&&(c.instances[f]=t,t.layer=c,c.setZIndicesStaleFrom(f))}};r.acts=new l;k.prototype["int"]=function(a,c){cr.is_string(c)?(a.set_int(parseInt(c,10)),isNaN(a.data)&&(a.data=0)):a.set_int(c)};k.prototype["float"]=function(a,
c){cr.is_string(c)?(a.set_float(parseFloat(c)),isNaN(a.data)&&(a.data=0)):a.set_float(c)};k.prototype.str=function(a,c){cr.is_string(c)?a.set_string(c):a.set_string(c.toString())};k.prototype.len=function(a,c){a.set_int(c.length||0)};k.prototype.random=function(a,c,b){void 0===b?a.set_float(Math.random()*c):a.set_float(Math.random()*(b-c)+c)};k.prototype.sqrt=function(a,c){a.set_float(Math.sqrt(c))};k.prototype.abs=function(a,c){a.set_float(Math.abs(c))};k.prototype.round=function(a,c){a.set_int(Math.round(c))};
k.prototype.floor=function(a,c){a.set_int(Math.floor(c))};k.prototype.ceil=function(a,c){a.set_int(Math.ceil(c))};k.prototype.sin=function(a,c){a.set_float(Math.sin(cr.to_radians(c)))};k.prototype.cos=function(a,c){a.set_float(Math.cos(cr.to_radians(c)))};k.prototype.tan=function(a,c){a.set_float(Math.tan(cr.to_radians(c)))};k.prototype.asin=function(a,c){a.set_float(cr.to_degrees(Math.asin(c)))};k.prototype.acos=function(a,c){a.set_float(cr.to_degrees(Math.acos(c)))};k.prototype.atan=function(a,
c){a.set_float(cr.to_degrees(Math.atan(c)))};k.prototype.exp=function(a,c){a.set_float(Math.exp(c))};k.prototype.ln=function(a,c){a.set_float(Math.log(c))};k.prototype.log10=function(a,c){a.set_float(Math.log(c)/Math.LN10)};k.prototype.max=function(a){var c=arguments[1];"number"!==typeof c&&(c=0);var b;var d=2;for(b=arguments.length;d<b;d++){var f=arguments[d];"number"===typeof f&&c<f&&(c=f)}a.set_float(c)};k.prototype.min=function(a){var c=arguments[1];"number"!==typeof c&&(c=0);var b;var d=2;for(b=
arguments.length;d<b;d++){var f=arguments[d];"number"===typeof f&&c>f&&(c=f)}a.set_float(c)};k.prototype.dt=function(a){a.set_float(this.runtime.dt)};k.prototype.timescale=function(a){a.set_float(this.runtime.timescale)};k.prototype.wallclocktime=function(a){a.set_float((Date.now()-this.runtime.start_time)/1E3)};k.prototype.time=function(a){a.set_float(this.runtime.kahanTime.sum)};k.prototype.tickcount=function(a){a.set_int(this.runtime.tickcount)};k.prototype.objectcount=function(a){a.set_int(this.runtime.objectcount)};
k.prototype.fps=function(a){a.set_int(this.runtime.fps)};k.prototype.loopindex=function(a,c){var b;if(this.runtime.loop_stack.length)if(c){for(b=this.runtime.loop_stack_index;0<=b;--b){var d=this.runtime.loop_stack[b];if(d.name===c){a.set_int(d.index);return}}a.set_int(0)}else d=this.runtime.getCurrentLoop(),a.set_int(d?d.index:-1);else a.set_int(0)};k.prototype.distance=function(a,c,b,d,f){a.set_float(cr.distanceTo(c,b,d,f))};k.prototype.angle=function(a,c,b,d,f){a.set_float(cr.to_degrees(cr.angleTo(c,
b,d,f)))};k.prototype.scrollx=function(a){a.set_float(this.runtime.running_layout.scrollX)};k.prototype.scrolly=function(a){a.set_float(this.runtime.running_layout.scrollY)};k.prototype.newline=function(a){a.set_string("\n")};k.prototype.lerp=function(a,c,b,d){a.set_float(cr.lerp(c,b,d))};k.prototype.qarp=function(a,c,b,d,f){a.set_float(cr.qarp(c,b,d,f))};k.prototype.cubic=function(a,c,b,d,f,e){a.set_float(cr.cubic(c,b,d,f,e))};k.prototype.cosp=function(a,c,b,d){a.set_float(cr.cosp(c,b,d))};k.prototype.windowwidth=
function(a){a.set_int(this.runtime.width)};k.prototype.windowheight=function(a){a.set_int(this.runtime.height)};k.prototype.uppercase=function(a,c){a.set_string(cr.is_string(c)?c.toUpperCase():"")};k.prototype.lowercase=function(a,c){a.set_string(cr.is_string(c)?c.toLowerCase():"")};k.prototype.clamp=function(a,c,b,d){c<b?a.set_float(b):c>d?a.set_float(d):a.set_float(c)};k.prototype.layerscale=function(a,c){(c=this.runtime.getLayer(c))?a.set_float(c.scale):a.set_float(0)};k.prototype.layeropacity=
function(a,c){(c=this.runtime.getLayer(c))?a.set_float(100*c.opacity):a.set_float(0)};k.prototype.layerscalerate=function(a,c){(c=this.runtime.getLayer(c))?a.set_float(c.zoomRate):a.set_float(0)};k.prototype.layerparallaxx=function(a,c){(c=this.runtime.getLayer(c))?a.set_float(100*c.parallaxX):a.set_float(0)};k.prototype.layerparallaxy=function(a,c){(c=this.runtime.getLayer(c))?a.set_float(100*c.parallaxY):a.set_float(0)};k.prototype.layerindex=function(a,c){(c=this.runtime.getLayer(c))?a.set_int(c.index):
a.set_int(-1)};k.prototype.layoutscale=function(a){this.runtime.running_layout?a.set_float(this.runtime.running_layout.scale):a.set_float(0)};k.prototype.layoutangle=function(a){a.set_float(cr.to_degrees(this.runtime.running_layout.angle))};k.prototype.layerangle=function(a,c){(c=this.runtime.getLayer(c))?a.set_float(cr.to_degrees(c.angle)):a.set_float(0)};k.prototype.layoutwidth=function(a){a.set_int(this.runtime.running_layout.width)};k.prototype.layoutheight=function(a){a.set_int(this.runtime.running_layout.height)};
k.prototype.find=function(a,c,b){cr.is_string(c)&&cr.is_string(b)?a.set_int(c.search(new RegExp(cr.regexp_escape(b),"i"))):a.set_int(-1)};k.prototype.findcase=function(a,c,b){cr.is_string(c)&&cr.is_string(b)?a.set_int(c.search(new RegExp(cr.regexp_escape(b),""))):a.set_int(-1)};k.prototype.left=function(a,c,b){a.set_string(cr.is_string(c)?c.substr(0,b):"")};k.prototype.right=function(a,c,b){a.set_string(cr.is_string(c)?c.substr(c.length-b):"")};k.prototype.mid=function(a,c,b,d){a.set_string(cr.is_string(c)?
c.substr(b,d):"")};k.prototype.tokenat=function(a,c,b,d){cr.is_string(c)&&cr.is_string(d)?(c=c.split(d),b=cr.floor(b),0>b||b>=c.length?a.set_string(""):a.set_string(c[b])):a.set_string("")};k.prototype.tokencount=function(a,c,b){cr.is_string(c)&&c.length?a.set_int(c.split(b).length):a.set_int(0)};k.prototype.replace=function(a,c,b,d){cr.is_string(c)&&cr.is_string(b)&&cr.is_string(d)?a.set_string(c.replace(new RegExp(cr.regexp_escape(b),"gi"),d)):a.set_string(cr.is_string(c)?c:"")};k.prototype.trim=
function(a,c){a.set_string(cr.is_string(c)?c.trim():"")};k.prototype.pi=function(a){a.set_float(cr.PI)};k.prototype.layoutname=function(a){this.runtime.running_layout?a.set_string(this.runtime.running_layout.name):a.set_string("")};k.prototype.renderer=function(a){a.set_string(this.runtime.gl?"webgl":"canvas2d")};k.prototype.rendererdetail=function(a){a.set_string(this.runtime.glUnmaskedRenderer)};k.prototype.anglediff=function(a,c,b){a.set_float(cr.to_degrees(cr.angleDiff(cr.to_radians(c),cr.to_radians(b))))};
k.prototype.choose=function(a){var c=cr.floor(Math.random()*(arguments.length-1));a.set_any(arguments[c+1])};k.prototype.rgb=function(a,c,b,d){a.set_int(cr.RGB(c,b,d))};k.prototype.projectversion=function(a){a.set_string(this.runtime.versionstr)};k.prototype.projectname=function(a){a.set_string(this.runtime.projectName)};k.prototype.anglelerp=function(a,c,b,d){c=cr.to_radians(c);b=cr.to_radians(b);var f=cr.angleDiff(c,b);cr.angleClockwise(b,c)?a.set_float(cr.to_clamped_degrees(c+f*d)):a.set_float(cr.to_clamped_degrees(c-
f*d))};k.prototype.anglerotate=function(a,c,b,d){c=cr.to_radians(c);b=cr.to_radians(b);d=cr.to_radians(d);a.set_float(cr.to_clamped_degrees(cr.angleRotate(c,b,d)))};k.prototype.zeropad=function(a,c,b){var d=0>c?"-":"";0>c&&(c=-c);b-=c.toString().length;for(var f=0;f<b;f++)d+="0";a.set_string(d+c.toString())};k.prototype.cpuutilisation=function(a){a.set_float(this.runtime.cpuutilisation/1E3)};k.prototype.viewportleft=function(a,c){c=this.runtime.getLayer(c);a.set_float(c?c.viewLeft:0)};k.prototype.viewporttop=
function(a,c){c=this.runtime.getLayer(c);a.set_float(c?c.viewTop:0)};k.prototype.viewportright=function(a,c){c=this.runtime.getLayer(c);a.set_float(c?c.viewRight:0)};k.prototype.viewportbottom=function(a,c){c=this.runtime.getLayer(c);a.set_float(c?c.viewBottom:0)};k.prototype.loadingprogress=function(a){a.set_float(this.runtime.loadingprogress)};k.prototype.unlerp=function(a,c,b,d){a.set_float(cr.unlerp(c,b,d))};k.prototype.canvassnapshot=function(a){a.set_string(this.runtime.snapshotData)};k.prototype.urlencode=
function(a,c){a.set_string(encodeURIComponent(c))};k.prototype.urldecode=function(a,c){a.set_string(decodeURIComponent(c))};k.prototype.canvastolayerx=function(a,c,b,d){c=this.runtime.getLayer(c);a.set_float(c?c.canvasToLayer(b,d,!0):0)};k.prototype.canvastolayery=function(a,c,b,d){c=this.runtime.getLayer(c);a.set_float(c?c.canvasToLayer(b,d,!1):0)};k.prototype.layertocanvasx=function(a,c,b,d){c=this.runtime.getLayer(c);a.set_float(c?c.layerToCanvas(b,d,!0):0)};k.prototype.layertocanvasy=function(a,
c,b,d){c=this.runtime.getLayer(c);a.set_float(c?c.layerToCanvas(b,d,!1):0)};k.prototype.savestatejson=function(a){a.set_string(this.runtime.lastSaveJson)};k.prototype.imagememoryusage=function(a){this.runtime.glwrap?a.set_float(Math.round(100*this.runtime.glwrap.estimateVRAM()/1048576)/100):a.set_float(0)};k.prototype.regexsearch=function(a,c,b,d){b=e(b,d);a.set_int(c?c.search(b):-1)};k.prototype.regexreplace=function(a,c,b,d,f){b=e(b,d);a.set_string(c?c.replace(b,f):"")};var t=[],A="",B="",E="";
k.prototype.regexmatchcount=function(a,c,b,d){e(b,d);u(c.toString(),b,d);a.set_int(t?t.length:0)};k.prototype.regexmatchat=function(a,c,b,d,f){f=Math.floor(f);e(b,d);u(c.toString(),b,d);!t||0>f||f>=t.length?a.set_string(""):a.set_string(t[f])};k.prototype.infinity=function(a){a.set_float(Infinity)};k.prototype.setbit=function(a,c,b,d){b|=0;a.set_int((c|0)&~(1<<b)|(0!==d?1:0)<<b)};k.prototype.togglebit=function(a,c,b){a.set_int((c|0)^1<<(b|0))};k.prototype.getbit=function(a,c,b){a.set_int((c|0)&1<<
(b|0)?1:0)};k.prototype.originalwindowwidth=function(a){a.set_int(this.runtime.original_width)};k.prototype.originalwindowheight=function(a){a.set_int(this.runtime.original_height)};r.exps=new k;r.runWaits=function(){var a,c=this.runtime.getCurrentEventStack();var b=0;for(a=this.waits.length;b<a;b++){var d=this.waits[b];if(-1===d.time){if(!d.signalled)continue}else if(d.time>this.runtime.kahanTime.sum)continue;c.current_event=d.ev;c.actindex=d.actindex;c.cndindex=0;for(g in d.sols)if(d.sols.hasOwnProperty(g)){var f=
this.runtime.types_by_index[parseInt(g,10)].getCurrentSol();var e=d.sols[g];f.select_all=e.sa;cr.shallowAssignArray(f.instances,e.insts);f=e;cr.clearArray(f.insts);v.push(f)}d.ev.resume_actions_and_subevents();this.runtime.clearSol(d.solModifiers);d.deleteme=!0}var g=b=0;for(a=this.waits.length;b<a;b++)d=this.waits[b],this.waits[g]=d,d.deleteme?(cr.wipe(d.sols),cr.clearArray(d.solModifiers),C.push(d)):g++;cr.truncateArray(this.waits,g)}})();
(function(){cr.add_common_aces=function(a,e){var b=a[1],h=a[3],n=a[4],g=a[5],d=a[6],k=a[7];a=a[8];e.cnds||(e.cnds={});e.acts||(e.acts={});e.exps||(e.exps={});var u=e.cnds,r=e.acts;e=e.exps;h&&(u.CompareX=function(a,b){return cr.do_cmp(this.x,a,b)},u.CompareY=function(a,b){return cr.do_cmp(this.y,a,b)},u.IsOnScreen=function(){var a=this.layer;this.update_bbox();var b=this.bbox;return!(b.right<a.viewLeft||b.bottom<a.viewTop||b.left>a.viewRight||b.top>a.viewBottom)},u.IsOutsideLayout=function(){this.update_bbox();
var a=this.bbox,b=this.runtime.running_layout;return 0>a.right||0>a.bottom||a.left>b.width||a.top>b.height},u.PickDistance=function(a,b,d){var c=this.getCurrentSol(),f=c.getObjects();if(!f.length)return!1;var e=f[0],g=e,h=cr.distanceTo(e.x,e.y,b,d),k;var n=1;for(k=f.length;n<k;n++){e=f[n];var r=cr.distanceTo(e.x,e.y,b,d);if(0===a&&r<h||1===a&&r>h)h=r,g=e}c.pick_one(g);return!0},r.SetX=function(a){this.x!==a&&(this.x=a,this.set_bbox_changed())},r.SetY=function(a){this.y!==a&&(this.y=a,this.set_bbox_changed())},
r.SetPos=function(a,b){if(this.x!==a||this.y!==b)this.x=a,this.y=b,this.set_bbox_changed()},r.SetPosToObject=function(a,b){var c=a.getPairedInstance(this);c&&(c.getImagePoint?(a=c.getImagePoint(b,!0),b=c.getImagePoint(b,!1)):(a=c.x,b=c.y),this.x!==a||this.y!==b)&&(this.x=a,this.y=b,this.set_bbox_changed())},r.MoveForward=function(a){0!==a&&(this.x+=Math.cos(this.angle)*a,this.y+=Math.sin(this.angle)*a,this.set_bbox_changed())},r.MoveAtAngle=function(a,b){0!==b&&(this.x+=Math.cos(cr.to_radians(a))*
b,this.y+=Math.sin(cr.to_radians(a))*b,this.set_bbox_changed())},e.X=function(a){a.set_float(this.x)},e.Y=function(a){a.set_float(this.y)},e.dt=function(a){a.set_float(this.runtime.getDt(this))});n&&(u.CompareWidth=function(a,b){return cr.do_cmp(this.width,a,b)},u.CompareHeight=function(a,b){return cr.do_cmp(this.height,a,b)},r.SetWidth=function(a){this.width!==a&&(this.width=a,this.set_bbox_changed())},r.SetHeight=function(a){this.height!==a&&(this.height=a,this.set_bbox_changed())},r.SetSize=function(a,
b){if(this.width!==a||this.height!==b)this.width=a,this.height=b,this.set_bbox_changed()},e.Width=function(a){a.set_float(this.width)},e.Height=function(a){a.set_float(this.height)},e.BBoxLeft=function(a){this.update_bbox();a.set_float(this.bbox.left)},e.BBoxTop=function(a){this.update_bbox();a.set_float(this.bbox.top)},e.BBoxRight=function(a){this.update_bbox();a.set_float(this.bbox.right)},e.BBoxBottom=function(a){this.update_bbox();a.set_float(this.bbox.bottom)});g&&(u.AngleWithin=function(a,b){return cr.angleDiff(this.angle,
cr.to_radians(b))<=cr.to_radians(a)},u.IsClockwiseFrom=function(a){return cr.angleClockwise(this.angle,cr.to_radians(a))},u.IsBetweenAngles=function(a,b){a=cr.to_clamped_radians(a);b=cr.to_clamped_radians(b);var c=cr.clamp_angle(this.angle);return cr.angleClockwise(b,a)?cr.angleClockwise(c,a)&&!cr.angleClockwise(c,b):!(!cr.angleClockwise(c,a)&&cr.angleClockwise(c,b))},r.SetAngle=function(a){a=cr.to_radians(cr.clamp_angle_degrees(a));isNaN(a)||this.angle===a||(this.angle=a,this.set_bbox_changed())},
r.RotateClockwise=function(a){0===a||isNaN(a)||(this.angle+=cr.to_radians(a),this.angle=cr.clamp_angle(this.angle),this.set_bbox_changed())},r.RotateCounterclockwise=function(a){0===a||isNaN(a)||(this.angle-=cr.to_radians(a),this.angle=cr.clamp_angle(this.angle),this.set_bbox_changed())},r.RotateTowardAngle=function(a,b){a=cr.angleRotate(this.angle,cr.to_radians(b),cr.to_radians(a));isNaN(a)||this.angle===a||(this.angle=a,this.set_bbox_changed())},r.RotateTowardPosition=function(a,b,d){a=cr.angleRotate(this.angle,
Math.atan2(d-this.y,b-this.x),cr.to_radians(a));isNaN(a)||this.angle===a||(this.angle=a,this.set_bbox_changed())},r.SetTowardPosition=function(a,b){a=Math.atan2(b-this.y,a-this.x);isNaN(a)||this.angle===a||(this.angle=a,this.set_bbox_changed())},e.Angle=function(a){a.set_float(cr.to_clamped_degrees(this.angle))});b||(u.CompareInstanceVar=function(a,b,d){return cr.do_cmp(this.instance_vars[a],b,d)},u.IsBoolInstanceVarSet=function(a){return this.instance_vars[a]},u.PickInstVarHiLow=function(a,b){var c=
this.getCurrentSol(),d=c.getObjects();if(!d.length)return!1;var f=d[0],e=f,g=f.instance_vars[b],h;var k=1;for(h=d.length;k<h;k++){f=d[k];var n=f.instance_vars[b];if(0===a&&n<g||1===a&&n>g)g=n,e=f}c.pick_one(e);return!0},u.PickByUID=function(a){var c;if(this.runtime.getCurrentCondition().inverted){var b=this.getCurrentSol();if(b.select_all){b.select_all=!1;cr.clearArray(b.instances);cr.clearArray(b.else_instances);var d=this.instances;var e=0;for(c=d.length;e<c;e++){var g=d[e];g.uid===a?b.else_instances.push(g):
b.instances.push(g)}}else{d=e=0;for(c=b.instances.length;e<c;e++)g=b.instances[e],b.instances[d]=g,g.uid===a?b.else_instances.push(g):d++;cr.truncateArray(b.instances,d)}this.applySolToContainer();return!!b.instances.length}g=this.runtime.getObjectByUID(a);if(!g)return!1;b=this.getCurrentSol();if(!b.select_all&&-1===b.instances.indexOf(g))return!1;if(this.is_family)for(a=g.type.families,e=0,c=a.length;e<c;e++){if(a[e]===this)return b.pick_one(g),this.applySolToContainer(),!0}else if(g.type===this)return b.pick_one(g),
this.applySolToContainer(),!0;return!1},u.OnCreated=function(){return!0},u.OnDestroyed=function(){return!0},r.SetInstanceVar=function(a,b){var c=this.instance_vars;cr.is_number(c[a])?cr.is_number(b)?c[a]=b:c[a]=parseFloat(b):cr.is_string(c[a])&&(cr.is_string(b)?c[a]=b:c[a]=b.toString())},r.AddInstanceVar=function(a,b){var c=this.instance_vars;cr.is_number(c[a])?cr.is_number(b)?c[a]+=b:c[a]+=parseFloat(b):cr.is_string(c[a])&&(cr.is_string(b)?c[a]+=b:c[a]+=b.toString())},r.SubInstanceVar=function(a,
b){var c=this.instance_vars;cr.is_number(c[a])&&(cr.is_number(b)?c[a]-=b:c[a]-=parseFloat(b))},r.SetBoolInstanceVar=function(a,b){this.instance_vars[a]=b?1:0},r.ToggleBoolInstanceVar=function(a){this.instance_vars[a]=1-this.instance_vars[a]},r.Destroy=function(){this.runtime.DestroyInstance(this)},r.LoadFromJsonString||(r.LoadFromJsonString=function(a){try{var c=JSON.parse(a)}catch(y){return}this.runtime.loadInstanceFromJSON(this,c,!0);this.afterLoad&&this.afterLoad();if(this.behavior_insts)for(a=
0,c=this.behavior_insts.length;a<c;++a){var b=this.behavior_insts[a];b.afterLoad&&b.afterLoad()}}),e.Count=function(a){var c=a.object_class.instances.length,b;var d=0;for(b=this.runtime.createRow.length;d<b;d++){var e=this.runtime.createRow[d];a.object_class.is_family?0<=e.type.families.indexOf(a.object_class)&&c++:e.type===a.object_class&&c++}a.set_int(c)},e.PickedCount=function(a){a.set_int(a.object_class.getCurrentSol().getObjects().length)},e.UID=function(a){a.set_int(this.uid)},e.IID=function(a){a.set_int(this.get_iid())},
e.AsJSON||(e.AsJSON=function(a){a.set_string(JSON.stringify(this.runtime.saveInstanceToJSON(this,!0)))}));d&&(u.IsVisible=function(){return this.visible},r.SetVisible=function(a){!a!==!this.visible&&(this.visible=!!a,this.runtime.redraw=!0)},u.CompareOpacity=function(a,b){return cr.do_cmp(cr.round6dp(100*this.opacity),a,b)},r.SetOpacity=function(a){a/=100;0>a?a=0:1<a&&(a=1);a!==this.opacity&&(this.opacity=a,this.runtime.redraw=!0)},e.Opacity=function(a){a.set_float(cr.round6dp(100*this.opacity))});
k&&(u.IsOnLayer=function(a){return a?this.layer===a:!1},u.PickTopBottom=function(a){var c=this.getCurrentSol(),b=c.getObjects();if(!b.length)return!1;var d=b[0],e=d,g;var h=1;for(g=b.length;h<g;h++)if(d=b[h],0===a){if(d.layer.index>e.layer.index||d.layer.index===e.layer.index&&d.get_zindex()>e.get_zindex())e=d}else if(d.layer.index<e.layer.index||d.layer.index===e.layer.index&&d.get_zindex()<e.get_zindex())e=d;c.pick_one(e);return!0},r.MoveToTop=function(){var a=this.layer,b=a.instances;b.length&&
b[b.length-1]===this||(a.removeFromInstanceList(this,!1),a.appendToInstanceList(this,!1),this.runtime.redraw=!0)},r.MoveToBottom=function(){var a=this.layer,b=a.instances;b.length&&b[0]===this||(a.removeFromInstanceList(this,!1),a.prependToInstanceList(this,!1),this.runtime.redraw=!0)},r.MoveToLayer=function(a){a&&a!=this.layer&&(this.layer.removeFromInstanceList(this,!0),this.layer=a,a.appendToInstanceList(this,!0),this.runtime.redraw=!0)},r.ZMoveToObject=function(a,b){a=0===a;b&&(b=b.getFirstPicked(this))&&
b.uid!==this.uid&&(this.layer.index!==b.layer.index&&(this.layer.removeFromInstanceList(this,!0),this.layer=b.layer,b.layer.appendToInstanceList(this,!0)),this.layer.moveInstanceAdjacent(this,b,a),this.runtime.redraw=!0)},e.LayerNumber=function(a){a.set_int(this.layer.number)},e.LayerName=function(a){a.set_string(this.layer.name)},e.ZIndex=function(a){a.set_int(this.get_zindex())});a&&(r.SetEffectEnabled=function(a,b){this.runtime.glwrap&&(b=this.type.getEffectIndexByName(b),0>b||(a=1===a,this.active_effect_flags[b]!==
a&&(this.active_effect_flags[b]=a,this.updateActiveEffects(),this.runtime.redraw=!0)))},r.SetEffectParam=function(a,b,d){if(this.runtime.glwrap){var c=this.type.getEffectIndexByName(a);0>c||(a=this.type.effect_types[c],c=this.effect_params[c],b=Math.floor(b),0>b||b>=c.length||(1===this.runtime.glwrap.getProgramParameterType(a.shaderindex,b)&&(d/=100),c[b]!==d&&(c[b]=d,a.active&&(this.runtime.redraw=!0))))}})};cr.set_bbox_changed=function(){this.cell_changed=this.bbox_changed=!0;this.type.any_cell_changed=
!0;this.runtime.redraw=!0;var a,e=this.bbox_changed_callbacks;var l=0;for(a=e.length;l<a;++l)e[l](this);this.layer.useRenderCells&&this.update_bbox()};cr.add_bbox_changed_callback=function(a){a&&this.bbox_changed_callbacks.push(a)};cr.update_bbox=function(){if(this.bbox_changed){var a=this.bbox,e=this.bquad;a.set(this.x,this.y,this.x+this.width,this.y+this.height);a.offset(-this.hotspotX*this.width,-this.hotspotY*this.height);this.angle?(a.offset(-this.x,-this.y),e.set_from_rotated_rect(a,this.angle),
e.offset(this.x,this.y),e.bounding_box(a)):e.set_from_rect(a);a.normalize();this.bbox_changed=!1;this.update_render_cell()}};var a=new cr.rect(0,0,0,0);cr.update_render_cell=function(){if(this.layer.useRenderCells){var b=this.layer.render_grid,e=this.bbox;a.set(b.XToCell(e.left),b.YToCell(e.top),b.XToCell(e.right),b.YToCell(e.bottom));this.rendercells.equals(a)||(this.rendercells.right<this.rendercells.left?b.update(this,null,a):b.update(this,this.rendercells,a),this.rendercells.copy(a),this.layer.render_list_stale=
!0)}};cr.update_collision_cell=function(){if(this.cell_changed&&this.collisionsEnabled){this.update_bbox();var b=this.type.collision_grid,e=this.bbox;a.set(b.XToCell(e.left),b.YToCell(e.top),b.XToCell(e.right),b.YToCell(e.bottom));this.collcells.equals(a)||(this.collcells.right<this.collcells.left?b.update(this,null,a):b.update(this,this.collcells,a),this.collcells.copy(a),this.cell_changed=!1)}};cr.inst_contains_pt=function(a,e){return this.bbox.contains_pt(a,e)&&this.bquad.contains_pt(a,e)?this.tilemap_exists?
this.testPointOverlapTile(a,e):this.collision_poly&&!this.collision_poly.is_empty()?(this.collision_poly.cache_poly(this.width,this.height,this.angle),this.collision_poly.contains_pt(a-this.x,e-this.y)):!0:!1};cr.inst_get_iid=function(){this.type.updateIIDs();return this.iid};cr.inst_get_zindex=function(){this.layer.updateZIndices();return this.zindex};cr.inst_updateActiveEffects=function(){cr.clearArray(this.active_effect_types);var a,e=!0;var l=0;for(a=this.active_effect_flags.length;l<a;l++)if(this.active_effect_flags[l]){var h=
this.type.effect_types[l];this.active_effect_types.push(h);h.preservesOpaqueness||(e=!1)}this.uses_shaders=!!this.active_effect_types.length;this.shaders_preserve_opaqueness=e};cr.inst_toString=function(){return"Inst"+this.puid};cr.type_getFirstPicked=function(a){if(a&&a.is_contained&&a.type!=this){var b;var l=0;for(b=a.siblings.length;l<b;l++){var h=a.siblings[l];if(h.type==this)return h}}a=this.getCurrentSol().getObjects();return a.length?a[0]:null};cr.type_getPairedInstance=function(a){var b=this.getCurrentSol().getObjects();
return b.length?b[a.get_iid()%b.length]:null};cr.type_updateIIDs=function(){if(this.stale_iids&&!this.is_family){var a;var e=0;for(a=this.instances.length;e<a;e++)this.instances[e].iid=e;var l=e,h=this.runtime.createRow;e=0;for(a=h.length;e<a;++e)h[e].type===this&&(h[e].iid=l++);this.stale_iids=!1}};cr.type_getInstanceByIID=function(a){if(a<this.instances.length)return this.instances[a];a-=this.instances.length;var b=this.runtime.createRow,l;var h=0;for(l=b.length;h<l;++h)if(b[h].type===this){if(0===
a)return b[h];--a}return null};cr.type_getCurrentSol=function(){return this.solstack[this.cur_sol]};cr.type_pushCleanSol=function(){this.cur_sol++;this.cur_sol===this.solstack.length?this.solstack.push(new cr.selection(this)):(this.solstack[this.cur_sol].select_all=!0,cr.clearArray(this.solstack[this.cur_sol].else_instances))};cr.type_pushCopySol=function(){this.cur_sol++;this.cur_sol===this.solstack.length&&this.solstack.push(new cr.selection(this));var a=this.solstack[this.cur_sol],e=this.solstack[this.cur_sol-
1];e.select_all?a.select_all=!0:(a.select_all=!1,cr.shallowAssignArray(a.instances,e.instances));cr.clearArray(a.else_instances)};cr.type_popSol=function(){this.cur_sol--};cr.type_getBehaviorByName=function(a){var b,l,h=0;if(!this.is_family){var n=0;for(b=this.families.length;n<b;n++){var g=this.families[n];var d=0;for(l=g.behaviors.length;d<l;d++){if(a===g.behaviors[d].name)return this.extra.lastBehIndex=h,g.behaviors[d];h++}}}n=0;for(b=this.behaviors.length;n<b;n++){if(a===this.behaviors[n].name)return this.extra.lastBehIndex=
h,this.behaviors[n];h++}return null};cr.type_getBehaviorIndexByName=function(a){return this.getBehaviorByName(a)?this.extra.lastBehIndex:-1};cr.type_getEffectIndexByName=function(a){var b;var l=0;for(b=this.effect_types.length;l<b;l++)if(this.effect_types[l].name===a)return l;return-1};cr.type_applySolToContainer=function(){if(this.is_contained&&!this.is_family){var a,e,l;this.updateIIDs();var h=this.getCurrentSol();var n=h.select_all,g=(a=this.runtime.getCurrentEventStack())&&a.current_event&&a.current_event.orblock;
a=0;for(e=this.container.length;a<e;a++){var d=this.container[a];if(d!==this){d.updateIIDs();var k=d.getCurrentSol();k.select_all=n;if(!n){cr.clearArray(k.instances);var u=0;for(l=h.instances.length;u<l;++u)k.instances[u]=d.getInstanceByIID(h.instances[u].iid);if(g)for(cr.clearArray(k.else_instances),u=0,l=h.else_instances.length;u<l;++u)k.else_instances[u]=d.getInstanceByIID(h.else_instances[u].iid)}}}}};cr.type_toString=function(){return"Type"+this.sid};cr.do_cmp=function(a,e,l){if("undefined"===
typeof a||"undefined"===typeof l)return!1;switch(e){case 0:return a===l;case 1:return a!==l;case 2:return a<l;case 3:return a<=l;case 4:return a>l;case 5:return a>=l;default:return!1}}})();cr.shaders={};cr.plugins_.Browser=function(a){this.runtime=a};
(function(){function a(){k&&u&&window.OfflineClientInfo&&window.OfflineClientInfo.SetMessageCallback(function(a){r.onSWMessage(a)})}function b(){if(!f&&navigator.getBattery){var a=navigator.getBattery();f=!0;a&&a.then(function(a){c=a})}}function e(){}function l(){}function h(a){console&&console.warn&&console.warn("Fullscreen request failed: ",a);y.setSize(window.innerWidth,window.innerHeight)}function n(){}var g=cr.plugins_.Browser.prototype;g.Type=function(a){this.plugin=a;this.runtime=a.runtime};
var d=g.Type.prototype;d.onCreate=function(){};var k=!1,u=!1;document.addEventListener("DOMContentLoaded",function(){if(window.C2_RegisterSW&&navigator.serviceWorker){var c=document.createElement("script");c.onload=function(){k=!0;a()};c.src="offlineClient.js";document.head.appendChild(c)}});var r=null;d.onAppBegin=function(){u=!0;a()};g.Instance=function(a){this.type=a;this.runtime=a.runtime};d=g.Instance.prototype;d.onCreate=function(){var a=this;window.addEventListener("resize",function(){a.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnResize,
a)});r=this;"undefined"!==typeof navigator.onLine&&(window.addEventListener("online",function(){a.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnOnline,a)}),window.addEventListener("offline",function(){a.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnOffline,a)}));this.runtime.isDirectCanvas||(document.addEventListener("appMobi.device.update.available",function(){a.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnUpdateReady,a)}),document.addEventListener("backbutton",function(){a.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton,
a)}),document.addEventListener("menubutton",function(){a.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnMenuButton,a)}),document.addEventListener("searchbutton",function(){a.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnSearchButton,a)}),document.addEventListener("tizenhwkey",function(c){switch(c.keyName){case "back":var b=a.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton,a);!b&&window.tizen&&window.tizen.application.getCurrentApplication().exit();break;case "menu":(b=
a.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnMenuButton,a))||c.preventDefault()}}));this.runtime.isWindows10&&"undefined"!==typeof Windows?Windows.UI.Core.SystemNavigationManager.getForCurrentView().addEventListener("backrequested",function(c){a.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton,a)&&(c.handled=!0)}):this.runtime.isWinJS&&WinJS.Application&&(WinJS.Application.onbackclick=function(c){return!!a.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton,a)});
this.runtime.addSuspendCallback(function(c){c?a.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnPageHidden,a):a.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnPageVisible,a)});this.is_arcade="undefined"!==typeof window.is_scirra_arcade};d.onSWMessage=function(a){a=a.data.type;"downloading-update"===a?this.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnUpdateFound,this):"update-ready"===a||"update-pending"===a?this.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnUpdateReady,this):
"offline-ready"===a&&this.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnOfflineReady,this)};var c=null,f=!1;e.prototype.CookiesEnabled=function(){return navigator?navigator.cookieEnabled:!1};e.prototype.IsOnline=function(){return navigator?navigator.onLine:!1};e.prototype.HasJava=function(){return navigator?navigator.javaEnabled():!1};e.prototype.OnOnline=function(){return!0};e.prototype.OnOffline=function(){return!0};e.prototype.IsDownloadingUpdate=function(){return!1};e.prototype.OnUpdateReady=
function(){return!0};e.prototype.PageVisible=function(){return!this.runtime.isSuspended};e.prototype.OnPageVisible=function(){return!0};e.prototype.OnPageHidden=function(){return!0};e.prototype.OnResize=function(){return!0};e.prototype.IsFullscreen=function(){return!!(document.mozFullScreen||document.webkitIsFullScreen||document.fullScreen||this.runtime.isNodeFullscreen)};e.prototype.OnBackButton=function(){return!0};e.prototype.OnMenuButton=function(){return!0};e.prototype.OnSearchButton=function(){return!0};
e.prototype.IsMetered=function(){var a=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return a?!!a.metered:!1};e.prototype.IsCharging=function(){var a=navigator.battery||navigator.mozBattery||navigator.webkitBattery;if(a)return!!a.charging;b();return c?!!c.charging:!0};e.prototype.IsPortraitLandscape=function(a){return(window.innerWidth<=window.innerHeight?0:1)===a};e.prototype.SupportsFullscreen=function(){if(this.runtime.isNodeWebkit)return!0;var a=this.runtime.canvasdiv||
this.runtime.canvas;return!!(a.requestFullscreen||a.mozRequestFullScreen||a.msRequestFullscreen||a.webkitRequestFullScreen)};e.prototype.OnUpdateFound=function(){return!0};e.prototype.OnUpdateReady=function(){return!0};e.prototype.OnOfflineReady=function(){return!0};g.cnds=new e;l.prototype.Alert=function(a){this.runtime.isDomFree||alert(a.toString())};l.prototype.Close=function(){this.runtime.isCocoonJs?CocoonJS.App.forceToFinish():window.tizen?window.tizen.application.getCurrentApplication().exit():
navigator.app&&navigator.app.exitApp?navigator.app.exitApp():navigator.device&&navigator.device.exitApp?navigator.device.exitApp():this.is_arcade||this.runtime.isDomFree||window.close()};l.prototype.Focus=function(){this.runtime.isNodeWebkit?window.nwgui.Window.get().focus():this.is_arcade||this.runtime.isDomFree||window.focus()};l.prototype.Blur=function(){this.runtime.isNodeWebkit?window.nwgui.Window.get().blur():this.is_arcade||this.runtime.isDomFree||window.blur()};l.prototype.GoBack=function(){navigator.app&&
navigator.app.backHistory?navigator.app.backHistory():this.is_arcade||this.runtime.isDomFree||!window.back||window.back()};l.prototype.GoForward=function(){this.is_arcade||this.runtime.isDomFree||!window.forward||window.forward()};l.prototype.GoHome=function(){this.is_arcade||this.runtime.isDomFree||!window.home||window.home()};l.prototype.GoToURL=function(a,c){this.runtime.isCocoonJs?CocoonJS.App.openURL(a):this.runtime.isEjecta?ejecta.openURL(a):this.runtime.isWinJS?Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri(a)):
navigator.app&&navigator.app.loadUrl?navigator.app.loadUrl(a,{openExternal:!0}):self.cordova&&self.cordova.InAppBrowser?self.cordova.InAppBrowser.open(a,"_system"):this.is_arcade||this.runtime.isDomFree||(2!==c||this.is_arcade?1!==c||this.is_arcade?window.location=a:window.parent.location=a:window.top.location=a)};l.prototype.GoToURLWindow=function(a,c){this.runtime.isCocoonJs?CocoonJS.App.openURL(a):this.runtime.isEjecta?ejecta.openURL(a):this.runtime.isWinJS?Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri(a)):
navigator.app&&navigator.app.loadUrl?navigator.app.loadUrl(a,{openExternal:!0}):self.cordova&&self.cordova.InAppBrowser?self.cordova.InAppBrowser.open(a,"_system"):this.is_arcade||this.runtime.isDomFree||window.open(a,c)};l.prototype.Reload=function(){this.is_arcade||this.runtime.isDomFree||window.location.reload()};var q=!0,y=null;l.prototype.RequestFullScreen=function(a){this.runtime.isDomFree?cr.logexport("[Construct 2] Requesting fullscreen is not supported on this platform - the request has been ignored"):
(2<=a&&(a+=1),6===a&&(a=2),this.runtime.isNodeWebkit?this.runtime.isDebug?debuggerFullscreen(!0):!this.runtime.isNodeFullscreen&&window.nwgui&&(window.nwgui.Window.get().enterFullscreen(),this.runtime.isNodeFullscreen=!0,this.runtime.fullscreen_scaling=2<=a?a:0):document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement||document.fullScreen||document.fullScreenElement||(this.runtime.fullscreen_scaling=2<=a?a:0,a=document.documentElement,q&&(q=!1,y=this.runtime,a.addEventListener("mozfullscreenerror",
h),a.addEventListener("webkitfullscreenerror",h),a.addEventListener("MSFullscreenError",h),a.addEventListener("fullscreenerror",h)),a.requestFullscreen?a.requestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.msRequestFullscreen?a.msRequestFullscreen():a.webkitRequestFullScreen&&("undefined"!==typeof Element&&"undefined"!==typeof Element.ALLOW_KEYBOARD_INPUT?a.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):a.webkitRequestFullScreen())))};l.prototype.CancelFullScreen=function(){this.runtime.isDomFree?
cr.logexport("[Construct 2] Exiting fullscreen is not supported on this platform - the request has been ignored"):this.runtime.isNodeWebkit?this.runtime.isDebug?debuggerFullscreen(!1):this.runtime.isNodeFullscreen&&window.nwgui&&(window.nwgui.Window.get().leaveFullscreen(),this.runtime.isNodeFullscreen=!1):document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():document.webkitCancelFullScreen&&
document.webkitCancelFullScreen()};l.prototype.Vibrate=function(a){try{var c=a.split(","),b;var d=0;for(b=c.length;d<b;d++)c[d]=parseInt(c[d],10);navigator.vibrate?navigator.vibrate(c):navigator.mozVibrate?navigator.mozVibrate(c):navigator.webkitVibrate?navigator.webkitVibrate(c):navigator.msVibrate&&navigator.msVibrate(c)}catch(A){}};l.prototype.InvokeDownload=function(a,c){var b=document.createElement("a");if("undefined"===typeof b.download)window.open(a);else{var d=document.getElementsByTagName("body")[0];
b.textContent=c;b.href=a;b.download=c;d.appendChild(b);a=new MouseEvent("click");b.dispatchEvent(a);d.removeChild(b)}};l.prototype.InvokeDownloadString=function(a,c,b){var d="data:"+c+","+encodeURIComponent(a);a=document.createElement("a");"undefined"===typeof a.download?window.open(d):(c=document.getElementsByTagName("body")[0],a.textContent=b,a.href=d,a.download=b,c.appendChild(a),b=new MouseEvent("click"),a.dispatchEvent(b),c.removeChild(a))};l.prototype.ConsoleLog=function(a,c){"undefined"!==
typeof console&&(0===a&&console.log&&console.log(c.toString()),1===a&&console.warn&&console.warn(c.toString()),2===a&&console.error&&console.error(c.toString()))};l.prototype.ConsoleGroup=function(a){console&&console.group&&console.group(a)};l.prototype.ConsoleGroupEnd=function(){console&&console.groupEnd&&console.groupEnd()};l.prototype.ExecJs=function(a){try{eval&&eval(a)}catch(C){console&&console.error&&console.error("Error executing Javascript: ",C)}};var z="portrait landscape portrait-primary portrait-secondary landscape-primary landscape-secondary".split(" ");
l.prototype.LockOrientation=function(a){a=Math.floor(a);0>a||a>=z.length||(this.runtime.autoLockOrientation=!1,a=z[a],screen.orientation&&screen.orientation.lock?screen.orientation.lock(a):screen.lockOrientation?screen.lockOrientation(a):screen.webkitLockOrientation?screen.webkitLockOrientation(a):screen.mozLockOrientation?screen.mozLockOrientation(a):screen.msLockOrientation&&screen.msLockOrientation(a))};l.prototype.UnlockOrientation=function(){this.runtime.autoLockOrientation=!1;screen.orientation&&
screen.orientation.unlock?screen.orientation.unlock():screen.unlockOrientation?screen.unlockOrientation():screen.webkitUnlockOrientation?screen.webkitUnlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()};g.acts=new l;n.prototype.URL=function(a){a.set_string(this.runtime.isDomFree?"":window.location.toString())};n.prototype.Protocol=function(a){a.set_string(this.runtime.isDomFree?"":window.location.protocol)};n.prototype.Domain=
function(a){a.set_string(this.runtime.isDomFree?"":window.location.hostname)};n.prototype.PathName=function(a){a.set_string(this.runtime.isDomFree?"":window.location.pathname)};n.prototype.Hash=function(a){a.set_string(this.runtime.isDomFree?"":window.location.hash)};n.prototype.Referrer=function(a){a.set_string(this.runtime.isDomFree?"":document.referrer)};n.prototype.Title=function(a){a.set_string(this.runtime.isDomFree?"":document.title)};n.prototype.Name=function(a){a.set_string(this.runtime.isDomFree?
"":navigator.appName)};n.prototype.Version=function(a){a.set_string(this.runtime.isDomFree?"":navigator.appVersion)};n.prototype.Language=function(a){navigator&&navigator.language?a.set_string(navigator.language):a.set_string("")};n.prototype.Platform=function(a){a.set_string(this.runtime.isDomFree?"":navigator.platform)};n.prototype.Product=function(a){navigator&&navigator.product?a.set_string(navigator.product):a.set_string("")};n.prototype.Vendor=function(a){navigator&&navigator.vendor?a.set_string(navigator.vendor):
a.set_string("")};n.prototype.UserAgent=function(a){a.set_string(this.runtime.isDomFree?"":navigator.userAgent)};n.prototype.QueryString=function(a){a.set_string(this.runtime.isDomFree?"":window.location.search)};n.prototype.QueryParam=function(a,c){this.runtime.isDomFree?a.set_string(""):(c=RegExp("[?&]"+c+"=([^&]*)").exec(window.location.search))?a.set_string(decodeURIComponent(c[1].replace(/\+/g," "))):a.set_string("")};n.prototype.Bandwidth=function(a){var c=navigator.connection||navigator.mozConnection||
navigator.webkitConnection;c?"undefined"!==typeof c.bandwidth?a.set_float(c.bandwidth):"undefined"!==typeof c.downlinkMax?a.set_float(c.downlinkMax):a.set_float(Number.POSITIVE_INFINITY):a.set_float(Number.POSITIVE_INFINITY)};n.prototype.ConnectionType=function(a){var c=navigator.connection||navigator.mozConnection||navigator.webkitConnection;c?a.set_string(c.type||"unknown"):a.set_string("unknown")};n.prototype.BatteryLevel=function(a){var d=navigator.battery||navigator.mozBattery||navigator.webkitBattery;
d?a.set_float(d.level):(b(),c?a.set_float(c.level):a.set_float(1))};n.prototype.BatteryTimeLeft=function(a){var d=navigator.battery||navigator.mozBattery||navigator.webkitBattery;d?a.set_float(d.dischargingTime):(b(),c?a.set_float(c.dischargingTime):a.set_float(Number.POSITIVE_INFINITY))};n.prototype.ExecJS=function(a,c){if(eval){var b=0;try{b=eval(c)}catch(t){console&&console.error&&console.error("Error executing Javascript: ",t)}"number"===typeof b?a.set_any(b):"string"===typeof b?a.set_any(b):
"boolean"===typeof b?a.set_any(b?1:0):a.set_any(0)}else a.set_any(0)};n.prototype.ScreenWidth=function(a){a.set_int(screen.width)};n.prototype.ScreenHeight=function(a){a.set_int(screen.height)};n.prototype.DevicePixelRatio=function(a){a.set_float(this.runtime.devicePixelRatio)};n.prototype.WindowInnerWidth=function(a){a.set_int(window.innerWidth)};n.prototype.WindowInnerHeight=function(a){a.set_int(window.innerHeight)};n.prototype.WindowOuterWidth=function(a){a.set_int(window.outerWidth)};n.prototype.WindowOuterHeight=
function(a){a.set_int(window.outerHeight)};g.exps=new n})();var lastCSS="",importList=[];function importcssfile(a){if(-1==importList.indexOf(a)){var b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",a);document.getElementsByTagName("head")[0].appendChild(b);importList.push(a)}}Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){b=b||0;for(var e=this.length;b<e;){if(this[b]===a)return b;++b}return-1});
function removecssfile(a){for(var b=document.getElementsByTagName("link"),e=b.length;0<=e;e--)b[e]&&null!=b[e].getAttribute("href")&&-1!=b[e].getAttribute("href").indexOf(a)&&b[e].parentNode.removeChild(b[e]);importList.splice(importList.indexOf(a),1)}cr.plugins_.CSS_import=function(a){this.runtime=a};
(function(){var a=cr.plugins_.CSS_import.prototype;a.Type=function(a){this.plugin=a;this.runtime=a.runtime};a.Type.prototype.onCreate=function(){};a.Instance=function(a){this.type=a;this.runtime=a.runtime};var b=a.Instance.prototype;b.onCreate=function(){""!=this.properties[0]&&(importcssfile(this.properties[0]),lastCSS=this.properties[0])};b.onDestroy=function(){};b.draw=function(a){};b.drawGL=function(a){};a.cnds={};a.cnds.CompareCSS=function(a,b){return this.properties[0]===a};a.acts={};b=a.acts;
b.SetCSS=function(a){importcssfile(a);lastCSS=a};b.RemCSS=function(a){removecssfile(a)};a.exps={};a.exps.GetCSS=function(a){""!=lastCSS?a.set_string(lastCSS):""!=this.properties[0]?a.set_string(this.properties[0]):a.set_string("")}})();cr.plugins_.Function=function(a){this.runtime=a};
(function(){function a(){this.name="";this.retVal=0;this.params=[]}function b(){k++;k===d.length&&d.push(new a);return d[k]}function e(){return 0>k?null:d[k]}function l(){}function h(){}function n(){}var g=cr.plugins_.Function.prototype;g.Type=function(a){this.plugin=a;this.runtime=a.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(a){this.type=a;this.runtime=a.runtime};var d=[],k=-1;g.Instance.prototype.onCreate=function(){var a=this;window.c2_callFunction=function(d,c){var f,
e=b();e.name=d.toLowerCase();e.retVal=0;if(c)for(e.params.length=c.length,d=0,f=c.length;d<f;++d){var g=c[d];e.params[d]="number"===typeof g||"string"===typeof g?g:"boolean"===typeof g?g?1:0:0}else cr.clearArray(e.params);a.runtime.trigger(cr.plugins_.Function.prototype.cnds.OnFunction,a,e.name);k--;return e.retVal}};l.prototype.OnFunction=function(a){var b=e();return b?cr.equals_nocase(a,b.name):!1};l.prototype.CompareParam=function(a,b,c){var d=e();if(!d)return!1;a=cr.floor(a);return 0>a||a>=d.params.length?
!1:cr.do_cmp(d.params[a],b,c)};g.cnds=new l;h.prototype.CallFunction=function(a,d){var c=b();c.name=a.toLowerCase();c.retVal=0;cr.shallowAssignArray(c.params,d);this.runtime.trigger(cr.plugins_.Function.prototype.cnds.OnFunction,this,c.name);k--};h.prototype.SetReturnValue=function(a){var b=e();b&&(b.retVal=a)};h.prototype.CallExpression=function(a){};g.acts=new h;n.prototype.ReturnValue=function(a){if(d.length){var b=k+1;b>=d.length&&(b=d.length-1);b=d[b]}else b=null;b?a.set_any(b.retVal):a.set_int(0)};
n.prototype.ParamCount=function(a){var b=e();b?a.set_int(b.params.length):a.set_int(0)};n.prototype.Param=function(a,b){b=cr.floor(b);var c=e();c?0<=b&&b<c.params.length?a.set_any(c.params[b]):a.set_int(0):a.set_int(0)};n.prototype.Call=function(a,d){var c=b();c.name=d.toLowerCase();c.retVal=0;cr.clearArray(c.params);var f;var e=2;for(f=arguments.length;e<f;e++)c.params.push(arguments[e]);this.runtime.trigger(cr.plugins_.Function.prototype.cnds.OnFunction,this,c.name);k--;a.set_any(c.retVal)};g.exps=
new n})();cr.plugins_.Keyboard=function(a){this.runtime=a};
(function(){function a(){}function b(){}function e(a){a=Math.floor(a);switch(a){case 8:return"backspace";case 9:return"tab";case 13:return"enter";case 16:return"shift";case 17:return"control";case 18:return"alt";case 19:return"pause";case 20:return"capslock";case 27:return"esc";case 33:return"pageup";case 34:return"pagedown";case 35:return"end";case 36:return"home";case 37:return"\u2190";case 38:return"\u2191";case 39:return"\u2192";case 40:return"\u2193";case 45:return"insert";case 46:return"del";
case 91:return"left window key";case 92:return"right window key";case 93:return"select";case 96:return"numpad 0";case 97:return"numpad 1";case 98:return"numpad 2";case 99:return"numpad 3";case 100:return"numpad 4";case 101:return"numpad 5";case 102:return"numpad 6";case 103:return"numpad 7";case 104:return"numpad 8";case 105:return"numpad 9";case 106:return"numpad *";case 107:return"numpad +";case 109:return"numpad -";case 110:return"numpad .";case 111:return"numpad /";case 112:return"F1";case 113:return"F2";
case 114:return"F3";case 115:return"F4";case 116:return"F5";case 117:return"F6";case 118:return"F7";case 119:return"F8";case 120:return"F9";case 121:return"F10";case 122:return"F11";case 123:return"F12";case 144:return"numlock";case 145:return"scroll lock";case 186:return";";case 187:return"=";case 188:return",";case 189:return"-";case 190:return".";case 191:return"/";case 192:return"'";case 219:return"[";case 220:return"\\";case 221:return"]";case 222:return"#";case 223:return"`";default:return String.fromCharCode(a)}}
var l=cr.plugins_.Keyboard.prototype;l.Type=function(a){this.plugin=a;this.runtime=a.runtime};l.Type.prototype.onCreate=function(){};l.Instance=function(a){this.type=a;this.runtime=a.runtime;this.keyMap=Array(256);this.usedKeys=Array(256);this.triggerKey=0};var h=l.Instance.prototype;h.onCreate=function(){var a=this;this.runtime.isDomFree||(jQuery(document).keydown(function(b){a.onKeyDown(b)}),jQuery(document).keyup(function(b){a.onKeyUp(b)}))};var n=[32,33,34,35,36,37,38,39,40,44];h.onKeyDown=function(a){var b=
!1;window!=window.top&&-1<n.indexOf(a.which)&&(a.preventDefault(),b=!0,a.stopPropagation());if(this.keyMap[a.which])this.usedKeys[a.which]&&!b&&a.preventDefault();else{this.keyMap[a.which]=!0;this.triggerKey=a.which;this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnAnyKey,this);var e=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKey,this),g=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKeyCode,this);this.runtime.isInUserInputEvent=
!1;if(e||g)this.usedKeys[a.which]=!0,b||a.preventDefault()}};h.onKeyUp=function(a){this.keyMap[a.which]=!1;this.triggerKey=a.which;this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnAnyKeyReleased,this);var b=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKeyReleased,this),e=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKeyCodeReleased,this);this.runtime.isInUserInputEvent=!1;if(b||e||this.usedKeys[a.which])this.usedKeys[a.which]=
!0,a.preventDefault()};h.onWindowBlur=function(){var a;for(a=0;256>a;++a)if(this.keyMap[a]){this.keyMap[a]=!1;this.triggerKey=a;this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnAnyKeyReleased,this);var b=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKeyReleased,this),e=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKeyCodeReleased,this);if(b||e)this.usedKeys[a]=!0}};h.saveToJSON=function(){return{triggerKey:this.triggerKey}};h.loadFromJSON=function(a){this.triggerKey=
a.triggerKey};a.prototype.IsKeyDown=function(a){return this.keyMap[a]};a.prototype.OnKey=function(a){return a===this.triggerKey};a.prototype.OnAnyKey=function(a){return!0};a.prototype.OnAnyKeyReleased=function(a){return!0};a.prototype.OnKeyReleased=function(a){return a===this.triggerKey};a.prototype.IsKeyCodeDown=function(a){a=Math.floor(a);return 0>a||a>=this.keyMap.length?!1:this.keyMap[a]};a.prototype.OnKeyCode=function(a){return a===this.triggerKey};a.prototype.OnKeyCodeReleased=function(a){return a===
this.triggerKey};l.cnds=new a;l.acts=new function(){};b.prototype.LastKeyCode=function(a){a.set_int(this.triggerKey)};b.prototype.StringFromKeyCode=function(a,b){a.set_string(e(b))};l.exps=new b})();cr.plugins_.Mouse=function(a){this.runtime=a};
(function(){function a(){}function b(){}function e(){}var l=cr.plugins_.Mouse.prototype;l.Type=function(a){this.plugin=a;this.runtime=a.runtime};l.Type.prototype.onCreate=function(){};l.Instance=function(a){this.type=a;this.runtime=a.runtime;this.buttonMap=Array(4);this.triggerDir=this.triggerType=this.triggerButton=this.mouseYcanvas=this.mouseXcanvas=0;this.handled=!1};var h=l.Instance.prototype;h.onCreate=function(){var a=this;if(!this.runtime.isDomFree){jQuery(document).mousemove(function(b){a.onMouseMove(b)});
jQuery(document).mousedown(function(b){a.onMouseDown(b)});jQuery(document).mouseup(function(b){a.onMouseUp(b)});jQuery(document).dblclick(function(b){a.onDoubleClick(b)});var b=function(b){a.onWheel(b)};document.addEventListener("mousewheel",b,!1);document.addEventListener("DOMMouseScroll",b,!1)}};var n={left:0,top:0};h.onMouseMove=function(a){var b=this.runtime.isDomFree?n:jQuery(this.runtime.canvas).offset();this.mouseXcanvas=a.pageX-b.left;this.mouseYcanvas=a.pageY-b.top};h.mouseInGame=function(){return 0<
this.runtime.fullscreen_mode?!0:0<=this.mouseXcanvas&&0<=this.mouseYcanvas&&this.mouseXcanvas<this.runtime.width&&this.mouseYcanvas<this.runtime.height};h.onMouseDown=function(a){this.mouseInGame()&&(this.buttonMap[a.which]=!0,this.runtime.isInUserInputEvent=!0,this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnAnyClick,this),this.triggerButton=a.which-1,this.triggerType=0,this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnClick,this),this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnObjectClicked,
this),this.runtime.isInUserInputEvent=!1)};h.onMouseUp=function(a){this.buttonMap[a.which]&&(this.runtime.had_a_click&&!this.runtime.isMobile&&a.preventDefault(),this.runtime.had_a_click=!0,this.buttonMap[a.which]=!1,this.runtime.isInUserInputEvent=!0,this.triggerButton=a.which-1,this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnRelease,this),this.runtime.isInUserInputEvent=!1)};h.onDoubleClick=function(a){this.mouseInGame()&&(a.preventDefault(),this.runtime.isInUserInputEvent=!0,this.triggerButton=
a.which-1,this.triggerType=1,this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnClick,this),this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnObjectClicked,this),this.runtime.isInUserInputEvent=!1)};h.onWheel=function(a){this.triggerDir=0>(a.wheelDelta?a.wheelDelta:a.detail?-a.detail:0)?0:1;this.handled=!1;this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnWheel,this);this.runtime.isInUserInputEvent=!1;this.handled&&cr.isCanvasInputEvent(a)&&a.preventDefault()};
h.onWindowBlur=function(){var a;var b=0;for(a=this.buttonMap.length;b<a;++b)this.buttonMap[b]&&(this.buttonMap[b]=!1,this.triggerButton=b-1,this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnRelease,this))};a.prototype.OnClick=function(a,b){return a===this.triggerButton&&b===this.triggerType};a.prototype.OnAnyClick=function(){return!0};a.prototype.IsButtonDown=function(a){return this.buttonMap[a+1]};a.prototype.OnRelease=function(a){return a===this.triggerButton};a.prototype.IsOverObject=function(a){var b=
this.runtime.getCurrentCondition();return cr.xor(this.runtime.testAndSelectCanvasPointOverlap(a,this.mouseXcanvas,this.mouseYcanvas,b.inverted),b.inverted)};a.prototype.OnObjectClicked=function(a,b,e){return a!==this.triggerButton||b!==this.triggerType?!1:this.runtime.testAndSelectCanvasPointOverlap(e,this.mouseXcanvas,this.mouseYcanvas,!1)};a.prototype.OnWheel=function(a){this.handled=!0;return a===this.triggerDir};l.cnds=new a;var g=null;b.prototype.SetCursor=function(a){this.runtime.isDomFree||
(a="auto pointer text crosshair move help wait none".split(" ")[a],g!==a&&(g=a,document.body.style.cursor=a))};b.prototype.SetCursorSprite=function(a){this.runtime.isDomFree||this.runtime.isMobile||!a||(a=a.getFirstPicked())&&a.curFrame&&(a=a.curFrame,g!==a&&(g=a,a="url("+a.getDataUri()+") "+Math.round(a.hotspotX*a.width)+" "+Math.round(a.hotspotY*a.height)+", auto",document.body.style.cursor="",document.body.style.cursor=a))};l.acts=new b;e.prototype.X=function(a,b){if(cr.is_undefined(b)){b=this.runtime.getLayerByNumber(0);
var d=b.scale;var e=b.zoomRate;var c=b.parallaxX;var f=b.angle;b.scale=1;b.zoomRate=1;b.parallaxX=1;b.angle=0;a.set_float(b.canvasToLayer(this.mouseXcanvas,this.mouseYcanvas,!0));b.scale=d;b.zoomRate=e;b.parallaxX=c;b.angle=f}else(b=cr.is_number(b)?this.runtime.getLayerByNumber(b):this.runtime.getLayerByName(b))?a.set_float(b.canvasToLayer(this.mouseXcanvas,this.mouseYcanvas,!0)):a.set_float(0)};e.prototype.Y=function(a,b){if(cr.is_undefined(b)){b=this.runtime.getLayerByNumber(0);var d=b.scale;var e=
b.zoomRate;var c=b.parallaxY;var f=b.angle;b.scale=1;b.zoomRate=1;b.parallaxY=1;b.angle=0;a.set_float(b.canvasToLayer(this.mouseXcanvas,this.mouseYcanvas,!1));b.scale=d;b.zoomRate=e;b.parallaxY=c;b.angle=f}else(b=cr.is_number(b)?this.runtime.getLayerByNumber(b):this.runtime.getLayerByName(b))?a.set_float(b.canvasToLayer(this.mouseXcanvas,this.mouseYcanvas,!1)):a.set_float(0)};e.prototype.AbsoluteX=function(a){a.set_float(this.mouseXcanvas)};e.prototype.AbsoluteY=function(a){a.set_float(this.mouseYcanvas)};
l.exps=new e})();cr.plugins_.Rex_SysExt=function(a){this.runtime=a};
(function(){function a(){}function b(){}function e(){}var l=cr.plugins_.Rex_SysExt.prototype;l.Type=function(a){this.plugin=a;this.runtime=a.runtime};l.Type.prototype.onCreate=function(){};l.Instance=function(a){this.type=a;this.runtime=a.runtime};var h=l.Instance.prototype;h.onCreate=function(){this.tmp_insts=[]};h._pick_all=function(a){if(!a||!a.instances.length)return!1;a.getCurrentSol().select_all=!0;a.applySolToContainer();return!0};h._pick_inverse=function(a,b,e){if(!a||!a.instances.length)return!1;
var d=a.getCurrentSol();1==e&&(d.select_all=!0,cr.shallowAssignArray(d.instances,d.getObjects()));e=d.instances;var c=e.length,f,g=-1;for(f=0;f<c;f++){var h=e[f];if(h.uid==b){g=f;break}}-1!=g&&cr.arrayRemove(e,g);d.select_all=!1;a.applySolToContainer();return 0!=d.instances.length};h._quick_pick=function(a,b){if(a&&a.instances.length){b=this.runtime.getObjectByUID(b);var d=null!=b;if(d){var e=b.type.name;if(a.is_family){d=!1;var c=a.members,f=c.length,g;for(g=0;g<f;g++)if(e==c[g].name){d=!0;break}}else d=
e==a.name}e=a.getCurrentSol();d?e.pick_one(b):e.instances.length=0;e.select_all=!1;a.applySolToContainer();return d}};h._get_layer=function(a){return"number"==typeof a?this.runtime.getLayerByNumber(a):this.runtime.getLayerByName(a)};var n=function(a,b){switch(b){case 0:a=a.uid;break;case 1:a=a.x;break;case 2:a=a.y;break;case 3:a=a.width;break;case 4:a=a.height;break;case 5:a=a.angle;break;case 6:a=a.opacity;break;default:a=0}return a};l.cnds=new a;a.prototype.PickAll=function(a){return this._pick_all(a)};
a.prototype.PickInverse=function(a,b,e){return this._pick_inverse(a,b,e)};a.prototype.QuickPickByUID=function(a,b){return this._quick_pick(a,b)};l.acts=new b;b.prototype.__PickByUID=function(a,b,e){if(a&&a.instances.length){var d=a.getCurrentSol();1==e&&(d.select_all=!0);e=d.getObjects();var c=e.length,f,g=!1;for(f=0;f<c;f++){var h=e[f];if(h.uid==b){g=!0;break}}g?d.pick_one(h):d.instances.length=0;d.select_all=!1;a.applySolToContainer()}};b.prototype.PickByPropCmp=function(a,b,e,g,c){if(a&&a.instances.length){a=
a.getCurrentSol();1==c&&(a.select_all=!0);c=a.getObjects();var d=c.length,h;for(h=this.tmp_insts.length=0;h<d;h++){var k=c[h];cr.do_cmp(n(k,b),e,g)&&this.tmp_insts.push(k)}cr.shallowAssignArray(a.instances,this.tmp_insts);a.select_all=!1}};b.prototype.__PickInverse=function(a,b,e){this._pick_inverse(a,b,e)};b.prototype.PickAll=function(a){a&&(a.getCurrentSol().select_all=!0,a.applySolToContainer())};b.prototype.PickByUID=function(a,b){var d,e;if(a&&(e=this.runtime.getObjectByUID(b))){var c=a.getCurrentSol();
if(c.select_all||-1!==c.instances.indexOf(e))if(a.is_family){var f=a.families;b=0;for(d=f.length;b<d;b++)if(f[b]===e.type){c.pick_one(e);a.applySolToContainer();break}}else e.type===a&&(c.pick_one(e),a.applySolToContainer())}};b.prototype.PickInverse=function(a,b,e){var d;if(a){var c=a.getCurrentSol();e&&(c.select_all=!0);if(c.select_all){c.select_all=!1;c.instances.length=0;var f=a.instances;e=0;for(d=f.length;e<d;e++){var g=f[e];g.uid!==b&&c.instances.push(g)}}else{f=e=0;for(d=c.instances.length;e<
d;e++)g=c.instances[e],c.instances[f]=g,g.uid!==b&&f++;c.instances.length=f}a.applySolToContainer()}};b.prototype.SetGroupActive=function(a,b){if(a=this.runtime.groups_by_name[a.toLowerCase()])switch(b){case 0:a.setGroupActive(!1);break;case 1:a.setGroupActive(!0);break;case 2:a.setGroupActive(!a.group_active)}};b.prototype.SetLayerVisible=function(a,b){if(a=cr.is_number(a)?this.runtime.getLayerByNumber(a):this.runtime.getLayerByName(a))b=1==b,a.visible!==b&&(a.visible=b,this.runtime.redraw=!0)};
b.prototype.SwapPosByUID=function(a,b){a=this.runtime.getObjectByUID(a);b=this.runtime.getObjectByUID(b);if(a&&b){var d=a.x,e=a.y,c=b.y;a.x=b.x;a.y=c;b.x=d;b.y=e;a.set_bbox_changed();b.set_bbox_changed()}};l.exps=new e;e.prototype.Eval=function(a,b){a.set_any(eval("("+b+")"))};e.prototype.ToHexString=function(a,b){a.set_string(b.toString(16))};e.prototype.ToDecimalMark=function(a,b,e){a.set_string(b.toLocaleString(e))};e.prototype.String2ByteCount=function(a,b){b=encodeURI(b).split(/%..|./).length-
1;a.set_int(b)};e.prototype.SubString=function(a,b,e,g){a.set_string(b.substring(e,g))};e.prototype.ToFixed=function(a,b,e){null==e&&(e=10);a.set_string(b.toFixed(e))};e.prototype.ToPrecision=function(a,b,e){null==e&&(e=10);a.set_string(b.toPrecision(e))};e.prototype.ToFixedNumber=function(a,b,e){null==e&&(e=10);b=b.toFixed(e);a.set_float(parseFloat(b))};e.prototype.Newline=function(a,b){null==b&&(b=1);var d,e="";for(d=0;d<b;d++)e+="\n";a.set_string(e)};e.prototype.NormalRandom=function(a,b,e){do{var d=
2*Math.random()-1;var c=2*Math.random()-1;c=d*d+c*c}while(1<c||0==c);a.set_float(b+d*Math.sqrt(-2*Math.log(c)/c)*e)};e.prototype.NormalRandomApproximation=function(a,b,e){for(var d=0,c=0;6>c;c++)d+=Math.random();a.set_float(b+(d-3)/3*e)};e.prototype.ReflectionAngle=function(a,b,e){e=cr.to_radians(e);var d=cr.to_radians(b);b=Math.cos(d);d=Math.sin(d);var c=Math.cos(e);e=Math.sin(e);var f=b*c+d*e;b=cr.angleTo(0,0,b-2*f*c,d-2*f*e);a.set_float(cr.to_degrees(b))};var g="0123456789bcdefghjkmnpqrstuvwxyz".split("");
e.prototype.RandomBase32=function(a,b){for(var d="",e=0;e<b;e++)d+=g[Math.floor(32*Math.random())];a.set_string(d)}})();cr.plugins_.Rex_UID2Prop=function(a){this.runtime=a};
(function(){function a(){}function b(){}var e=cr.plugins_.Rex_UID2Prop.prototype;e.Type=function(a){this.plugin=a;this.runtime=a.runtime};e.Type.prototype.onCreate=function(){};e.Instance=function(a){this.type=a;this.runtime=a.runtime};var l=e.Instance.prototype;l.onCreate=function(){this.alias2pv={}};l.onDestroy=function(){};l.add_alias=function(a,b,e){var d=this.alias2pv[a];if(null==d)d={},this.alias2pv[a]=d;else for(var g in d)delete d[g];if(b.is_family)for(g=b.members.length,a=0;a<g;a++){var h=
b.members[a];d[h.sid]=e+h.family_var_map[b.family_index]}else d[b.sid]=e};l.get_pv=function(a,b){if(null==a)return 0;b=this.alias2pv[b];if(null==b)return 0;b=b[a.type.sid];return null==b?0:a.instance_vars[b]};l.saveToJSON=function(){return{alias:this.alias2pv}};l.loadFromJSON=function(a){this.alias2pv=a.alias};e.cnds=new function(){};e.acts=new a;a.prototype.DefinePrivateVariableAlias=function(a,b,e){this.add_alias(a,b,e)};a.prototype.InstDestroy=function(a){(a=this.runtime.getObjectByUID(a))&&this.runtime.DestroyInstance(a)};
a.prototype.InstSetX=function(a,b){(a=this.runtime.getObjectByUID(a))&&null!=a.x&&a.x!==b&&(a.x=b,a.set_bbox_changed())};a.prototype.InstSetY=function(a,b){(a=this.runtime.getObjectByUID(a))&&null!=a.y&&a.y!==b&&(a.y=b,a.set_bbox_changed())};a.prototype.InstSetPos=function(a,b,e){!(a=this.runtime.getObjectByUID(a))||null==a.x||a.x===b&&a.y===e||(a.x=b,a.y=e,a.set_bbox_changed())};a.prototype.InstSetPosToObject=function(a,b,e){if((a=this.runtime.getObjectByUID(a))&&null!=a.x){var d=this.runtime.getObjectByUID(b);
d&&(d.getImagePoint?(b=d.getImagePoint(e,!0),e=d.getImagePoint(e,!1)):(b=d.x,e=d.y),a.x!==b||a.y!==e)&&(a.x=b,a.y=e,a.set_bbox_changed())}};a.prototype.InstMoveForward=function(a,b){(a=this.runtime.getObjectByUID(a))&&null!=a.x&&0!==b&&(a.x+=Math.cos(a.angle)*b,a.y+=Math.sin(a.angle)*b,a.set_bbox_changed())};a.prototype.InstMoveAtAngle=function(a,b,e){(a=this.runtime.getObjectByUID(a))&&null!=a.x&&0!==e&&(a.x+=Math.cos(cr.to_radians(b))*e,a.y+=Math.sin(cr.to_radians(b))*e,a.set_bbox_changed())};a.prototype.InstSetWidth=
function(a,b){(a=this.runtime.getObjectByUID(a))&&null!=a.width&&a.width!==b&&(a.width=b,a.set_bbox_changed())};a.prototype.InstSetHeight=function(a,b){(a=this.runtime.getObjectByUID(a))&&null!=a.height&&a.height!==b&&(a.height=b,a.set_bbox_changed())};a.prototype.InstSetSize=function(a,b,e){!(a=this.runtime.getObjectByUID(a))||null==a.width||a.width===b&&a.height===e||(a.width=b,a.height=e,a.set_bbox_changed())};a.prototype.InstSetAngle=function(a,b){(a=this.runtime.getObjectByUID(a))&&null!=a.angle&&
(b=cr.to_radians(cr.clamp_angle_degrees(b)),isNaN(b)||a.angle===b||(a.angle=b,a.set_bbox_changed()))};a.prototype.InstRotateClockwise=function(a,b){(a=this.runtime.getObjectByUID(a))&&null!=a.angle&&0!==b&&!isNaN(b)&&(a.angle+=cr.to_radians(b),a.angle=cr.clamp_angle(a.angle),a.set_bbox_changed())};a.prototype.InstRotateCounterclockwise=function(a,b){(a=this.runtime.getObjectByUID(a))&&null!=a.angle&&0!==b&&!isNaN(b)&&(a.angle-=cr.to_radians(b),a.angle=cr.clamp_angle(a.angle),a.set_bbox_changed())};
a.prototype.InstRotateTowardAngle=function(a,b,e){(a=this.runtime.getObjectByUID(a))&&null!=a.angle&&(b=cr.angleRotate(a.angle,cr.to_radians(e),cr.to_radians(b)),isNaN(b)||a.angle===b||(a.angle=b,a.set_bbox_changed()))};a.prototype.InstRotateTowardPosition=function(a,b,e,d){(a=this.runtime.getObjectByUID(a))&&null!=a.angle&&(b=cr.angleRotate(a.angle,Math.atan2(d-a.y,e-a.x),cr.to_radians(b)),isNaN(b)||a.angle===b||(a.angle=b,a.set_bbox_changed()))};a.prototype.InstSetTowardPosition=function(a,b,e){(a=
this.runtime.getObjectByUID(a))&&null!=a.angle&&(b=Math.atan2(e-a.y,b-a.x),isNaN(b)||a.angle===b||(a.angle=b,a.set_bbox_changed()))};a.prototype.InstSetOpacity=function(a,b){(a=this.runtime.getObjectByUID(a))&&null!=a.opacity&&(b/=100,0>b?b=0:1<b&&(b=1),b!==a.opacity&&(a.opacity=b,a.runtime.redraw=!0))};a.prototype.InstSetVisible=function(a){var b=this.runtime.getObjectByUID(uid);b&&null!=b.visible&&!a!==!b.visible&&(b.visible=a,b.runtime.redraw=!0)};e.exps=new b;b.prototype.X=function(a,b){b=this.runtime.getObjectByUID(b);
null==b||null==b.x?a.set_float(0):a.set_float(b.x)};b.prototype.Y=function(a,b){b=this.runtime.getObjectByUID(b);null==b||null==b.y?a.set_float(0):a.set_float(b.y)};b.prototype.Angle=function(a,b){b=this.runtime.getObjectByUID(b);null==b||null==b.angle?a.set_float(0):a.set_float(cr.to_clamped_degrees(b.angle))};b.prototype.Width=function(a,b){b=this.runtime.getObjectByUID(b);null==b||null==b.width?a.set_float(0):a.set_float(b.width)};b.prototype.Height=function(a,b){b=this.runtime.getObjectByUID(b);
null==b||null==b.height?a.set_float(0):a.set_float(b.height)};b.prototype.Opacity=function(a,b){b=this.runtime.getObjectByUID(b);null==b||null==b.opacity?a.set_float(0):a.set_float(b.opacity)};b.prototype.Visible=function(a,b){b=this.runtime.getObjectByUID(b);null==b||null==b.visible?a.set_float(0):a.set_float(b.visible)};b.prototype.ImgptX=function(a,b,e){b=this.runtime.getObjectByUID(b);null==b||null==b.getImagePoint?a.set_float(0):a.set_float(b.getImagePoint(e,!0))};b.prototype.ImgptY=function(a,
b,e){b=this.runtime.getObjectByUID(b);null==b||null==b.getImagePoint?a.set_float(0):a.set_float(b.getImagePoint(e,!1))};b.prototype.PV=function(a,b,e){b=this.runtime.getObjectByUID(b);a.set_any(this.get_pv(b,e))};b.prototype.DistanceTo=function(a,b,e){b=this.runtime.getObjectByUID(b);e=this.runtime.getObjectByUID(e);e=null==b||null==e||null==b.x||null==b.y||null==e.x||null==e.y?0:cr.distanceTo(b.x,b.y,e.x,e.y);a.set_float(e)};b.prototype.AngleTo=function(a,b,e){b=this.runtime.getObjectByUID(b);e=
this.runtime.getObjectByUID(e);e=null==b||null==e||null==b.x||null==b.y||null==e.x||null==e.y?0:cr.angleTo(b.x,b.y,e.x,e.y);a.set_float(cr.to_clamped_degrees(e))}})();cr.plugins_.Sprite=function(a){this.runtime=a};
(function(){function a(){if(0===this.datauri.length){var a=document.createElement("canvas");a.width=this.width;a.height=this.height;var b=a.getContext("2d");this.spritesheeted?b.drawImage(this.texture_img,this.offx,this.offy,this.width,this.height,0,0,this.width,this.height):b.drawImage(this.texture_img,0,0,this.width,this.height);this.datauri=a.toDataURL("image/png")}return this.datauri}function b(){}function e(a){a[0]=0;a[1]=0;a[2]=0;y.push(a)}function l(a,b){return a<b?""+a+","+b:""+b+","+a}function h(a,
b,c,d){b=b.uid;c=c.uid;var e=l(b,c);if(a.hasOwnProperty(e))a[e][2]=d;else{var f=y.length?y.pop():[0,0,0];f[0]=b;f[1]=c;f[2]=d;a[e]=f}}function n(a,b,c){b=l(b.uid,c.uid);a.hasOwnProperty(b)&&(e(a[b]),delete a[b])}function g(a,b,c){b=l(b.uid,c.uid);if(a.hasOwnProperty(b))return z=a[b][2],!0;z=-2;return!1}function d(a,b,c){if(!a)return!1;var d=0!==b||0!==c,f=!1,e=this.runtime.getCurrentCondition(),g=e.type;e=e.inverted;var m=a.getCurrentSol();var h=this.runtime.getCurrentEventStack().current_event.orblock;
m.select_all?(this.update_bbox(),B.copy(this.bbox),B.offset(b,c),this.runtime.getCollisionCandidates(this.layer,a,B,A),m=A):m=h?this.runtime.isCurrentConditionFirst()&&!m.else_instances.length&&m.instances.length?m.instances:m.else_instances:m.instances;C=a;t=g!==a&&!e;if(d){var k=this.x;var p=this.y;this.x+=b;this.y+=c;this.set_bbox_changed()}b=0;for(c=m.length;b<c;b++)if(h=m[b],this.runtime.testOverlap(this,h)){f=!0;if(e)break;g!==a&&v.add(h)}d&&(this.x=k,this.y=p,this.set_bbox_changed());cr.clearArray(A);
return f}function k(){}function u(){}var r=cr.plugins_.Sprite.prototype;r.Type=function(a){this.plugin=a;this.runtime=a.runtime};var c=r.Type.prototype;c.onCreate=function(){if(!this.is_family){var b,c;this.all_frames=[];this.has_loaded_textures=!1;var d=0;for(b=this.animations.length;d<b;d++){var e=this.animations[d];var f={};f.name=e[0];f.speed=e[1];f.loop=e[2];f.repeatcount=e[3];f.repeatto=e[4];f.pingpong=e[5];f.sid=e[6];f.frames=[];var g=0;for(c=e[7].length;g<c;g++){var t=e[7][g];var h={};h.texture_file=
t[0];h.texture_filesize=t[1];h.offx=t[2];h.offy=t[3];h.width=t[4];h.height=t[5];h.duration=t[6];h.hotspotX=t[7];h.hotspotY=t[8];h.image_points=t[9];h.poly_pts=t[10];h.pixelformat=t[11];h.spritesheeted=0!==h.width;h.datauri="";h.getDataUri=a;var k={left:0,top:0,right:1,bottom:1};h.sheetTex=k;h.webGL_texture=null;(k=this.runtime.findWaitingTexture(t[0]))?h.texture_img=k:(h.texture_img=new Image,h.texture_img.cr_src=t[0],h.texture_img.cr_filesize=t[1],h.texture_img.c2webGL_texture=null,this.runtime.waitForImageLoad(h.texture_img,
t[0]));cr.seal(h);f.frames.push(h);this.all_frames.push(h)}cr.seal(f);this.animations[d]=f}}};c.updateAllCurrentTexture=function(){var a;var b=0;for(a=this.instances.length;b<a;b++){var c=this.instances[b];c.curWebGLTexture=c.curFrame.webGL_texture}};c.onLostWebGLContext=function(){if(!this.is_family){var a;var b=0;for(a=this.all_frames.length;b<a;++b){var c=this.all_frames[b];c.texture_img.c2webGL_texture=null;c.webGL_texture=null}this.has_loaded_textures=!1;this.updateAllCurrentTexture()}};c.onRestoreWebGLContext=
function(){if(!this.is_family&&this.instances.length){var a;var b=0;for(a=this.all_frames.length;b<a;++b){var c=this.all_frames[b];c.webGL_texture=this.runtime.glwrap.loadTexture(c.texture_img,!1,this.runtime.linearSampling,c.pixelformat)}this.updateAllCurrentTexture()}};c.loadTextures=function(){if(!this.is_family&&!this.has_loaded_textures&&this.runtime.glwrap){var a;var b=0;for(a=this.all_frames.length;b<a;++b){var c=this.all_frames[b];c.webGL_texture=this.runtime.glwrap.loadTexture(c.texture_img,
!1,this.runtime.linearSampling,c.pixelformat)}this.has_loaded_textures=!0}};c.unloadTextures=function(){if(!this.is_family&&!this.instances.length&&this.has_loaded_textures){var a;var b=0;for(a=this.all_frames.length;b<a;++b){var c=this.all_frames[b];this.runtime.glwrap.deleteTexture(c.webGL_texture);c.webGL_texture=null}this.has_loaded_textures=!1}};var f=[];c.preloadCanvas2D=function(a){var b;cr.clearArray(f);var c=0;for(b=this.all_frames.length;c<b;++c){var d=this.all_frames[c].texture_img;-1===
f.indexOf(d)&&(a.drawImage(d,0,0),f.push(d))}};r.Instance=function(a){this.type=a;this.runtime=a.runtime;a=this.type.animations[0].frames[0].poly_pts;this.recycled?this.collision_poly.set_pts(a):this.collision_poly=new cr.CollisionPoly(a)};var q=r.Instance.prototype;q.onCreate=function(){this.visible=0===this.properties[0];this.inAnimTrigger=this.isTicking=!1;this.collisionsEnabled=0!==this.properties[3];this.cur_animation=this.getAnimationByName(this.properties[1])||this.type.animations[0];this.cur_frame=
this.properties[2];0>this.cur_frame&&(this.cur_frame=0);this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1);var a=this.cur_animation.frames[this.cur_frame];this.collision_poly.set_pts(a.poly_pts);this.hotspotX=a.hotspotX;this.hotspotY=a.hotspotY;this.cur_anim_speed=this.cur_animation.speed;this.cur_anim_repeatto=this.cur_animation.repeatto;1===this.type.animations.length&&1===this.type.animations[0].frames.length||0===this.cur_anim_speed||(this.runtime.tickMe(this),
this.isTicking=!0);this.recycled?this.animTimer.reset():this.animTimer=new cr.KahanAdder;this.frameStart=this.getNowTime();this.animPlaying=!0;this.animRepeats=0;this.animForwards=!0;this.changeAnimName=this.animTriggerName="";this.changeAnimFrom=0;this.changeAnimFrame=-1;this.type.loadTextures();var b,c;a=0;for(b=this.type.animations.length;a<b;a++){var d=this.type.animations[a];var e=0;for(c=d.frames.length;e<c;e++){var f=d.frames[e];0===f.width&&(f.width=f.texture_img.width,f.height=f.texture_img.height);
if(f.spritesheeted){var g=f.texture_img;var t=f.sheetTex;t.left=f.offx/g.width;t.top=f.offy/g.height;t.right=(f.offx+f.width)/g.width;t.bottom=(f.offy+f.height)/g.height;0===f.offx&&0===f.offy&&f.width===g.width&&f.height===g.height&&(f.spritesheeted=!1)}}}this.curFrame=this.cur_animation.frames[this.cur_frame];this.curWebGLTexture=this.curFrame.webGL_texture};q.saveToJSON=function(){var a={a:this.cur_animation.sid,f:this.cur_frame,cas:this.cur_anim_speed,fs:this.frameStart,ar:this.animRepeats,at:this.animTimer.sum,
rt:this.cur_anim_repeatto};this.animPlaying||(a.ap=this.animPlaying);this.animForwards||(a.af=this.animForwards);return a};q.loadFromJSON=function(a){var b=this.getAnimationBySid(a.a);b&&(this.cur_animation=b);this.cur_frame=a.f;0>this.cur_frame&&(this.cur_frame=0);this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1);this.cur_anim_speed=a.cas;this.frameStart=a.fs;this.animRepeats=a.ar;this.animTimer.reset();this.animTimer.sum=a.at;this.animPlaying=
a.hasOwnProperty("ap")?a.ap:!0;this.animForwards=a.hasOwnProperty("af")?a.af:!0;a.hasOwnProperty("rt")?this.cur_anim_repeatto=a.rt:this.cur_anim_repeatto=this.cur_animation.repeatto;this.curFrame=this.cur_animation.frames[this.cur_frame];this.curWebGLTexture=this.curFrame.webGL_texture;this.collision_poly.set_pts(this.curFrame.poly_pts);this.hotspotX=this.curFrame.hotspotX;this.hotspotY=this.curFrame.hotspotY};q.animationFinish=function(a){this.cur_frame=a?0:this.cur_animation.frames.length-1;this.animPlaying=
!1;this.animTriggerName=this.cur_animation.name;this.inAnimTrigger=!0;this.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnAnyAnimFinished,this);this.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnAnimFinished,this);this.inAnimTrigger=!1;this.animRepeats=0};q.getNowTime=function(){return this.animTimer.sum};q.tick=function(){this.animTimer.add(this.runtime.getDt(this));this.changeAnimName.length&&this.doChangeAnim();0<=this.changeAnimFrame&&this.doChangeAnimFrame();var a=this.getNowTime(),
b=this.cur_animation,c=b.frames[this.cur_frame],d=c.duration/this.cur_anim_speed;this.animPlaying&&a>=this.frameStart+d&&(this.animForwards?this.cur_frame++:this.cur_frame--,this.frameStart+=d,this.cur_frame>=b.frames.length&&(b.pingpong?(this.animForwards=!1,this.cur_frame=b.frames.length-2):b.loop?this.cur_frame=this.cur_anim_repeatto:(this.animRepeats++,this.animRepeats>=b.repeatcount?this.animationFinish(!1):this.cur_frame=this.cur_anim_repeatto)),0>this.cur_frame&&(b.pingpong?(this.cur_frame=
1,this.animForwards=!0,b.loop||(this.animRepeats++,this.animRepeats>=b.repeatcount&&this.animationFinish(!0))):b.loop?this.cur_frame=this.cur_anim_repeatto:(this.animRepeats++,this.animRepeats>=b.repeatcount?this.animationFinish(!0):this.cur_frame=this.cur_anim_repeatto)),0>this.cur_frame?this.cur_frame=0:this.cur_frame>=b.frames.length&&(this.cur_frame=b.frames.length-1),a>this.frameStart+b.frames[this.cur_frame].duration/this.cur_anim_speed&&(this.frameStart=a),a=b.frames[this.cur_frame],this.OnFrameChanged(c,
a),this.runtime.redraw=!0)};q.getAnimationByName=function(a){var b;var c=0;for(b=this.type.animations.length;c<b;c++){var d=this.type.animations[c];if(cr.equals_nocase(d.name,a))return d}return null};q.getAnimationBySid=function(a){var b;var c=0;for(b=this.type.animations.length;c<b;c++){var d=this.type.animations[c];if(d.sid===a)return d}return null};q.doChangeAnim=function(){var a=this.cur_animation.frames[this.cur_frame],b=this.getAnimationByName(this.changeAnimName);this.changeAnimName="";!b||
cr.equals_nocase(b.name,this.cur_animation.name)&&this.animPlaying||(this.cur_animation=b,this.cur_anim_speed=b.speed,this.cur_anim_repeatto=b.repeatto,0>this.cur_frame&&(this.cur_frame=0),this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1),1===this.changeAnimFrom&&(this.cur_frame=0),this.animPlaying=!0,this.frameStart=this.getNowTime(),this.animForwards=!0,this.OnFrameChanged(a,this.cur_animation.frames[this.cur_frame]),this.runtime.redraw=!0)};q.doChangeAnimFrame=
function(){var a=this.cur_animation.frames[this.cur_frame],b=this.cur_frame;this.cur_frame=cr.floor(this.changeAnimFrame);0>this.cur_frame&&(this.cur_frame=0);this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1);b!==this.cur_frame&&(this.OnFrameChanged(a,this.cur_animation.frames[this.cur_frame]),this.frameStart=this.getNowTime(),this.runtime.redraw=!0);this.changeAnimFrame=-1};q.OnFrameChanged=function(a,b){var c=a.width,d=a.height,f=b.width,e=b.height;
c!=f&&(this.width*=f/c);d!=e&&(this.height*=e/d);this.hotspotX=b.hotspotX;this.hotspotY=b.hotspotY;this.collision_poly.set_pts(b.poly_pts);this.set_bbox_changed();this.curFrame=b;this.curWebGLTexture=b.webGL_texture;c=0;for(d=this.behavior_insts.length;c<d;c++)if(f=this.behavior_insts[c],f.onSpriteFrameChanged)f.onSpriteFrameChanged(a,b);this.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnFrameChanged,this)};q.draw=function(a){a.globalAlpha=this.opacity;var b=this.curFrame,c=b.spritesheeted,
d=b.texture_img,f=this.x,e=this.y,g=this.width,t=this.height;if(0===this.angle&&0<=g&&0<=t)f-=this.hotspotX*g,e-=this.hotspotY*t,this.runtime.pixel_rounding&&(f=Math.round(f),e=Math.round(e)),c?a.drawImage(d,b.offx,b.offy,b.width,b.height,f,e,g,t):a.drawImage(d,f,e,g,t);else{this.runtime.pixel_rounding&&(f=Math.round(f),e=Math.round(e));a.save();var h=0<g?1:-1,k=0<t?1:-1;a.translate(f,e);1===h&&1===k||a.scale(h,k);a.rotate(this.angle*h*k);f=-(this.hotspotX*cr.abs(g));e=-(this.hotspotY*cr.abs(t));
c?a.drawImage(d,b.offx,b.offy,b.width,b.height,f,e,cr.abs(g),cr.abs(t)):a.drawImage(d,f,e,cr.abs(g),cr.abs(t));a.restore()}};q.drawGL_earlyZPass=function(a){this.drawGL(a)};q.drawGL=function(a){a.setTexture(this.curWebGLTexture);a.setOpacity(this.opacity);var b=this.curFrame,c=this.bquad;if(this.runtime.pixel_rounding){var d=Math.round(this.x)-this.x,f=Math.round(this.y)-this.y;b.spritesheeted?a.quadTex(c.tlx+d,c.tly+f,c.trx+d,c.try_+f,c.brx+d,c.bry+f,c.blx+d,c.bly+f,b.sheetTex):a.quad(c.tlx+d,c.tly+
f,c.trx+d,c.try_+f,c.brx+d,c.bry+f,c.blx+d,c.bly+f)}else b.spritesheeted?a.quadTex(c.tlx,c.tly,c.trx,c.try_,c.brx,c.bry,c.blx,c.bly,b.sheetTex):a.quad(c.tlx,c.tly,c.trx,c.try_,c.brx,c.bry,c.blx,c.bly)};q.getImagePointIndexByName=function(a){var b=this.curFrame,c;var d=0;for(c=b.image_points.length;d<c;d++)if(cr.equals_nocase(a,b.image_points[d][0]))return d;return-1};q.getImagePoint=function(a,b){var c=this.curFrame,d=c.image_points;var f=cr.is_string(a)?this.getImagePointIndexByName(a):a-1;f=cr.floor(f);
if(0>f||f>=d.length)return b?this.x:this.y;a=(d[f][1]-c.hotspotX)*this.width;d=d[f][2];d=(d-c.hotspotY)*this.height;c=Math.cos(this.angle);f=Math.sin(this.angle);var e=a*c-d*f;d=d*c+a*f;a=e+this.x;d+=this.y;return b?a:d};var y=[],z=-2,x=[];b.prototype.OnCollision=function(a){if(!a)return!1;var b=this.runtime,c=b.getCurrentCondition(),d=c.type,f=null;c.extra.collmemory?f=c.extra.collmemory:(f={},c.extra.collmemory=f);c.extra.spriteCreatedDestroyCallback||(c.extra.spriteCreatedDestroyCallback=!0,b.addDestroyCallback(function(a){var b=
c.extra.collmemory;a=a.uid;var d;for(d in b)if(b.hasOwnProperty(d)){var f=b[d];if(f[0]===a||f[1]===a)e(b[d]),delete b[d]}}));var t=d.getCurrentSol(),k=a.getCurrentSol();t=t.getObjects();var l,r,q=this.runtime.tickcount,A=q-1,v=b.getCurrentEventStack().current_event;for(l=0;l<t.length;l++){var B=t[l];if(k.select_all){B.update_bbox();this.runtime.getCollisionCandidates(B.layer,a,B.bbox,x);var u=x;this.runtime.addRegisteredCollisionCandidates(B,a,u)}else u=k.getObjects();for(r=0;r<u.length;r++){var y=
u[r];if(b.testOverlap(B,y)||b.checkRegisteredCollision(B,y)){var E=g(f,B,y);E=!E||z<A;h(f,B,y,q);if(E){b.pushCopySol(v.solModifiers);E=d.getCurrentSol();var C=a.getCurrentSol();E.select_all=!1;C.select_all=!1;d===a?(E.instances.length=2,E.instances[0]=B,E.instances[1]=y,d.applySolToContainer()):(E.instances.length=1,C.instances.length=1,E.instances[0]=B,C.instances[0]=y,d.applySolToContainer(),a.applySolToContainer());v.retrigger();b.popSol(v.solModifiers)}}else n(f,B,y)}cr.clearArray(x)}return!1};
var C=null,v=new cr.ObjectSet,t=!1,A=[],B=new cr.rect(0,0,0,0);c.finish=function(a){if(t){if(a){var b=this.runtime.getCurrentEventStack().current_event.orblock;a=C.getCurrentSol();var c=v.valuesRef(),d;if(a.select_all){a.select_all=!1;cr.clearArray(a.instances);var f=0;for(d=c.length;f<d;++f)a.instances[f]=c[f];if(b)for(cr.clearArray(a.else_instances),f=0,d=C.instances.length;f<d;++f)c=C.instances[f],v.contains(c)||a.else_instances.push(c)}else if(b)for(b=a.instances.length,f=0,d=c.length;f<d;++f)a.instances[b+
f]=c[f],cr.arrayFindRemove(a.else_instances,c[f]);else cr.shallowAssignArray(a.instances,c);C.applySolToContainer()}v.clear();t=!1}};b.prototype.IsOverlapping=function(a){return d.call(this,a,0,0)};b.prototype.IsOverlappingOffset=function(a,b,c){return d.call(this,a,b,c)};b.prototype.IsAnimPlaying=function(a){return this.changeAnimName.length?cr.equals_nocase(this.changeAnimName,a):cr.equals_nocase(this.cur_animation.name,a)};b.prototype.CompareFrame=function(a,b){return cr.do_cmp(this.cur_frame,
a,b)};b.prototype.CompareAnimSpeed=function(a,b){return cr.do_cmp(this.animForwards?this.cur_anim_speed:-this.cur_anim_speed,a,b)};b.prototype.OnAnimFinished=function(a){return cr.equals_nocase(this.animTriggerName,a)};b.prototype.OnAnyAnimFinished=function(){return!0};b.prototype.OnFrameChanged=function(){return!0};b.prototype.IsMirrored=function(){return 0>this.width};b.prototype.IsFlipped=function(){return 0>this.height};b.prototype.OnURLLoaded=function(){return!0};b.prototype.IsCollisionEnabled=
function(){return this.collisionsEnabled};r.cnds=new b;k.prototype.Spawn=function(a,b,c){if(a&&b&&(b=this.runtime.createInstance(a,b,this.getImagePoint(c,!0),this.getImagePoint(c,!1)))){"undefined"!==typeof b.angle&&(b.angle=this.angle,b.set_bbox_changed());this.runtime.isInOnDestroy++;var d;this.runtime.trigger(Object.getPrototypeOf(a.plugin).cnds.OnCreated,b);if(b.is_contained){var f=0;for(d=b.siblings.length;f<d;f++){var e=b.siblings[f];this.runtime.trigger(Object.getPrototypeOf(e.type.plugin).cnds.OnCreated,
e)}}this.runtime.isInOnDestroy--;f=this.runtime.getCurrentAction();c=!1;if(cr.is_undefined(f.extra.Spawn_LastExec)||f.extra.Spawn_LastExec<this.runtime.execcount)c=!0,f.extra.Spawn_LastExec=this.runtime.execcount;if(a!=this.type&&(a=a.getCurrentSol(),a.select_all=!1,c?(cr.clearArray(a.instances),a.instances[0]=b):a.instances.push(b),b.is_contained))for(f=0,d=b.siblings.length;f<d;f++)e=b.siblings[f],a=e.type.getCurrentSol(),a.select_all=!1,c?(cr.clearArray(a.instances),a.instances[0]=e):a.instances.push(e)}};
k.prototype.SetEffect=function(a){this.blend_mode=a;this.compositeOp=cr.effectToCompositeOp(a);cr.setGLBlend(this,a,this.runtime.gl);this.runtime.redraw=!0};k.prototype.StopAnim=function(){this.animPlaying=!1};k.prototype.StartAnim=function(a){this.animPlaying=!0;this.frameStart=this.getNowTime();1===a&&0!==this.cur_frame&&(this.changeAnimFrame=0,this.inAnimTrigger||this.doChangeAnimFrame());this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0)};k.prototype.SetAnim=function(a,b){this.changeAnimName=
a;this.changeAnimFrom=b;this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0);this.inAnimTrigger||this.doChangeAnim()};k.prototype.SetAnimFrame=function(a){this.changeAnimFrame=a;this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0);this.inAnimTrigger||this.doChangeAnimFrame()};k.prototype.SetAnimSpeed=function(a){this.cur_anim_speed=cr.abs(a);this.animForwards=0<=a;this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0)};k.prototype.SetAnimRepeatToFrame=function(a){a=Math.floor(a);
0>a&&(a=0);a>=this.cur_animation.frames.length&&(a=this.cur_animation.frames.length-1);this.cur_anim_repeatto=a};k.prototype.SetMirrored=function(a){a=cr.abs(this.width)*(0===a?-1:1);this.width!==a&&(this.width=a,this.set_bbox_changed())};k.prototype.SetFlipped=function(a){a=cr.abs(this.height)*(0===a?-1:1);this.height!==a&&(this.height=a,this.set_bbox_changed())};k.prototype.SetScale=function(a){var b=this.curFrame,c=b.width*a*(0>this.width?-1:1);a=b.height*a*(0>this.height?-1:1);if(this.width!==
c||this.height!==a)this.width=c,this.height=a,this.set_bbox_changed()};k.prototype.LoadURL=function(a,b,c){var d=new Image,f=this,e=this.curFrame;d.onload=function(){e.texture_img.src===d.src?f.runtime.glwrap&&f.curFrame===e&&(f.curWebGLTexture=e.webGL_texture):(e.texture_img=d,e.offx=0,e.offy=0,e.width=d.width,e.height=d.height,e.spritesheeted=!1,e.datauri="",e.pixelformat=0,f.runtime.glwrap&&(e.webGL_texture&&f.runtime.glwrap.deleteTexture(e.webGL_texture),e.webGL_texture=f.runtime.glwrap.loadTexture(d,
!1,f.runtime.linearSampling),f.curFrame===e&&(f.curWebGLTexture=e.webGL_texture),f.type.updateAllCurrentTexture()));0===b&&(f.width=d.width,f.height=d.height,f.set_bbox_changed());f.runtime.redraw=!0;f.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnURLLoaded,f)};"data:"!==a.substr(0,5)&&0===c&&(d.crossOrigin="anonymous");this.runtime.setImageSrc(d,a)};k.prototype.SetCollisions=function(a){this.collisionsEnabled!==(0!==a)&&((this.collisionsEnabled=0!==a)?this.set_bbox_changed():(this.collcells.right>=
this.collcells.left&&this.type.collision_grid.update(this,this.collcells,null),this.collcells.set(0,0,-1,-1)))};r.acts=new k;u.prototype.AnimationFrame=function(a){a.set_int(this.cur_frame)};u.prototype.AnimationFrameCount=function(a){a.set_int(this.cur_animation.frames.length)};u.prototype.AnimationName=function(a){a.set_string(this.cur_animation.name)};u.prototype.AnimationSpeed=function(a){a.set_float(this.animForwards?this.cur_anim_speed:-this.cur_anim_speed)};u.prototype.ImagePointX=function(a,
b){a.set_float(this.getImagePoint(b,!0))};u.prototype.ImagePointY=function(a,b){a.set_float(this.getImagePoint(b,!1))};u.prototype.ImagePointCount=function(a){a.set_int(this.curFrame.image_points.length)};u.prototype.ImageWidth=function(a){a.set_float(this.curFrame.width)};u.prototype.ImageHeight=function(a){a.set_float(this.curFrame.height)};r.exps=new u})();cr.plugins_.Text=function(a){this.runtime=a};
(function(){function a(){return r.length?r.pop():{}}function b(a){var b;var c=0;for(b=a.length;c<b;c++)r.push(a[c]);cr.clearArray(a)}function e(a){return a.length&&" "===a.charAt(a.length-1)?a.substring(0,a.length-1):a}function l(){}function h(){}function n(){}var g=cr.plugins_.Text.prototype;g.onCreate=function(){g.acts.SetWidth=function(a){this.width!==a&&(this.width=a,this.text_changed=!0,this.set_bbox_changed())}};g.Type=function(a){this.plugin=a;this.runtime=a.runtime};var d=g.Type.prototype;
d.onCreate=function(){};d.onLostWebGLContext=function(){if(!this.is_family){var a;var b=0;for(a=this.instances.length;b<a;b++){var d=this.instances[b];d.mycanvas=null;d.myctx=null;d.mytex=null}}};g.Instance=function(a){this.type=a;this.runtime=a.runtime;this.recycled?cr.clearArray(this.lines):this.lines=[];this.text_changed=!0};d=g.Instance.prototype;var k={};d.onCreate=function(){this.text=this.properties[0];this.visible=0===this.properties[1];this.font=this.properties[2];this.color=this.properties[3];
this.halign=this.properties[4];this.valign=this.properties[5];this.wrapbyword=0===this.properties[7];this.lastwrapwidth=this.lastwidth=this.width;this.lastheight=this.height;this.line_height_offset=this.properties[8];this.fontstyle=this.facename="";this.textHeight=this.textWidth=this.ptSize=0;this.parseFont();this.mytex=this.myctx=this.mycanvas=null;this.need_text_redraw=!1;this.last_render_tick=this.runtime.tickcount;this.recycled?this.rcTex.set(0,0,1,1):this.rcTex=new cr.rect(0,0,1,1);this.runtime.glwrap&&
this.runtime.tickMe(this)};d.parseFont=function(){var a=this.font.split(" "),b;for(b=0;b<a.length;b++)if("pt"===a[b].substr(a[b].length-2,2)){this.ptSize=parseInt(a[b].substr(0,a[b].length-2));this.pxHeight=Math.ceil(this.ptSize/72*96)+4;0<b&&(this.fontstyle=a[b-1]);this.facename=a[b+1];for(b+=2;b<a.length;b++)this.facename+=" "+a[b];break}};d.saveToJSON=function(){return{t:this.text,f:this.font,c:this.color,ha:this.halign,va:this.valign,wr:this.wrapbyword,lho:this.line_height_offset,fn:this.facename,
fs:this.fontstyle,ps:this.ptSize,pxh:this.pxHeight,tw:this.textWidth,th:this.textHeight,lrt:this.last_render_tick}};d.loadFromJSON=function(a){this.text=a.t;this.font=a.f;this.color=a.c;this.halign=a.ha;this.valign=a.va;this.wrapbyword=a.wr;this.line_height_offset=a.lho;this.facename=a.fn;this.fontstyle=a.fs;this.ptSize=a.ps;this.pxHeight=a.pxh;this.textWidth=a.tw;this.textHeight=a.th;this.last_render_tick=a.lrt;this.text_changed=!0;this.lastwrapwidth=this.lastwidth=this.width;this.lastheight=this.height};
d.tick=function(){if(this.runtime.glwrap&&this.mytex&&300<=this.runtime.tickcount-this.last_render_tick){var a=this.layer;this.update_bbox();var b=this.bbox;if(b.right<a.viewLeft||b.bottom<a.viewTop||b.left>a.viewRight||b.top>a.viewBottom)this.runtime.glwrap.deleteTexture(this.mytex),this.mycanvas=this.myctx=this.mytex=null}};d.onDestroy=function(){this.mycanvas=this.myctx=null;this.runtime.glwrap&&this.mytex&&this.runtime.glwrap.deleteTexture(this.mytex);this.mytex=null};d.updateFont=function(){this.font=
this.fontstyle+" "+this.ptSize.toString()+"pt "+this.facename;this.text_changed=!0;this.runtime.redraw=!0};d.draw=function(a,b){a.font=this.font;a.textBaseline="top";a.fillStyle=this.color;a.globalAlpha=b?1:this.opacity;if(b){var c=Math.abs(this.layer.getScale());a.save();a.scale(c,c)}if(this.text_changed||this.width!==this.lastwrapwidth)this.type.plugin.WordWrap(this.text,this.lines,a,this.width,this.wrapbyword),this.text_changed=!1,this.lastwrapwidth=this.width;this.update_bbox();c=b?0:this.bquad.tlx;
var d=b?0:this.bquad.tly;this.runtime.pixel_rounding&&(c=c+.5|0,d=d+.5|0);0===this.angle||b||(a.save(),a.translate(c,d),a.rotate(this.angle),d=c=0);var f=d+this.height,e=this.pxHeight;e+=this.line_height_offset;var g;1===this.valign?d+=Math.max(this.height/2-this.lines.length*e/2,0):2===this.valign&&(d+=Math.max(this.height-this.lines.length*e-2,0));for(g=0;g<this.lines.length;g++){var h=c;1===this.halign?h=c+(this.width-this.lines[g].width)/2:2===this.halign&&(h=c+(this.width-this.lines[g].width));
a.fillText(this.lines[g].text,h,d);d+=e;if(d>=f-e)break}(0!==this.angle||b)&&a.restore();this.last_render_tick=this.runtime.tickcount};d.drawGL=function(a){if(!(1>this.width||1>this.height)){var b=this.text_changed||this.need_text_redraw;this.need_text_redraw=!1;var c=this.layer.getScale(),d=this.layer.getAngle(),e=this.rcTex,g=c*this.width,h=c*this.height,k=Math.ceil(g),t=Math.ceil(h),n=Math.abs(k),l=Math.abs(t),r=this.runtime.draw_width/2,m=this.runtime.draw_height/2;this.myctx||(this.mycanvas=
document.createElement("canvas"),this.mycanvas.width=n,this.mycanvas.height=l,this.lastwidth=n,this.lastheight=l,b=!0,this.myctx=this.mycanvas.getContext("2d"));if(n!==this.lastwidth||l!==this.lastheight)this.mycanvas.width=n,this.mycanvas.height=l,this.mytex&&(a.deleteTexture(this.mytex),this.mytex=null),b=!0;b&&(this.myctx.clearRect(0,0,n,l),this.draw(this.myctx,!0),this.mytex||(this.mytex=a.createEmptyTexture(n,l,this.runtime.linearSampling,this.runtime.isMobile)),a.videoToTexture(this.mycanvas,
this.mytex,this.runtime.isMobile));this.lastwidth=n;this.lastheight=l;a.setTexture(this.mytex);a.setOpacity(this.opacity);a.resetModelView();a.translate(-r,-m);a.updateModelView();var p=this.bquad;b=this.layer.layerToCanvas(p.tlx,p.tly,!0,!0);n=this.layer.layerToCanvas(p.tlx,p.tly,!1,!0);l=this.layer.layerToCanvas(p.trx,p.try_,!0,!0);r=this.layer.layerToCanvas(p.trx,p.try_,!1,!0);m=this.layer.layerToCanvas(p.brx,p.bry,!0,!0);var u=this.layer.layerToCanvas(p.brx,p.bry,!1,!0),I=this.layer.layerToCanvas(p.blx,
p.bly,!0,!0);p=this.layer.layerToCanvas(p.blx,p.bly,!1,!0);if(this.runtime.pixel_rounding||0===this.angle&&0===d){var M=(b+.5|0)-b,O=(n+.5|0)-n;b+=M;n+=O;l+=M;r+=O;m+=M;u+=O;I+=M;p+=O}0===this.angle&&0===d?(l=b+k,r=n,m=l,u=n+t,I=b,p=u,e.right=1,e.bottom=1):(e.right=g/k,e.bottom=h/t);a.quadTex(b,n,l,r,m,u,I,p,e);a.resetModelView();a.scale(c,c);a.rotateZ(-this.layer.getAngle());a.translate((this.layer.viewLeft+this.layer.viewRight)/-2,(this.layer.viewTop+this.layer.viewBottom)/-2);a.updateModelView();
this.last_render_tick=this.runtime.tickcount}};var u=[];g.TokeniseWords=function(a){cr.clearArray(u);for(var b="",c,d=0;d<a.length;)if(c=a.charAt(d),"\n"===c)b.length&&(u.push(b),b=""),u.push("\n"),++d;else if(" "===c||"\t"===c||"-"===c){do b+=a.charAt(d),d++;while(d<a.length&&(" "===a.charAt(d)||"\t"===a.charAt(d)));u.push(b);b=""}else d<a.length&&(b+=c,d++);b.length&&u.push(b)};var r=[];g.WordWrap=function(c,d,e,g,h){if(c&&c.length)if(2>=g)b(d);else{if(100>=c.length&&-1===c.indexOf("\n")){var f=
e.measureText(c).width;if(f<=g){b(d);d.push(a());d[0].text=c;d[0].width=f;return}}this.WrapText(c,d,e,g,h)}else b(d)};g.WrapText=function(b,d,g,h,k){k&&(this.TokeniseWords(b),b=u);var c="",f,n=0;for(f=0;f<b.length;f++)if("\n"===b[f]){n>=d.length&&d.push(a());c=e(c);var t=d[n];t.text=c;t.width=g.measureText(c).width;n++;c=""}else{var l=c;c+=b[f];t=g.measureText(c).width;t>=h&&(n>=d.length&&d.push(a()),l=e(l),t=d[n],t.text=l,t.width=g.measureText(l).width,n++,c=b[f],k||" "!==c||(c=""))}c.length&&(n>=
d.length&&d.push(a()),c=e(c),t=d[n],t.text=c,t.width=g.measureText(c).width,n++);for(f=n;f<d.length;f++)r.push(d[f]);d.length=n};l.prototype.CompareText=function(a,b){return b?this.text==a:cr.equals_nocase(this.text,a)};g.cnds=new l;h.prototype.SetText=function(a){cr.is_number(a)&&1E9>a&&(a=Math.round(1E10*a)/1E10);a=a.toString();this.text!==a&&(this.text=a,this.text_changed=!0,this.runtime.redraw=!0)};h.prototype.AppendText=function(a){cr.is_number(a)&&(a=Math.round(1E10*a)/1E10);if(a=a.toString())this.text+=
a,this.text_changed=!0,this.runtime.redraw=!0};h.prototype.SetFontFace=function(a,b){var c="";switch(b){case 1:c="bold";break;case 2:c="italic";break;case 3:c="bold italic"}if(a!==this.facename||c!==this.fontstyle)this.facename=a,this.fontstyle=c,this.updateFont()};h.prototype.SetFontSize=function(a){this.ptSize!==a&&(this.ptSize=a,this.pxHeight=Math.ceil(this.ptSize/72*96)+4,this.updateFont())};h.prototype.SetFontColor=function(a){a="rgb("+cr.GetRValue(a).toString()+","+cr.GetGValue(a).toString()+
","+cr.GetBValue(a).toString()+")";a!==this.color&&(this.color=a,this.need_text_redraw=!0,this.runtime.redraw=!0)};h.prototype.SetWebFont=function(a,b){if(this.runtime.isDomFree)cr.logexport("[Construct 2] Text plugin: 'Set web font' not supported on this platform - the action has been ignored");else{var c=this,d=function(){c.runtime.redraw=!0;c.text_changed=!0};if(k.hasOwnProperty(b)){if(a="'"+a+"'",this.facename!==a)for(this.facename=a,this.updateFont(),a=1;10>a;a++)setTimeout(d,100*a),setTimeout(d,
1E3*a)}else{var e=document.createElement("link");e.href=b;e.rel="stylesheet";e.type="text/css";e.onload=d;document.getElementsByTagName("head")[0].appendChild(e);k[b]=!0;this.facename="'"+a+"'";this.updateFont();for(a=1;10>a;a++)setTimeout(d,100*a),setTimeout(d,1E3*a)}}};h.prototype.SetEffect=function(a){this.blend_mode=a;this.compositeOp=cr.effectToCompositeOp(a);cr.setGLBlend(this,a,this.runtime.gl);this.runtime.redraw=!0};g.acts=new h;n.prototype.Text=function(a){a.set_string(this.text)};n.prototype.FaceName=
function(a){a.set_string(this.facename)};n.prototype.FaceSize=function(a){a.set_int(this.ptSize)};n.prototype.TextWidth=function(a){var b=0,c;var d=0;for(c=this.lines.length;d<c;d++){var e=this.lines[d].width;b<e&&(b=e)}a.set_int(b)};n.prototype.TextHeight=function(a){a.set_int(this.lines.length*(this.pxHeight+this.line_height_offset)-this.line_height_offset)};g.exps=new n})();cr.plugins_.TiledBg=function(a){this.runtime=a};
(function(){function a(){}function b(){}function e(){}var l=cr.plugins_.TiledBg.prototype;l.Type=function(a){this.plugin=a;this.runtime=a.runtime};var h=l.Type.prototype;h.onCreate=function(){this.is_family||(this.texture_img=new Image,this.texture_img.cr_filesize=this.texture_filesize,this.runtime.waitForImageLoad(this.texture_img,this.texture_file),this.webGL_texture=this.pattern=null)};h.onLostWebGLContext=function(){this.is_family||(this.webGL_texture=null)};h.onRestoreWebGLContext=function(){if(!this.is_family&&
this.instances.length){this.webGL_texture||(this.webGL_texture=this.runtime.glwrap.loadTexture(this.texture_img,!0,this.runtime.linearSampling,this.texture_pixelformat));var a;var b=0;for(a=this.instances.length;b<a;b++)this.instances[b].webGL_texture=this.webGL_texture}};h.loadTextures=function(){this.is_family||this.webGL_texture||!this.runtime.glwrap||(this.webGL_texture=this.runtime.glwrap.loadTexture(this.texture_img,!0,this.runtime.linearSampling,this.texture_pixelformat))};h.unloadTextures=
function(){this.is_family||this.instances.length||!this.webGL_texture||(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null)};h.preloadCanvas2D=function(a){a.drawImage(this.texture_img,0,0)};l.Instance=function(a){this.type=a;this.runtime=a.runtime};h=l.Instance.prototype;h.onCreate=function(){this.visible=0===this.properties[0];this.rcTex=new cr.rect(0,0,0,0);this.has_own_texture=!1;this.texture_img=this.type.texture_img;this.runtime.glwrap?(this.type.loadTextures(),this.webGL_texture=
this.type.webGL_texture):(this.type.pattern||(this.type.pattern=this.runtime.ctx.createPattern(this.type.texture_img,"repeat")),this.pattern=this.type.pattern)};h.afterLoad=function(){this.has_own_texture=!1;this.texture_img=this.type.texture_img};h.onDestroy=function(){this.runtime.glwrap&&this.has_own_texture&&this.webGL_texture&&(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null)};h.draw=function(a){a.globalAlpha=this.opacity;a.save();a.fillStyle=this.pattern;var b=
this.x,d=this.y;this.runtime.pixel_rounding&&(b=Math.round(b),d=Math.round(d));var e=-(this.hotspotX*this.width),h=-(this.hotspotY*this.height),n=e%this.texture_img.width,c=h%this.texture_img.height;0>n&&(n+=this.texture_img.width);0>c&&(c+=this.texture_img.height);a.translate(b,d);a.rotate(this.angle);a.translate(n,c);a.fillRect(e-n,h-c,this.width,this.height);a.restore()};h.drawGL_earlyZPass=function(a){this.drawGL(a)};h.drawGL=function(a){a.setTexture(this.webGL_texture);a.setOpacity(this.opacity);
var b=this.rcTex;b.right=this.width/this.texture_img.width;b.bottom=this.height/this.texture_img.height;var d=this.bquad;if(this.runtime.pixel_rounding){var e=Math.round(this.x)-this.x,h=Math.round(this.y)-this.y;a.quadTex(d.tlx+e,d.tly+h,d.trx+e,d.try_+h,d.brx+e,d.bry+h,d.blx+e,d.bly+h,b)}else a.quadTex(d.tlx,d.tly,d.trx,d.try_,d.brx,d.bry,d.blx,d.bly,b)};a.prototype.OnURLLoaded=function(){return!0};l.cnds=new a;b.prototype.SetEffect=function(a){this.blend_mode=a;this.compositeOp=cr.effectToCompositeOp(a);
cr.setGLBlend(this,a,this.runtime.gl);this.runtime.redraw=!0};b.prototype.LoadURL=function(a,b){var d=new Image,e=this;d.onload=function(){e.texture_img=d;e.runtime.glwrap?(e.has_own_texture&&e.webGL_texture&&e.runtime.glwrap.deleteTexture(e.webGL_texture),e.webGL_texture=e.runtime.glwrap.loadTexture(d,!0,e.runtime.linearSampling)):e.pattern=e.runtime.ctx.createPattern(d,"repeat");e.has_own_texture=!0;e.runtime.redraw=!0;e.runtime.trigger(cr.plugins_.TiledBg.prototype.cnds.OnURLLoaded,e)};"data:"!==
a.substr(0,5)&&0===b&&(d.crossOrigin="anonymous");this.runtime.setImageSrc(d,a)};l.acts=new b;e.prototype.ImageWidth=function(a){a.set_float(this.texture_img.width)};e.prototype.ImageHeight=function(a){a.set_float(this.texture_img.height)};l.exps=new e})();cr.plugins_.Touch=function(a){this.runtime=a};
(function(){function a(a){r=a.x;c=a.y;f=a.z}function b(a,b,c,d){var f=q.length?q.pop():new e;f.init(a,b,c,d);return f}function e(){this.startindex=this.id=this.lasty=this.lastx=this.y=this.x=this.starty=this.startx=this.lasttime=this.time=this.starttime=0;this.tooFarForHold=this.triggeredHold=!1}function l(a){return a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||a.originalEvent&&a.originalEvent.sourceCapabilities&&a.originalEvent.sourceCapabilities.firesTouchEvents}function h(){}function n(){}
function g(){}var d=cr.plugins_.Touch.prototype;d.Type=function(a){this.plugin=a;this.runtime=a.runtime};d.Type.prototype.onCreate=function(){};d.Instance=function(a){this.type=a;this.runtime=a.runtime;this.touches=[];this.mouseDown=!1};var k=d.Instance.prototype,u={left:0,top:0};k.findTouch=function(a){var b;var c=0;for(b=this.touches.length;c<b;c++)if(this.touches[c].id===a)return c;return-1};var r=0,c=0,f=0,q=[];e.prototype.init=function(a,b,c,d){var e=cr.performance_now();this.starttime=this.lasttime=
this.time=e;this.startx=a;this.starty=b;this.x=a;this.y=b;this.lastx=a;this.lasty=b;this.pressure=this.height=this.width=0;this.id=c;this.startindex=d;this.tooFarForHold=this.triggeredHold=!1};e.prototype.update=function(a,b,c,d,e,f){this.lasttime=this.time;this.time=a;this.lastx=this.x;this.lasty=this.y;this.x=b;this.y=c;this.width=d;this.height=e;this.pressure=f;!this.tooFarForHold&&15<=cr.distanceTo(this.startx,this.starty,this.x,this.y)&&(this.tooFarForHold=!0)};e.prototype.maybeTriggerHold=function(a,
b){!this.triggeredHold&&500<=cr.performance_now()-this.starttime&&!this.tooFarForHold&&15>cr.distanceTo(this.startx,this.starty,this.x,this.y)&&(this.triggeredHold=!0,a.trigger_index=this.startindex,a.trigger_id=this.id,a.getTouchIndex=b,a.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnHoldGesture,a),a.curTouchX=this.x,a.curTouchY=this.y,a.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnHoldGestureObject,a),a.getTouchIndex=0)};var y=-1E3,z=-1E3,x=-1E4;e.prototype.maybeTriggerTap=function(a,
b){if(!this.triggeredHold){var c=cr.performance_now();333>=c-this.starttime&&!this.tooFarForHold&&15>cr.distanceTo(this.startx,this.starty,this.x,this.y)&&(a.trigger_index=this.startindex,a.trigger_id=this.id,a.getTouchIndex=b,666>=c-x&&25>cr.distanceTo(y,z,this.x,this.y)?(a.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnDoubleTapGesture,a),a.curTouchX=this.x,a.curTouchY=this.y,a.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnDoubleTapGestureObject,a),z=y=-1E3,x=-1E4):(a.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTapGesture,
a),a.curTouchX=this.x,a.curTouchY=this.y,a.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTapGestureObject,a),y=this.x,z=this.y,x=c),a.getTouchIndex=0)}};k.onCreate=function(){this.isWindows8=!("undefined"===typeof window.c2isWindows8||!window.c2isWindows8);this.getTouchIndex=this.trigger_permission=this.trigger_id=this.trigger_index=this.curTouchY=this.curTouchX=this.acc_z=this.acc_y=this.acc_x=this.acc_g_z=this.acc_g_y=this.acc_g_x=this.orient_gamma=this.orient_beta=this.orient_alpha=0;this.useMouseInput=
0!==this.properties[0];var b=0<this.runtime.fullscreen_mode?document:this.runtime.canvas,c=document;this.runtime.isDirectCanvas?c=b=window.Canvas:this.runtime.isCocoonJs&&(c=b=window);var d=this;"undefined"!==typeof PointerEvent?(b.addEventListener("pointerdown",function(a){d.onPointerStart(a)},!1),b.addEventListener("pointermove",function(a){d.onPointerMove(a)},!1),c.addEventListener("pointerup",function(a){d.onPointerEnd(a,!1)},!1),c.addEventListener("pointercancel",function(a){d.onPointerEnd(a,
!0)},!1),this.runtime.canvas&&(this.runtime.canvas.addEventListener("MSGestureHold",function(a){a.preventDefault()},!1),document.addEventListener("MSGestureHold",function(a){a.preventDefault()},!1),this.runtime.canvas.addEventListener("gesturehold",function(a){a.preventDefault()},!1),document.addEventListener("gesturehold",function(a){a.preventDefault()},!1))):window.navigator.msPointerEnabled?(b.addEventListener("MSPointerDown",function(a){d.onPointerStart(a)},!1),b.addEventListener("MSPointerMove",
function(a){d.onPointerMove(a)},!1),c.addEventListener("MSPointerUp",function(a){d.onPointerEnd(a,!1)},!1),c.addEventListener("MSPointerCancel",function(a){d.onPointerEnd(a,!0)},!1),this.runtime.canvas&&(this.runtime.canvas.addEventListener("MSGestureHold",function(a){a.preventDefault()},!1),document.addEventListener("MSGestureHold",function(a){a.preventDefault()},!1))):(b.addEventListener("touchstart",function(a){d.onTouchStart(a)},!1),b.addEventListener("touchmove",function(a){d.onTouchMove(a)},
!1),c.addEventListener("touchend",function(a){d.onTouchEnd(a,!1)},!1),c.addEventListener("touchcancel",function(a){d.onTouchEnd(a,!0)},!1));if(this.isWindows8){var e=function(a){a=a.reading;d.acc_x=a.accelerationX;d.acc_y=a.accelerationY;d.acc_z=a.accelerationZ},f=function(a){a=a.reading;d.orient_alpha=a.yawDegrees;d.orient_beta=a.pitchDegrees;d.orient_gamma=a.rollDegrees},g=Windows.Devices.Sensors.Accelerometer.getDefault();g&&(g.reportInterval=Math.max(g.minimumReportInterval,16),g.addEventListener("readingchanged",
e));var h=Windows.Devices.Sensors.Inclinometer.getDefault();h&&(h.reportInterval=Math.max(h.minimumReportInterval,16),h.addEventListener("readingchanged",f));document.addEventListener("visibilitychange",function(a){document.hidden||document.msHidden?(g&&g.removeEventListener("readingchanged",e),h&&h.removeEventListener("readingchanged",f)):(g&&g.addEventListener("readingchanged",e),h&&h.addEventListener("readingchanged",f))},!1)}else window.addEventListener("deviceorientation",function(a){d.orient_alpha=
a.alpha||0;d.orient_beta=a.beta||0;d.orient_gamma=a.gamma||0},!1),window.addEventListener("devicemotion",function(a){a.accelerationIncludingGravity&&(d.acc_g_x=a.accelerationIncludingGravity.x||0,d.acc_g_y=a.accelerationIncludingGravity.y||0,d.acc_g_z=a.accelerationIncludingGravity.z||0);a.acceleration&&(d.acc_x=a.acceleration.x||0,d.acc_y=a.acceleration.y||0,d.acc_z=a.acceleration.z||0)},!1);this.useMouseInput&&!this.runtime.isDomFree&&(jQuery(document).mousemove(function(a){d.onMouseMove(a)}),jQuery(document).mousedown(function(a){d.onMouseDown(a)}),
jQuery(document).mouseup(function(a){d.onMouseUp(a)}));!this.runtime.isiOS&&this.runtime.isCordova&&navigator.accelerometer&&navigator.accelerometer.watchAcceleration&&navigator.accelerometer.watchAcceleration(a,null,{frequency:40});this.runtime.tick2Me(this)};k.onPointerMove=function(a){if(a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType){a.preventDefault&&a.preventDefault();var b=this.findTouch(a.pointerId),c=cr.performance_now();if(0<=b){var d=this.runtime.isDomFree?u:jQuery(this.runtime.canvas).offset();
b=this.touches[b];2>c-b.time||b.update(c,a.pageX-d.left,a.pageY-d.top,a.width||0,a.height||0,a.pressure||0)}}};k.onPointerStart=function(a){if(a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType){a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault();var c=this.runtime.isDomFree?u:jQuery(this.runtime.canvas).offset(),d=a.pageX-c.left;c=a.pageY-c.top;cr.performance_now();this.trigger_index=this.touches.length;this.trigger_id=a.pointerId;this.touches.push(b(d,c,a.pointerId,this.trigger_index));
this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchStart,this);this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchStart,this);this.curTouchX=d;this.curTouchY=c;this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchObject,this);this.runtime.isInUserInputEvent=!1}};k.onPointerEnd=function(a,b){a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType&&(a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault(),a=this.findTouch(a.pointerId),
this.trigger_index=0<=a?this.touches[a].startindex:-1,this.trigger_id=0<=a?this.touches[a].id:-1,this.runtime.isInUserInputEvent=!0,this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchEnd,this),this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchEnd,this),0<=a&&(b||this.touches[a].maybeTriggerTap(this,a),100>q.length&&q.push(this.touches[a]),this.touches.splice(a,1)),this.runtime.isInUserInputEvent=!1)};k.onTouchMove=function(a){a.preventDefault&&a.preventDefault();var b=cr.performance_now(),
c;var d=0;for(c=a.changedTouches.length;d<c;d++){var e=a.changedTouches[d];var f=this.findTouch(e.identifier);if(0<=f){var g=this.runtime.isDomFree?u:jQuery(this.runtime.canvas).offset();f=this.touches[f];2>b-f.time||f.update(b,e.pageX-g.left,e.pageY-g.top,2*(e.radiusX||e.webkitRadiusX||e.mozRadiusX||e.msRadiusX||0),2*(e.radiusY||e.webkitRadiusY||e.mozRadiusY||e.msRadiusY||0),e.force||e.webkitForce||e.mozForce||e.msForce||0)}}};k.onTouchStart=function(a){a.preventDefault&&cr.isCanvasInputEvent(a)&&
a.preventDefault();var c=this.runtime.isDomFree?u:jQuery(this.runtime.canvas).offset();cr.performance_now();this.runtime.isInUserInputEvent=!0;var d;var e=0;for(d=a.changedTouches.length;e<d;e++){var f=a.changedTouches[e];var g=this.findTouch(f.identifier);if(-1===g){g=f.pageX-c.left;var h=f.pageY-c.top;this.trigger_index=this.touches.length;this.trigger_id=f.identifier;this.touches.push(b(g,h,f.identifier,this.trigger_index));this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchStart,
this);this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchStart,this);this.curTouchX=g;this.curTouchY=h;this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchObject,this)}}this.runtime.isInUserInputEvent=!1};k.onTouchEnd=function(a,b){a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault();this.runtime.isInUserInputEvent=!0;var c;var d=0;for(c=a.changedTouches.length;d<c;d++){var e=a.changedTouches[d];e=this.findTouch(e.identifier);0<=e&&(this.trigger_index=this.touches[e].startindex,
this.trigger_id=this.touches[e].id,this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchEnd,this),this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchEnd,this),b||this.touches[e].maybeTriggerTap(this,e),100>q.length&&q.push(this.touches[e]),this.touches.splice(e,1))}this.runtime.isInUserInputEvent=!1};k.getAlpha=function(){return this.runtime.isCordova&&0===this.orient_alpha&&0!==f?90*f:this.orient_alpha};k.getBeta=function(){return this.runtime.isCordova&&0===this.orient_beta&&
0!==c?90*c:this.orient_beta};k.getGamma=function(){return this.runtime.isCordova&&0===this.orient_gamma&&0!==r?90*r:this.orient_gamma};k.onMouseDown=function(a){l(a)||(this.onTouchStart({changedTouches:[{pageX:a.pageX,pageY:a.pageY,identifier:0}]}),this.mouseDown=!0)};k.onMouseMove=function(a){if(this.mouseDown&&!l(a))this.onTouchMove({changedTouches:[{pageX:a.pageX,pageY:a.pageY,identifier:0}]})};k.onMouseUp=function(a){a.preventDefault&&this.runtime.had_a_click&&!this.runtime.isMobile&&a.preventDefault();
this.runtime.had_a_click=!0;l(a)||(this.onTouchEnd({changedTouches:[{pageX:a.pageX,pageY:a.pageY,identifier:0}]}),this.mouseDown=!1)};k.tick2=function(){var a,b=cr.performance_now();var c=0;for(a=this.touches.length;c<a;++c){var d=this.touches[c];d.time<=b-50&&(d.lasttime=b);d.maybeTriggerHold(this,c)}};h.prototype.OnTouchStart=function(){return!0};h.prototype.OnTouchEnd=function(){return!0};h.prototype.IsInTouch=function(){return this.touches.length};h.prototype.OnTouchObject=function(a){return a?
this.runtime.testAndSelectCanvasPointOverlap(a,this.curTouchX,this.curTouchY,!1):!1};var C=[];h.prototype.IsTouchingObject=function(a){if(!a)return!1;var b=a.getCurrentSol(),c=b.getObjects(),d,e;var f=0;for(d=c.length;f<d;f++){var g=c[f];g.update_bbox();var h=0;for(e=this.touches.length;h<e;h++){var k=this.touches[h];var l=g.layer.canvasToLayer(k.x,k.y,!0);k=g.layer.canvasToLayer(k.x,k.y,!1);if(g.contains_pt(l,k)){C.push(g);break}}}return C.length?(b.select_all=!1,cr.shallowAssignArray(b.instances,
C),a.applySolToContainer(),cr.clearArray(C),!0):!1};h.prototype.CompareTouchSpeed=function(a,b,c){a=Math.floor(a);if(0>a||a>=this.touches.length)return!1;var d=this.touches[a];a=cr.distanceTo(d.x,d.y,d.lastx,d.lasty);d=(d.time-d.lasttime)/1E3;var e=0;0<d&&(e=a/d);return cr.do_cmp(e,b,c)};h.prototype.OrientationSupported=function(){return"undefined"!==typeof window.DeviceOrientationEvent};h.prototype.MotionSupported=function(){return"undefined"!==typeof window.DeviceMotionEvent};h.prototype.CompareOrientation=
function(a,b,c){a=0===a?this.getAlpha():1===a?this.getBeta():this.getGamma();return cr.do_cmp(a,b,c)};h.prototype.CompareAcceleration=function(a,b,c){var d=0;0===a?d=this.acc_g_x:1===a?d=this.acc_g_y:2===a?d=this.acc_g_z:3===a?d=this.acc_x:4===a?d=this.acc_y:5===a&&(d=this.acc_z);return cr.do_cmp(d,b,c)};h.prototype.OnNthTouchStart=function(a){a=Math.floor(a);return a===this.trigger_index};h.prototype.OnNthTouchEnd=function(a){a=Math.floor(a);return a===this.trigger_index};h.prototype.HasNthTouch=
function(a){a=Math.floor(a);return this.touches.length>=a+1};h.prototype.OnHoldGesture=function(){return!0};h.prototype.OnTapGesture=function(){return!0};h.prototype.OnDoubleTapGesture=function(){return!0};h.prototype.OnHoldGestureObject=function(a){return a?this.runtime.testAndSelectCanvasPointOverlap(a,this.curTouchX,this.curTouchY,!1):!1};h.prototype.OnTapGestureObject=function(a){return a?this.runtime.testAndSelectCanvasPointOverlap(a,this.curTouchX,this.curTouchY,!1):!1};h.prototype.OnDoubleTapGestureObject=
function(a){return a?this.runtime.testAndSelectCanvasPointOverlap(a,this.curTouchX,this.curTouchY,!1):!1};h.prototype.OnPermissionGranted=function(a){return this.trigger_permission===a};h.prototype.OnPermissionDenied=function(a){return this.trigger_permission===a};d.cnds=new h;n.prototype.RequestPermission=function(a){var b=this,c=Promise.resolve(!0);0===a?window.DeviceOrientationEvent&&window.DeviceOrientationEvent.requestPermission&&(c=window.DeviceOrientationEvent.requestPermission().then(function(a){return"granted"===
a})):window.DeviceMotionEvent&&window.DeviceMotionEvent.requestPermission&&(c=window.DeviceMotionEvent.requestPermission().then(function(a){return"granted"===a}));c.then(function(c){b.trigger_permission=a;c?b.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnPermissionGranted,b):b.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnPermissionDenied,b)})};d.acts=new n;g.prototype.TouchCount=function(a){a.set_int(this.touches.length)};g.prototype.X=function(a,b){var c=this.getTouchIndex;if(0>c||c>=
this.touches.length)a.set_float(0);else if(cr.is_undefined(b)){b=this.runtime.getLayerByNumber(0);var d=b.scale;var e=b.zoomRate;var f=b.parallaxX;var g=b.angle;b.scale=1;b.zoomRate=1;b.parallaxX=1;b.angle=0;a.set_float(b.canvasToLayer(this.touches[c].x,this.touches[c].y,!0));b.scale=d;b.zoomRate=e;b.parallaxX=f;b.angle=g}else(b=cr.is_number(b)?this.runtime.getLayerByNumber(b):this.runtime.getLayerByName(b))?a.set_float(b.canvasToLayer(this.touches[c].x,this.touches[c].y,!0)):a.set_float(0)};g.prototype.XAt=
function(a,b,c){b=Math.floor(b);if(0>b||b>=this.touches.length)a.set_float(0);else if(cr.is_undefined(c)){c=this.runtime.getLayerByNumber(0);var d=c.scale;var e=c.zoomRate;var f=c.parallaxX;var g=c.angle;c.scale=1;c.zoomRate=1;c.parallaxX=1;c.angle=0;a.set_float(c.canvasToLayer(this.touches[b].x,this.touches[b].y,!0));c.scale=d;c.zoomRate=e;c.parallaxX=f;c.angle=g}else(c=cr.is_number(c)?this.runtime.getLayerByNumber(c):this.runtime.getLayerByName(c))?a.set_float(c.canvasToLayer(this.touches[b].x,
this.touches[b].y,!0)):a.set_float(0)};g.prototype.XForID=function(a,b,c){b=this.findTouch(b);if(0>b)a.set_float(0);else if(b=this.touches[b],cr.is_undefined(c)){c=this.runtime.getLayerByNumber(0);var d=c.scale;var e=c.zoomRate;var f=c.parallaxX;var g=c.angle;c.scale=1;c.zoomRate=1;c.parallaxX=1;c.angle=0;a.set_float(c.canvasToLayer(b.x,b.y,!0));c.scale=d;c.zoomRate=e;c.parallaxX=f;c.angle=g}else(c=cr.is_number(c)?this.runtime.getLayerByNumber(c):this.runtime.getLayerByName(c))?a.set_float(c.canvasToLayer(b.x,
b.y,!0)):a.set_float(0)};g.prototype.Y=function(a,b){var c=this.getTouchIndex;if(0>c||c>=this.touches.length)a.set_float(0);else if(cr.is_undefined(b)){b=this.runtime.getLayerByNumber(0);var d=b.scale;var e=b.zoomRate;var f=b.parallaxY;var g=b.angle;b.scale=1;b.zoomRate=1;b.parallaxY=1;b.angle=0;a.set_float(b.canvasToLayer(this.touches[c].x,this.touches[c].y,!1));b.scale=d;b.zoomRate=e;b.parallaxY=f;b.angle=g}else(b=cr.is_number(b)?this.runtime.getLayerByNumber(b):this.runtime.getLayerByName(b))?
a.set_float(b.canvasToLayer(this.touches[c].x,this.touches[c].y,!1)):a.set_float(0)};g.prototype.YAt=function(a,b,c){b=Math.floor(b);if(0>b||b>=this.touches.length)a.set_float(0);else if(cr.is_undefined(c)){c=this.runtime.getLayerByNumber(0);var d=c.scale;var e=c.zoomRate;var f=c.parallaxY;var g=c.angle;c.scale=1;c.zoomRate=1;c.parallaxY=1;c.angle=0;a.set_float(c.canvasToLayer(this.touches[b].x,this.touches[b].y,!1));c.scale=d;c.zoomRate=e;c.parallaxY=f;c.angle=g}else(c=cr.is_number(c)?this.runtime.getLayerByNumber(c):
this.runtime.getLayerByName(c))?a.set_float(c.canvasToLayer(this.touches[b].x,this.touches[b].y,!1)):a.set_float(0)};g.prototype.YForID=function(a,b,c){b=this.findTouch(b);if(0>b)a.set_float(0);else if(b=this.touches[b],cr.is_undefined(c)){c=this.runtime.getLayerByNumber(0);var d=c.scale;var e=c.zoomRate;var f=c.parallaxY;var g=c.angle;c.scale=1;c.zoomRate=1;c.parallaxY=1;c.angle=0;a.set_float(c.canvasToLayer(b.x,b.y,!1));c.scale=d;c.zoomRate=e;c.parallaxY=f;c.angle=g}else(c=cr.is_number(c)?this.runtime.getLayerByNumber(c):
this.runtime.getLayerByName(c))?a.set_float(c.canvasToLayer(b.x,b.y,!1)):a.set_float(0)};g.prototype.AbsoluteX=function(a){this.touches.length?a.set_float(this.touches[0].x):a.set_float(0)};g.prototype.AbsoluteXAt=function(a,b){b=Math.floor(b);0>b||b>=this.touches.length?a.set_float(0):a.set_float(this.touches[b].x)};g.prototype.AbsoluteXForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].x)};g.prototype.AbsoluteY=function(a){this.touches.length?a.set_float(this.touches[0].y):
a.set_float(0)};g.prototype.AbsoluteYAt=function(a,b){b=Math.floor(b);0>b||b>=this.touches.length?a.set_float(0):a.set_float(this.touches[b].y)};g.prototype.AbsoluteYForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].y)};g.prototype.SpeedAt=function(a,b){b=Math.floor(b);if(0>b||b>=this.touches.length)a.set_float(0);else{var c=this.touches[b];b=cr.distanceTo(c.x,c.y,c.lastx,c.lasty);c=(c.time-c.lasttime)/1E3;0>=c?a.set_float(0):a.set_float(b/c)}};g.prototype.SpeedForID=
function(a,b){b=this.findTouch(b);if(0>b)a.set_float(0);else{var c=this.touches[b];b=cr.distanceTo(c.x,c.y,c.lastx,c.lasty);c=(c.time-c.lasttime)/1E3;0>=c?a.set_float(0):a.set_float(b/c)}};g.prototype.AngleAt=function(a,b){b=Math.floor(b);0>b||b>=this.touches.length?a.set_float(0):(b=this.touches[b],a.set_float(cr.to_degrees(cr.angleTo(b.lastx,b.lasty,b.x,b.y))))};g.prototype.AngleForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):(b=this.touches[b],a.set_float(cr.to_degrees(cr.angleTo(b.lastx,
b.lasty,b.x,b.y))))};g.prototype.Alpha=function(a){a.set_float(this.getAlpha())};g.prototype.Beta=function(a){a.set_float(this.getBeta())};g.prototype.Gamma=function(a){a.set_float(this.getGamma())};g.prototype.AccelerationXWithG=function(a){a.set_float(this.acc_g_x)};g.prototype.AccelerationYWithG=function(a){a.set_float(this.acc_g_y)};g.prototype.AccelerationZWithG=function(a){a.set_float(this.acc_g_z)};g.prototype.AccelerationX=function(a){a.set_float(this.acc_x)};g.prototype.AccelerationY=function(a){a.set_float(this.acc_y)};
g.prototype.AccelerationZ=function(a){a.set_float(this.acc_z)};g.prototype.TouchIndex=function(a){a.set_int(this.trigger_index)};g.prototype.TouchID=function(a){a.set_float(this.trigger_id)};g.prototype.WidthForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].width)};g.prototype.HeightForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].height)};g.prototype.PressureForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].pressure)};
d.exps=new g})();if(void 0===window)var window="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?this:self:global:window;var __CONSTRUCT2_RUNTIME2__=!0,__CONSTRUCT3_RUNTIME2__=!1,__CONSTRUCT3_RUNTIME3__=!1,__DEBUG__=!1;cr.plugins_.ValerypopoffJSPlugin=function(a){this.runtime=a};
(function(){function a(){}function b(){}function e(){}var l=cr.plugins_.ValerypopoffJSPlugin.prototype;l.Type=function(a){this.plugin=a;this.runtime=a.runtime};l.Type.prototype.onCreate=function(){};l.Instance=function(a){this.type=a;this.runtime=a.runtime};var h=l.Instance.prototype;h.onCreate=function(){function a(a,b){if(void 0===document)a.ShowError({debug_caller:"Including '"+b+"' script to the page",caller_name:"Including '"+b+"' script to the page",error_message:"'document' is not defined. You're probably launching the game in a Worker. Workers are not supported yet. Export project with 'Use worker' option unchecked in the 'Advanced' section of the 'Project properties' panel."});
else{var c=document.createElement("script");c.setAttribute("type","text/javascript");c.setAttribute("src",b);c.onreadystatechange=function(){"complete"==this.readyState&&a.sciptsToLoad--};c.onload=function(){a.sciptsToLoad--};c.onerror=function(){a.ShowError({debug_caller:"Including '"+b+"' script to the page",caller_name:"Including '"+b+"' script to the page",error_message:"Probably file not found"})};document.getElementsByTagName("head")[0].appendChild(c)}}this.returnValue=void 0;this.sciptsToLoad=
0;this.Aliases={};this.construct_compare_function_prefix="ConstructCompare_";this.AliasDotpartsCache={count:0,max_count:4096,Dotparts:{},AliasNames:{},AliasTrailers:{},IsAlias:{}};this.NonAliasDotpartsCache={count:0,max_count:2048,Dotparts:{}};if(""!=this.properties[0]){var b=[];b=__CONSTRUCT2_RUNTIME2__?this.properties[0].split(";"):this.properties[0].split(/[;\n\r]/);for(var d=0;d<b.length;d++)if(b[d]=b[d].trim(),0!=b[d].length&&(this.sciptsToLoad++,__CONSTRUCT2_RUNTIME2__&&a(this,b[d]),__CONSTRUCT3_RUNTIME2__&&
a(this,this.runtime.getLocalFileUrl(b[d])),__CONSTRUCT3_RUNTIME3__)){var e=this;void 0!==e._runtime.GetAssetManager().LoadProjectFileUrl?e._runtime.GetAssetManager().LoadProjectFileUrl(b[d]).then(function(b){a(e,b)},function(a){e.ShowError({debug_caller:"Including '"+b[d]+"' script to the page",caller_name:"Including '"+b[d]+"' script to the page",error_message:a.message})}).catch(function(a){e.ShowError({debug_caller:"Including '"+b[d]+"' script to the page",caller_name:"Including '"+b[d]+"' script to the page",
error_message:a.message})}):a(e,e._runtime.GetAssetManager().GetLocalFileUrl(b[d]))}}};h.draw=function(a){};h.drawGL=function(a){};var n=function(a){for(var b=[],d=0,e=0,g=0,h=a.length;g<h;g++)"["==a[g]?d++:"]"==a[g]?e++:"."==a[g]&&d==e&&b.push(g);var k=[],l=b.length-1;b.forEach(function(c,d,e){e=a.substring(b[d-1]+1,c);""!=e&&k.push(e);d==l&&(e=a.substring(c+1),""!=e&&k.push(e))});0==k.length&&k.push(a);k.forEach(function(a,b,c){"["==a[0]&&(c[b]=n(a.substring(1,a.length-1)))});return k},g=function(a,
b){return a=a.replace(/#[0-9]+/g,function(a){a=b[a.substr(1)];return"string"===typeof a?"'"+a+"'":a})},d=function(a,b){a+="(";if(b)for(var c=0,d=b.length;c<d;++c)a="string"===typeof b[c]?a+"'"+b[c]+"'":a+b[c],c!=b.length-1&&(a+=",");return a+")"},k={Value:function(a,b){var c=b[0];b.splice(0,1);var d=this.ParseJS(c,!0,a);if(d.error)ret.set_any(void 0);else{var e=void 0;try{e=d.end}catch(z){this.ShowError({debug_caller:"Value",caller_name:a,"show-alias-expression":d.alias_found,alias_expression:d.trimmed_code,
error_message:z.message});ret.set_any(void 0);return}"function"==typeof d.end&&(e=this.CallJSfunction(c,b,!1,a,d));return e}},CallJSfunction:function(a,b,e,g,h){void 0===e&&(e=!0);void 0===g&&(g="'Call function' action");h=void 0===h?this.ParseJS(a,!0,g):h;if(!h.error)if(0<=a.indexOf("(")||0<=a.indexOf(")"))a={debug_caller:"CallJSfunction",caller_name:g,error_message:"'"+h.trimmed_code+"' must be a function name, not a function call. Remove parentheses."},h.alias_found&&(a["show-alias-expression"]=
!0,a.alias_expression=h.trimmed_code),this.ShowError(a);else{var c=void 0;try{c=h.end.apply(h.context,b)}catch(x){x instanceof TypeError&&0<=x.message.indexOf("apply")&&0<=x.message.indexOf("undefined")&&(x.message=a+" is undefined");a={debug_caller:"CallJSfunction",caller_name:g,error_message:x.message};h.alias_found?(a["show-alias-expression"]=!0,a.alias_expression=d(h.trimmed_code,b),a["show-code"]=!0,a.code=d(this.Aliases[h.alias_name].js+h.alias_trailer,b)):(a["show-code"]=!0,a.code=d(h.trimmed_code,
b));this.ShowError(a);return}e&&(this.returnValue=c);return c}},CallAlias:function(a,b,d,e){void 0===d&&(d=!0);void 0===e&&(e="'Call alias' action");a=this.ParseJS(a,!0,e);if(!a.error)return this.CallJSfunction(this.Aliases[a.alias_name].js+a.alias_trailer,b,d,e,a)},ShowError:function(a){var b="ValerypopoffJS plugin: Error in "+a.caller_name+"\n";b+="--------------------- \n";__DEBUG__&&(b+="DEBUG CALLER: "+a.debug_caller+"\n",b+="--------------------- \n");a["show-alias-expression"]&&(b+="Alias expression: "+
a.alias_expression+"\n",b+="--------------------- \n");a["show-code"]&&(b+="JS code: "+a.code+"\n",b+="--------------------- \n");b+=a.error_message;console.error(b)},Resolve:function(a,b,d,e,g){for(var c=window,f=c,h="",k=0,t=a.length;k<t;k++){h=a[k];if("object"==typeof h){h=this.Resolve(h,b,d,e,g);if(h.error)return{error:!0};h=h.end;try{f=f[h]}catch(A){return a={debug_caller:"Resolve",caller_name:b,error_message:A.message,"show-code":!0,code:d},e&&(a["show-alias-expression"]=!0,a.code=this.Aliases[e].js+
g,a.alias_expression=d),this.ShowError(a),{error:!0}}}else try{c==window?/^[$A-Z_][0-9A-Z_$]*$/i.test(h)?f=f[h]:("'"==h[0]&&(h=h.substring(1,h.length-1)),f=h):f=f[h]}catch(A){return a={debug_caller:"Resolve",caller_name:b,error_message:A.message,"show-code":!0,code:d},e&&(a["show-alias-expression"]=!0,a.code=this.Aliases[e].js+g,a.alias_expression=d),this.ShowError(a),{error:!0}}k<t-1&&(c=f)}return{error:!1,context:c,end:f,endname:h}},ParseJS:function(a,b,d){b=!1;var c=void 0,e=void 0;a=a.trim().replace(/\s*([\.\[\]])\s*/g,
"$1");var f=this.AliasDotpartsCache;if(f.Dotparts[a]){var g=f.Dotparts[a];f.IsAlias[a]&&(b=!0,c=f.AliasNames[a],e=f.AliasTrailers[a])}else{c=a.split(/[\.\[]/)[0];e=a.substring(c.length);this.Aliases[c]?(b=!0,g=e?n(this.Aliases[c].dotstring+e.split("[").join(".[")):n(this.Aliases[c].dotstring)):(e=c=void 0,g=n(a.split("[").join(".[")));if(f.count>=f.max_count)for(var h in f.Dotparts)if(delete f.Dotparts[h],f.IsAlias[h]&&(delete f.AliasNames[h],delete f.AliasTrailers[h],delete f.IsAlias[h]),f.count--,
f.count<=f.max_count)break;f.Dotparts[a]=g;b&&(f.AliasNames[a]=c,f.AliasTrailers[a]=e,f.IsAlias[a]=!0);f.count++}d=this.Resolve(g,d,a,c,e);return{error:d.error,end:d.end,endname:d.endname,context:d.context,trimmed_code:a,alias_found:b,alias_name:c,alias_trailer:e}}},u;for(u in k)h[u]=k[u];k={C2CompareFunctionReturnValue:function(a,b,d,e){switch(b){case 2:b=4;break;case 3:b=5;break;case 4:b=2;break;case 5:b=3}return this.CNDS.CompareFunctionReturnValue.call(this,d,e,b,a)},C2CompareAliasCallReturnValue:function(a,
b,d,e){switch(b){case 2:b=4;break;case 3:b=5;break;case 4:b=2;break;case 5:b=3}return this.CNDS.CompareAliasCallReturnValue.call(this,d,e,b,a)},C2CompareExecReturnWithParams:function(a,b,d,e){switch(b){case 2:b=4;break;case 3:b=5;break;case 4:b=2;break;case 5:b=3}return this.CNDS.CompareExecReturnWithParams.call(this,d,e,b,a)},C2CompareValue:function(a,b,d,e){switch(b){case 2:b=4;break;case 3:b=5;break;case 4:b=2;break;case 5:b=3}return this.CNDS.CompareValue.call(this,d,e,b,a)},CompareExecReturnWithParams:function(a,
b,d,e){var c=void 0;b.length&&(a=g(a,b));try{c=eval(a)}catch(z){this.ShowError({debug_caller:"CompareExecReturnWithParams",caller_name:"'Compare JS code Completion value' condition",error_message:z.message,"show-code":!0,code:a});return}"boolean"===typeof c&&(c=c?1:0);return cr.do_cmp(c,d,e)},CompareFunctionReturnValue:function(a,b,d,e){a=this.CallJSfunction(a,b,!1,"'Compare Function return value' condition");"boolean"===typeof a&&(a=a?1:0);return cr.do_cmp(a,d,e)},CompareStoredReturnValue:function(a,
b){var c=this.returnValue;"boolean"===typeof c&&(c=c?1:0);return cr.do_cmp(c,a,b)},AllScriptsLoaded:function(){return 0>=this.sciptsToLoad?!0:!1},CompareValue:function(a,b,d,e){a=this.Value("'Compare Value' condition",[].concat(a,b));"boolean"===typeof a&&(a=a?1:0);return cr.do_cmp(a,d,e)},CompareAliasValue:function(a,b,d){var c=this.ParseJS(a,!0,"'Set alias' action");if(!c.alias_found)b={debug_caller:"CompareAliasValue",caller_name:"'Compare alias' condition",error_message:"No such alias '"+a+"'"},
this.ShowError(b);else if(!c.error)if((a=c.context[this.construct_compare_function_prefix+c.endname])&&"object"==typeof c.context)try{return a.call(c.context,b,d)}catch(y){b={debug_caller:"CompareAliasValue",caller_name:"'Compare alias' condition","show-alias-expression":!0,alias_expression:c.trimmed_code,error_message:"Error in user defined '"+this.construct_compare_function_prefix+c.endname+"' function: "+y.message},this.ShowError(b)}else return c=c.end,"boolean"===typeof c&&(c=c?1:0),cr.do_cmp(c,
b,d)},CompareAliasCallReturnValue:function(a,b,d,e){a=this.CallAlias(a,b,!1,"'Compare Alias Call return value' condition");"boolean"===typeof a&&(a=a?1:0);return cr.do_cmp(a,d,e)}};for(u in k)a.prototype[u]=k[u];l.cnds=new a;k={ExecuteJSWithParams:function(a,b){this.returnValue=void 0;a=a.replace(/#[0-9]+/g,function(a){a=b[a.substr(1)];return"string"===typeof a?"'"+a+"'":a});try{this.returnValue=eval(a)}catch(f){this.ShowError({debug_caller:"ExecuteJSWithParams",caller_name:"'Execute JS code' action",
"show-code":!0,code:a,error_message:f.message})}},CallJSfunction:function(a,b,d,e,g){this.CallJSfunction(a,b,d,e,g)},SetValue:function(a,b){var c=this.ParseJS(a,!0,"'Set value' action");if(!c.error)try{c.context[c.endname]=b}catch(q){a+="=",this.ShowError({debug_caller:"SetValue",caller_name:"'Set value' action","show-alias-expression":c.alias_found,alias_expression:c.trimmed_code,"show-code":!0,code:"string"==typeof b?a+"'"+b+"'":a+b,error_message:q.message})}},Call:function(a,b,d,e){this.CallJSfunction(a,
b,!0,"'Call' action")},InitAlias:function(a,b){a=a.trim();b=b.trim();if(0==b.length)a={debug_caller:"InitAlias",caller_name:"'Init alias' action",error_message:"Javascript string of alias '"+a+"' must not be empty."},this.ShowError(a);else if(0<=a.indexOf(".")||0<=a.indexOf("[")||0<=a.indexOf("]"))a={debug_caller:"InitAlias",caller_name:"'Init alias' action",error_message:"Alias name must not contain '.', '[' or ']' signs: '"+a+"'"},this.ShowError(a);else if(void 0!=this.Aliases[a])a={debug_caller:"InitAlias",
caller_name:"'Init alias' action",error_message:"Alias '"+a+"' already exists"},this.ShowError(a);else{var c={};c.js=b;c.dotstring=b.split("[").join(".[");this.Aliases[a]=c}},SetAlias:function(a,b){var c=this.ParseJS(a,!0,"'Set alias' action");if(!c.alias_found)b={debug_caller:"SetAlias",caller_name:"'Set alias' action",error_message:"No such alias '"+c.trimmed_code+"'"},this.ShowError(b);else if(!c.error)try{c.context[c.endname]=b}catch(q){a+="=",b={debug_caller:"SetAlias",caller_name:"'Set alias' action",
"show-alias-expression":!0,alias_expression:c.trimmed_code,"show-code":!0,code:"string"==typeof b?a+"'"+b+"'":a+b,error_message:q.message},this.ShowError(b)}},CallAlias:function(a,b,d,e){this.CallAlias(a,b,d,e)}};for(u in k)b.prototype[u]=k[u];l.acts=new b;k={JSCodeValue:function(){var a=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)var b={set_int:function(){},set_float:function(){},set_string:function(){},set_any:function(){}};else{b=a[0];for(var d=0;d<a.length-1;d++)a[d]=a[d+
1];a.pop()}d=a[0];a.splice(0,1);a.length&&(d=g(d,a));a=void 0;try{a=eval(d)}catch(q){this.ShowError({debug_caller:"JSCodeValue",caller_name:"'JSCodeValue' expression","show-code":!0,code:d,error_message:q.message});b.set_any(void 0);return}if("boolean"==typeof a){if(b.set_any(a?1:0),__CONSTRUCT3_RUNTIME3__)return a?1:0}else if(b.set_any(a),__CONSTRUCT3_RUNTIME3__)return a},StoredReturnValue:function(){var a=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)var b={set_int:function(){},
set_float:function(){},set_string:function(){},set_any:function(){}};else{b=a[0];for(var d=0;d<a.length-1;d++)a[d]=a[d+1];a.pop()}if("boolean"===typeof this.returnValue){if(b.set_any(this.returnValue?1:0),__CONSTRUCT3_RUNTIME3__)return this.returnValue?1:0}else if(b.set_any(this.returnValue),__CONSTRUCT3_RUNTIME3__)return this.returnValue},FunctionReturnValue:function(){var a=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)var b={set_int:function(){},set_float:function(){},set_string:function(){},
set_any:function(){}};else{b=a[0];for(var d=0;d<a.length-1;d++)a[d]=a[d+1];a.pop()}d=a[0];var e=this.ParseJS(d,!1,"'FunctionReturnValue' expression");a.splice(0,1);if(e.error)b.set_any(void 0);else{var g=void 0;g=this.CallJSfunction(d,a,!1,"'FunctionReturnValue' expression",e);if("boolean"===typeof g){if(b.set_any(g?1:0),__CONSTRUCT3_RUNTIME3__)return g?1:0}else if(b.set_any(g),__CONSTRUCT3_RUNTIME3__)return g}},Value:function(){var a=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)var b=
{set_int:function(){},set_float:function(){},set_string:function(){},set_any:function(){}};else{b=a[0];for(var d=0;d<a.length-1;d++)a[d]=a[d+1];a.pop()}a=this.Value("'Value' expression",a);if("boolean"===typeof a){if(b.set_any(a?1:0),__CONSTRUCT3_RUNTIME3__)return a?1:0}else if(b.set_any(a),__CONSTRUCT3_RUNTIME3__)return a},AliasValue:function(){var a=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)var b={set_int:function(){},set_float:function(){},set_string:function(){},set_any:function(){}};
else{b=a[0];for(var d=0;d<a.length-1;d++)a[d]=a[d+1];a.pop()}a=this.ParseJS(a[0],!0,"'AliasValue' expression");if(a.alias_found)if(a.error)b.set_any(void 0);else{d=void 0;try{d=a.end}catch(q){a={debug_caller:"AliasValue",caller_name:"'AliasValue' expression","show-alias-expression":!0,alias_expression:a.trimmed_code,error_message:q.message};this.ShowError(a);b.set_any(void 0);return}if("boolean"===typeof d){if(b.set_any(d?1:0),__CONSTRUCT3_RUNTIME3__)return d?1:0}else if(b.set_any(d),__CONSTRUCT3_RUNTIME3__)return d}else a=
{debug_caller:"AliasValue",caller_name:"'AliasValue' expression",error_message:"No such alias '"+a.trimmed_code+"'"},this.ShowError(a),b.set_any(void 0)},AliasCallReturnValue:function(){var a=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)var b={set_int:function(){},set_float:function(){},set_string:function(){},set_any:function(){}};else{b=a[0];for(var d=0;d<a.length-1;d++)a[d]=a[d+1];a.pop()}d=a[0];var e=this.ParseJS(d,!0,"'AliasCallValue' expression");a.splice(0,1);if(e.alias_found)if(e.error)b.set_any(void 0);
else{var g=void 0;g=this.CallJSfunction(d,a,!1,"'AliasCallValue' expression",e);if("boolean"===typeof g){if(b.set_any(g?1:0),__CONSTRUCT3_RUNTIME3__)return g?1:0}else if(b.set_any(g),__CONSTRUCT3_RUNTIME3__)return g}else this.ShowError({debug_caller:"AliasCallValue",caller_name:"'AliasCallValue' expression",error_message:"No such alias '"+e.trimmed_code+"'"}),b.set_any(void 0)}};for(u in k)e.prototype[u]=k[u];l.exps=new e;h.EXPS=l.exps;h.CNDS=l.cnds;h.ACTS=l.acts})();
cr.plugins_.filechooser=function(a){this.runtime=a};
(function(){function a(){}function b(){}function e(){}function l(a,b){if(!a)return null;b=Math.floor(b);return 0>b||b>=a.length?null:a[b]}var h=cr.plugins_.filechooser.prototype;h.Type=function(a){this.plugin=a;this.runtime=a.runtime};h.Type.prototype.onCreate=function(){};h.Instance=function(a){this.type=a;this.runtime=a.runtime};var n=h.Instance.prototype,g=window.URL||window.webkitURL||window.mozURL||window.msURL;n.onCreate=function(){if(this.runtime.isDomFree)cr.logexport("[Construct 2] File Chooser plugin not supported on this platform - the object will not be created");else{this.elem=
document.createElement("input");this.elem.type="file";this.elem.setAttribute("accept",this.properties[0]);0!==this.properties[1]&&this.elem.setAttribute("multiple","");this.elem.id=this.properties[3];jQuery(this.elem).appendTo(this.runtime.canvasdiv?this.runtime.canvasdiv:"body");this.element_hidden=!1;0===this.properties[2]&&(jQuery(this.elem).hide(),this.visible=!1,this.element_hidden=!0);var a=this;this.elem.onchange=function(){a.runtime.trigger(cr.plugins_.filechooser.prototype.cnds.OnChanged,
a)};this.lastWinHeight=this.lastWinWidth=this.lastBottom=this.lastRight=this.lastTop=this.lastLeft=0;this.updatePosition(!0);this.runtime.tickMe(this)}};n.onDestroy=function(){this.runtime.isDomFree||(jQuery(this.elem).remove(),this.elem=null)};n.tick=function(){this.updatePosition()};n.updatePosition=function(a){if(!this.runtime.isDomFree){var b=this.layer.layerToCanvas(this.x,this.y,!0),d=this.layer.layerToCanvas(this.x,this.y,!1),e=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,
!0),c=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!1),f=this.runtime.width/this.runtime.devicePixelRatio,g=this.runtime.height/this.runtime.devicePixelRatio;!this.visible||!this.layer.visible||0>=e||0>=c||b>=f||d>=g?(this.element_hidden||jQuery(this.elem).hide(),this.element_hidden=!0):(1>b&&(b=1),1>d&&(d=1),e>=f&&(e=f-1),c>=g&&(c=g-1),f=window.innerWidth,g=window.innerHeight,a||this.lastLeft!==b||this.lastTop!==d||this.lastRight!==e||this.lastBottom!==c||this.lastWinWidth!==f||
this.lastWinHeight!==g?(this.lastLeft=b,this.lastTop=d,this.lastRight=e,this.lastBottom=c,this.lastWinWidth=f,this.lastWinHeight=g,this.element_hidden&&(jQuery(this.elem).show(),this.element_hidden=!1),a=Math.round(b)+jQuery(this.runtime.canvas).offset().left,f=Math.round(d)+jQuery(this.runtime.canvas).offset().top,jQuery(this.elem).css("position","absolute"),jQuery(this.elem).offset({left:a,top:f}),jQuery(this.elem).width(Math.round(e-b)),jQuery(this.elem).height(Math.round(c-d))):this.element_hidden&&
(jQuery(this.elem).show(),this.element_hidden=!1))}};n.draw=function(a){};n.drawGL=function(a){};a.prototype.OnChanged=function(){return!0};h.cnds=new a;b.prototype.SetVisible=function(a){this.runtime.isDomFree||(this.visible=0!==a)};b.prototype.SetCSSStyle=function(a,b){this.runtime.isDomFree||jQuery(this.elem).css(a,b)};b.prototype.ReleaseFile=function(a){!this.runtime.isDomFree&&g&&g.revokeObjectURL&&g.revokeObjectURL(a)};h.acts=new b;e.prototype.FileCount=function(a){a.set_int(this.runtime.isDomFree?
0:this.elem.files.length||0)};e.prototype.FileNameAt=function(a,b){b=this.runtime.isDomFree?null:l(this.elem.files,b);a.set_string(b?b.name||"":"")};e.prototype.FileSizeAt=function(a,b){b=this.runtime.isDomFree?null:l(this.elem.files,b);a.set_int(b?b.size||0:0)};e.prototype.FileTypeAt=function(a,b){b=this.runtime.isDomFree?null:l(this.elem.files,b);a.set_string(b?b.type||"":"")};e.prototype.FileURLAt=function(a,b){(b=this.runtime.isDomFree?null:l(this.elem.files,b))?b.c2url?a.set_string(b.c2url):
g&&g.createObjectURL?(b.c2url=g.createObjectURL(b),a.set_string(b.c2url)):a.set_string(""):a.set_string("")};h.exps=new e})();cr.plugins_.pix_dialogs=function(a){this.runtime=a};
(function(){function a(){}function b(){}function e(){}var l=cr.plugins_.pix_dialogs.prototype;l.Type=function(a){this.plugin=a;this.runtime=a.runtime};l.Type.prototype.onCreate=function(){};l.Instance=function(a){this.type=a;this.runtime=a.runtime};var h=l.Instance.prototype;h.onCreate=function(){self=this;self.currID;self.getValue};h.onDestroy=function(){};h.saveToJSON=function(){return{}};h.loadFromJSON=function(a){};h.draw=function(a){};h.drawGL=function(a){};a.prototype.dialogConfirmed=function(a){return self.currID==
a?!0:!1};a.prototype.dialogCancelled=function(a){return self.currID==a?!0:!1};l.cnds=new a;b.prototype.openDialog=function(a,b,d,e){self.currID=b;var g;0==a?g=confirm(d):1==a?g=prompt(d,e):2==a&&alert(d);0==a&&1==g?self.runtime.trigger(cr.plugins_.pix_dialogs.prototype.cnds.dialogConfirmed,self):2==a?self.runtime.trigger(cr.plugins_.pix_dialogs.prototype.cnds.dialogConfirmed,self):null!==g&&!1!==g?(self.getValue=g,self.runtime.trigger(cr.plugins_.pix_dialogs.prototype.cnds.dialogConfirmed,self)):
self.runtime.trigger(cr.plugins_.pix_dialogs.prototype.cnds.dialogCancelled,self)};l.acts=new b;e.prototype.getValue=function(a){a.set_any(self.getValue)};l.exps=new e})();cr.plugins_.rex_TouchWrap=function(a){this.runtime=a};
(function(){function a(a){r=a.x;c=a.y;f=a.z}function b(a,b,c,d){var e=q.length?q.pop():new l;e.init(a,b,c,d);return e}function e(a){100>q.length&&q.push(a)}function l(){this.startindex=this.id=this.lasty=this.lastx=this.y=this.x=this.starty=this.startx=this.lasttime=this.time=this.starttime=0;this.tooFarForHold=this.triggeredHold=!1}function h(){}function n(){}function g(){}var d=cr.plugins_.rex_TouchWrap.prototype;d.Type=function(a){this.plugin=a;this.runtime=a.runtime};d.Type.prototype.onCreate=
function(){};d.Instance=function(a){this.type=a;this.runtime=a.runtime;this.touches=[];this.touchDown=this.mouseDown=!1;this.check_name="TOUCHWRAP";this.cursor={x:null,y:null};this._callbackObjs=[];this.fake_ret={value:0,set_any:function(a){this.value=a},set_int:function(a){this.value=a},set_float:function(a){this.value=a}}};var k=d.Instance.prototype,u={left:0,top:0};k.findTouch=function(a){var b;var c=0;for(b=this.touches.length;c<b;c++)if(this.touches[c].id===a)return c;return-1};var r=0,c=0,f=
0,q=[];l.prototype.init=function(a,b,c,d){var e=cr.performance_now();this.starttime=this.lasttime=this.time=e;this.startx=a;this.starty=b;this.x=a;this.y=b;this.lastx=a;this.lasty=b;this.pressure=this.height=this.width=0;this.id=c;this.startindex=d;this.tooFarForHold=this.triggeredHold=!1};l.prototype.update=function(a,b,c,d,e,f){this.lasttime=this.time;this.time=a;this.lastx=this.x;this.lasty=this.y;this.x=b;this.y=c;this.width=d;this.height=e;this.pressure=f;!this.tooFarForHold&&15<=cr.distanceTo(this.startx,
this.starty,this.x,this.y)&&(this.tooFarForHold=!0)};l.prototype.maybeTriggerHold=function(a,b){!this.triggeredHold&&500<=cr.performance_now()-this.starttime&&!this.tooFarForHold&&15>cr.distanceTo(this.startx,this.starty,this.x,this.y)&&(this.triggeredHold=!0,a.trigger_index=this.startindex,a.trigger_id=this.id,a.getTouchIndex=b,a.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnHoldGesture,a),a.curTouchX=this.x,a.curTouchY=this.y,a.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnHoldGestureObject,
a),a.getTouchIndex=0)};var y=-1E3,z=-1E3,x=-1E4;l.prototype.maybeTriggerTap=function(a,b){if(!this.triggeredHold){var c=cr.performance_now();333>=c-this.starttime&&!this.tooFarForHold&&15>cr.distanceTo(this.startx,this.starty,this.x,this.y)&&(a.trigger_index=this.startindex,a.trigger_id=this.id,a.getTouchIndex=b,666>=c-x&&25>cr.distanceTo(y,z,this.x,this.y)?(a.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnDoubleTapGesture,a),a.curTouchX=this.x,a.curTouchY=this.y,a.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnDoubleTapGestureObject,
a),z=y=-1E3,x=-1E4):(a.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnTapGesture,a),a.curTouchX=this.x,a.curTouchY=this.y,a.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnTapGestureObject,a),y=this.x,z=this.y,x=c),a.getTouchIndex=0)}};k.onCreate=function(){this.isWindows8=!("undefined"===typeof window.c2isWindows8||!window.c2isWindows8);this.getTouchIndex=this.trigger_id=this.trigger_index=this.curTouchY=this.curTouchX=this.acc_z=this.acc_y=this.acc_x=this.acc_g_z=this.acc_g_y=
this.acc_g_x=this.orient_gamma=this.orient_beta=this.orient_alpha=0;this.useMouseInput=0!==this.properties[0];var b=0<this.runtime.fullscreen_mode?document:this.runtime.canvas,c=document;this.runtime.isDirectCanvas?c=b=window.Canvas:this.runtime.isCocoonJs&&(c=b=window);var d=this;"undefined"!==typeof PointerEvent?(b.addEventListener("pointerdown",function(a){d.onPointerStart(a)},!1),b.addEventListener("pointermove",function(a){d.onPointerMove(a)},!1),c.addEventListener("pointerup",function(a){d.onPointerEnd(a,
!1)},!1),c.addEventListener("pointercancel",function(a){d.onPointerEnd(a,!0)},!1),this.runtime.canvas&&(this.runtime.canvas.addEventListener("MSGestureHold",function(a){a.preventDefault()},!1),document.addEventListener("MSGestureHold",function(a){a.preventDefault()},!1),this.runtime.canvas.addEventListener("gesturehold",function(a){a.preventDefault()},!1),document.addEventListener("gesturehold",function(a){a.preventDefault()},!1))):window.navigator.msPointerEnabled?(b.addEventListener("MSPointerDown",
function(a){d.onPointerStart(a)},!1),b.addEventListener("MSPointerMove",function(a){d.onPointerMove(a)},!1),c.addEventListener("MSPointerUp",function(a){d.onPointerEnd(a,!1)},!1),c.addEventListener("MSPointerCancel",function(a){d.onPointerEnd(a,!0)},!1),this.runtime.canvas&&(this.runtime.canvas.addEventListener("MSGestureHold",function(a){a.preventDefault()},!1),document.addEventListener("MSGestureHold",function(a){a.preventDefault()},!1))):(b.addEventListener("touchstart",function(a){d.onTouchStart(a)},
!1),b.addEventListener("touchmove",function(a){d.onTouchMove(a)},!1),c.addEventListener("touchend",function(a){d.onTouchEnd(a,!1)},!1),c.addEventListener("touchcancel",function(a){d.onTouchEnd(a,!0)},!1));if(this.isWindows8){var e=function(a){a=a.reading;d.acc_x=a.accelerationX;d.acc_y=a.accelerationY;d.acc_z=a.accelerationZ},f=function(a){a=a.reading;d.orient_alpha=a.yawDegrees;d.orient_beta=a.pitchDegrees;d.orient_gamma=a.rollDegrees},g=Windows.Devices.Sensors.Accelerometer.getDefault();g&&(g.reportInterval=
Math.max(g.minimumReportInterval,16),g.addEventListener("readingchanged",e));var h=Windows.Devices.Sensors.Inclinometer.getDefault();h&&(h.reportInterval=Math.max(h.minimumReportInterval,16),h.addEventListener("readingchanged",f));document.addEventListener("visibilitychange",function(a){document.hidden||document.msHidden?(g&&g.removeEventListener("readingchanged",e),h&&h.removeEventListener("readingchanged",f)):(g&&g.addEventListener("readingchanged",e),h&&h.addEventListener("readingchanged",f))},
!1)}else window.addEventListener("deviceorientation",function(a){d.orient_alpha=a.alpha||0;d.orient_beta=a.beta||0;d.orient_gamma=a.gamma||0},!1),window.addEventListener("devicemotion",function(a){a.accelerationIncludingGravity&&(d.acc_g_x=a.accelerationIncludingGravity.x||0,d.acc_g_y=a.accelerationIncludingGravity.y||0,d.acc_g_z=a.accelerationIncludingGravity.z||0);a.acceleration&&(d.acc_x=a.acceleration.x||0,d.acc_y=a.acceleration.y||0,d.acc_z=a.acceleration.z||0)},!1);this.useMouseInput&&!this.runtime.isDomFree&&
(document.addEventListener("mousemove",function(a){d.onMouseMove(a)}),document.addEventListener("mousedown",function(a){d.onMouseDown(a)}),document.addEventListener("mouseup",function(a){d.onMouseUp(a)}));!this.runtime.isiOS&&this.runtime.isCordova&&navigator.accelerometer&&navigator.accelerometer.watchAcceleration&&navigator.accelerometer.watchAcceleration(a,null,{frequency:40});this.runtime.tick2Me(this);this.enable=1==this.properties[1];this.lastTouchY=this.lastTouchX=null};k.getCanvasOffset=function(){this.runtime.isDomFree||
(u.left=this.runtime.canvas.offsetLeft,u.top=this.runtime.canvas.offsetTop);return u};k.onPointerMove=function(a){if(this.enable&&a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType){a.preventDefault&&a.preventDefault();var b=this.findTouch(a.pointerId),c=cr.performance_now(),d=this._callbackObjs.length;if(0<=b){var e=this.getCanvasOffset();b=this.touches[b];if(!(2>c-b.time))for(b.update(c,a.pageX-e.left,a.pageY-e.top,a.width||0,a.height||0,a.pressure||0),c=a.pageX-e.left,e=a.pageY-e.top,
a=0;a<d;a++)this._callbackObjs[a].OnTouchMove&&this._callbackObjs[a].OnTouchMove(b.identifier,c,e)}}};k.onPointerStart=function(a){if(this.enable&&a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType){a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault();var c=this.getCanvasOffset(),d=a.pageX-c.left;c=a.pageY-c.top;cr.performance_now();this.trigger_index=this.touches.length;this.trigger_id=a.pointerId;this.touches.push(b(d,c,a.pointerId,this.trigger_index));this.runtime.isInUserInputEvent=
!0;this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnNthTouchStart,this);this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnTouchStart,this);this.curTouchX=d;this.curTouchY=c;this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnTouchObject,this);d=this._callbackObjs.length;for(a=0;a<d;a++)this._callbackObjs[a].OnTouchStart&&this._callbackObjs[a].OnTouchStart(this.trigger_id,this.curTouchX,this.curTouchY);this.runtime.isInUserInputEvent=!1}};k.onPointerEnd=function(a,
b){if(this.enable&&a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType){a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault();a=this.findTouch(a.pointerId);this.trigger_index=0<=a?this.touches[a].startindex:-1;this.trigger_id=0<=a?this.touches[a].id:-1;this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnNthTouchEnd,this);this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnTouchEnd,this);0<=a&&(this.lastTouchX=this.touches[a].x,
this.lastTouchY=this.touches[a].y,this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnTouchReleasedObject,this));var c=this._callbackObjs.length,d;for(d=0;d<c;d++)this._callbackObjs[d].OnTouchEnd&&this._callbackObjs[d].OnTouchEnd(this.trigger_id);0<=a&&(b||this.touches[a].maybeTriggerTap(this,a),e(this.touches[a]),this.touches.splice(a,1));this.runtime.isInUserInputEvent=!1}};k.onTouchMove=function(a){if(this.enable){a.preventDefault&&a.preventDefault();var b=cr.performance_now(),c,d=
this._callbackObjs.length;var e=0;for(c=a.changedTouches.length;e<c;e++){var f=a.changedTouches[e];var g=this.findTouch(f.identifier);if(0<=g){var h=this.getCanvasOffset();g=this.touches[g];if(!(2>b-g.time)){g.update(b,f.pageX-h.left,f.pageY-h.top,2*(f.radiusX||f.webkitRadiusX||f.mozRadiusX||f.msRadiusX||0),2*(f.radiusY||f.webkitRadiusY||f.mozRadiusY||f.msRadiusY||0),f.force||f.webkitForce||f.mozForce||f.msForce||0);g=f.pageX-h.left;var k=f.pageY-h.top;for(h=0;h<d;h++)this._callbackObjs[h].OnTouchMove&&
this._callbackObjs[h].OnTouchMove(f.identifier,g,k)}}}}};k.onTouchStart=function(a){if(this.enable){a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault();var c=this.getCanvasOffset();cr.performance_now();this.runtime.isInUserInputEvent=!0;var d,e=this._callbackObjs.length;var f=0;for(d=a.changedTouches.length;f<d;f++){var g=a.changedTouches[f];var h=this.findTouch(g.identifier);if(-1===h){h=g.pageX-c.left;var k=g.pageY-c.top;this.trigger_index=this.touches.length;this.trigger_id=g.identifier;
this.touches.push(b(h,k,g.identifier,this.trigger_index));this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnNthTouchStart,this);this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnTouchStart,this);this.curTouchX=h;this.curTouchY=k;this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnTouchObject,this);for(g=0;g<e;g++)this._callbackObjs[g].OnTouchStart&&this._callbackObjs[g].OnTouchStart(this.trigger_id,this.curTouchX,this.curTouchY)}}this.runtime.isInUserInputEvent=
!1}};k.onTouchEnd=function(a,b){if(this.enable){a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault();this.runtime.isInUserInputEvent=!0;var c,d=this._callbackObjs.length,f;var g=0;for(c=a.changedTouches.length;g<c;g++){var h=a.changedTouches[g];h=this.findTouch(h.identifier);if(0<=h){this.trigger_index=this.touches[h].startindex;this.trigger_id=this.touches[h].id;this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnNthTouchEnd,this);this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnTouchEnd,
this);this.lastTouchX=this.touches[h].x;this.lastTouchY=this.touches[h].y;this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnTouchReleasedObject,this);for(f=0;f<d;f++)this._callbackObjs[f].OnTouchEnd&&this._callbackObjs[f].OnTouchEnd(this.trigger_id);b||this.touches[h].maybeTriggerTap(this,h);e(this.touches[h]);this.touches.splice(h,1)}}this.runtime.isInUserInputEvent=!1}};k.getAlpha=function(){return this.runtime.isCordova&&0===this.orient_alpha&&0!==f?90*f:this.orient_alpha};k.getBeta=
function(){return this.runtime.isCordova&&0===this.orient_beta&&0!==c?90*c:this.orient_beta};k.getGamma=function(){return this.runtime.isCordova&&0===this.orient_gamma&&0!==r?90*r:this.orient_gamma};k.updateCursor=function(a){var b=this.getCanvasOffset();this.cursor.x=a.pageX-b.left;this.cursor.y=a.pageY-b.top};k.onMouseDown=function(a){if(this.enable){this.updateCursor(a);this.mouseDown=!0;a.preventDefault&&this.runtime.had_a_click&&!this.runtime.isMobile&&a.preventDefault();var b=this.findTouch(0);
-1!==b&&(e(this.touches[b]),cr.arrayRemove(this.touches,b));this.onTouchStart({changedTouches:[{pageX:a.pageX,pageY:a.pageY,identifier:0}]})}};k.onMouseMove=function(a){if(this.enable&&(this.updateCursor(a),this.mouseDown))this.onTouchMove({changedTouches:[{pageX:a.pageX,pageY:a.pageY,identifier:0}]})};k.onMouseUp=function(a){this.enable&&(this.updateCursor(a),this.mouseDown=!1,a.preventDefault&&this.runtime.had_a_click&&!this.runtime.isMobile&&a.preventDefault(),this.runtime.had_a_click=!0,this.onTouchEnd({changedTouches:[{pageX:a.pageX,
pageY:a.pageY,identifier:0}]}))};k.tick2=function(){if(this.enable){var a,b=cr.performance_now();var c=0;for(a=this.touches.length;c<a;++c){var d=this.touches[c];d.time<=b-50&&(d.lasttime=b);d.maybeTriggerHold(this,c)}this.lastTouchY=this.lastTouchX=null}};h.prototype.OnTouchStart=function(){return!0};h.prototype.OnTouchEnd=function(){return!0};h.prototype.IsInTouch=function(){return this.IsInTouch()};h.prototype.OnTouchObject=function(a){return a?this.runtime.testAndSelectCanvasPointOverlap(a,this.curTouchX,
this.curTouchY,!1):!1};var C=[];h.prototype.IsTouchingObject=function(a){if(this.IsInTouch()){if(!a)return!1;var b=a.getCurrentSol(),c=b.getObjects(),d,e;var f=0;for(d=c.length;f<d;f++){var g=c[f];g.update_bbox();var h=0;for(e=this.touches.length;h<e;h++){var k=this.touches[h];var l=g.layer.canvasToLayer(k.x,k.y,!0);k=g.layer.canvasToLayer(k.x,k.y,!1);if(g.contains_pt(l,k)){C.push(g);break}}}return C.length?(b.select_all=!1,cr.shallowAssignArray(b.instances,C),a.applySolToContainer(),cr.clearArray(C),
!0):!1}};h.prototype.CompareTouchSpeed=function(a,b,c){a=Math.floor(a);if(0>a||a>=this.touches.length)return!1;var d=this.touches[a];a=cr.distanceTo(d.x,d.y,d.lastx,d.lasty);d=(d.time-d.lasttime)/1E3;var e=0;0<d&&(e=a/d);return cr.do_cmp(e,b,c)};h.prototype.OrientationSupported=function(){return"undefined"!==typeof window.DeviceOrientationEvent};h.prototype.MotionSupported=function(){return"undefined"!==typeof window.DeviceMotionEvent};h.prototype.CompareOrientation=function(a,b,c){a=0===a?this.getAlpha():
1===a?this.getBeta():this.getGamma();return cr.do_cmp(a,b,c)};h.prototype.CompareAcceleration=function(a,b,c){var d=0;0===a?d=this.acc_g_x:1===a?d=this.acc_g_y:2===a?d=this.acc_g_z:3===a?d=this.acc_x:4===a?d=this.acc_y:5===a&&(d=this.acc_z);return cr.do_cmp(d,b,c)};h.prototype.OnNthTouchStart=function(a){a=Math.floor(a);return a===this.trigger_index};h.prototype.OnNthTouchEnd=function(a){a=Math.floor(a);return a===this.trigger_index};h.prototype.HasNthTouch=function(a){a=Math.floor(a);return this.touches.length>=
a+1};h.prototype.OnHoldGesture=function(){return!0};h.prototype.OnTapGesture=function(){return!0};h.prototype.OnDoubleTapGesture=function(){return!0};h.prototype.OnHoldGestureObject=function(a){return a?this.runtime.testAndSelectCanvasPointOverlap(a,this.curTouchX,this.curTouchY,!1):!1};h.prototype.OnTapGestureObject=function(a){return a?this.runtime.testAndSelectCanvasPointOverlap(a,this.curTouchX,this.curTouchY,!1):!1};h.prototype.OnDoubleTapGestureObject=function(a){return a?this.runtime.testAndSelectCanvasPointOverlap(a,
this.curTouchX,this.curTouchY,!1):!1};h.prototype.OnTouchReleasedObject=function(a){return a?this.runtime.testAndSelectCanvasPointOverlap(a,this.lastTouchX,this.lastTouchY,!1):!1};d.cnds=new h;d.acts=new n;n.prototype.SetEnable=function(a){this.enable=1==a};g.prototype.TouchCount=function(a){a.set_int(this.touches.length)};g.prototype.X=function(a,b){var c=this.getTouchIndex;if(0>c||c>=this.touches.length)a.set_float(0);else if(cr.is_undefined(b)){b=this.runtime.getLayerByNumber(0);var d=b.scale;
var e=b.zoomRate;var f=b.parallaxX;var g=b.angle;b.scale=1;b.zoomRate=1;b.parallaxX=1;b.angle=0;a.set_float(b.canvasToLayer(this.touches[c].x,this.touches[c].y,!0));b.scale=d;b.zoomRate=e;b.parallaxX=f;b.angle=g}else(b=cr.is_number(b)?this.runtime.getLayerByNumber(b):this.runtime.getLayerByName(b))?a.set_float(b.canvasToLayer(this.touches[c].x,this.touches[c].y,!0)):a.set_float(0)};g.prototype.XAt=function(a,b,c){b=Math.floor(b);if(0>b||b>=this.touches.length)a.set_float(0);else if(cr.is_undefined(c)){c=
this.runtime.getLayerByNumber(0);var d=c.scale;var e=c.zoomRate;var f=c.parallaxX;var g=c.angle;c.scale=1;c.zoomRate=1;c.parallaxX=1;c.angle=0;a.set_float(c.canvasToLayer(this.touches[b].x,this.touches[b].y,!0));c.scale=d;c.zoomRate=e;c.parallaxX=f;c.angle=g}else(c=cr.is_number(c)?this.runtime.getLayerByNumber(c):this.runtime.getLayerByName(c))?a.set_float(c.canvasToLayer(this.touches[b].x,this.touches[b].y,!0)):a.set_float(0)};g.prototype.XForID=function(a,b,c){b=this.findTouch(b);if(0>b)a.set_float(0);
else if(b=this.touches[b],cr.is_undefined(c)){c=this.runtime.getLayerByNumber(0);var d=c.scale;var e=c.zoomRate;var f=c.parallaxX;var g=c.angle;c.scale=1;c.zoomRate=1;c.parallaxX=1;c.angle=0;a.set_float(c.canvasToLayer(b.x,b.y,!0));c.scale=d;c.zoomRate=e;c.parallaxX=f;c.angle=g}else(c=cr.is_number(c)?this.runtime.getLayerByNumber(c):this.runtime.getLayerByName(c))?a.set_float(c.canvasToLayer(b.x,b.y,!0)):a.set_float(0)};g.prototype.Y=function(a,b){var c=this.getTouchIndex;if(0>c||c>=this.touches.length)a.set_float(0);
else if(cr.is_undefined(b)){b=this.runtime.getLayerByNumber(0);var d=b.scale;var e=b.zoomRate;var f=b.parallaxY;var g=b.angle;b.scale=1;b.zoomRate=1;b.parallaxY=1;b.angle=0;a.set_float(b.canvasToLayer(this.touches[c].x,this.touches[c].y,!1));b.scale=d;b.zoomRate=e;b.parallaxY=f;b.angle=g}else(b=cr.is_number(b)?this.runtime.getLayerByNumber(b):this.runtime.getLayerByName(b))?a.set_float(b.canvasToLayer(this.touches[c].x,this.touches[c].y,!1)):a.set_float(0)};g.prototype.YAt=function(a,b,c){b=Math.floor(b);
if(0>b||b>=this.touches.length)a.set_float(0);else if(cr.is_undefined(c)){c=this.runtime.getLayerByNumber(0);var d=c.scale;var e=c.zoomRate;var f=c.parallaxY;var g=c.angle;c.scale=1;c.zoomRate=1;c.parallaxY=1;c.angle=0;a.set_float(c.canvasToLayer(this.touches[b].x,this.touches[b].y,!1));c.scale=d;c.zoomRate=e;c.parallaxY=f;c.angle=g}else(c=cr.is_number(c)?this.runtime.getLayerByNumber(c):this.runtime.getLayerByName(c))?a.set_float(c.canvasToLayer(this.touches[b].x,this.touches[b].y,!1)):a.set_float(0)};
g.prototype.YForID=function(a,b,c){b=this.findTouch(b);if(0>b)a.set_float(0);else if(b=this.touches[b],cr.is_undefined(c)){c=this.runtime.getLayerByNumber(0);var d=c.scale;var e=c.zoomRate;var f=c.parallaxY;var g=c.angle;c.scale=1;c.zoomRate=1;c.parallaxY=1;c.angle=0;a.set_float(c.canvasToLayer(b.x,b.y,!1));c.scale=d;c.zoomRate=e;c.parallaxY=f;c.angle=g}else(c=cr.is_number(c)?this.runtime.getLayerByNumber(c):this.runtime.getLayerByName(c))?a.set_float(c.canvasToLayer(b.x,b.y,!1)):a.set_float(0)};
g.prototype.AbsoluteX=function(a){this.touches.length?a.set_float(this.touches[0].x):a.set_float(0)};g.prototype.AbsoluteXAt=function(a,b){b=Math.floor(b);0>b||b>=this.touches.length?a.set_float(0):a.set_float(this.touches[b].x)};g.prototype.AbsoluteXForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].x)};g.prototype.AbsoluteY=function(a){this.touches.length?a.set_float(this.touches[0].y):a.set_float(0)};g.prototype.AbsoluteYAt=function(a,b){b=Math.floor(b);0>b||
b>=this.touches.length?a.set_float(0):a.set_float(this.touches[b].y)};g.prototype.AbsoluteYForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].y)};g.prototype.SpeedAt=function(a,b){b=Math.floor(b);if(0>b||b>=this.touches.length)a.set_float(0);else{var c=this.touches[b];b=cr.distanceTo(c.x,c.y,c.lastx,c.lasty);c=(c.time-c.lasttime)/1E3;0===c?a.set_float(0):a.set_float(b/c)}};g.prototype.SpeedForID=function(a,b){b=this.findTouch(b);if(0>b)a.set_float(0);else{var c=
this.touches[b];b=cr.distanceTo(c.x,c.y,c.lastx,c.lasty);c=(c.time-c.lasttime)/1E3;0===c?a.set_float(0):a.set_float(b/c)}};g.prototype.AngleAt=function(a,b){b=Math.floor(b);0>b||b>=this.touches.length?a.set_float(0):(b=this.touches[b],a.set_float(cr.to_degrees(cr.angleTo(b.lastx,b.lasty,b.x,b.y))))};g.prototype.AngleForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):(b=this.touches[b],a.set_float(cr.to_degrees(cr.angleTo(b.lastx,b.lasty,b.x,b.y))))};g.prototype.Alpha=function(a){a.set_float(this.getAlpha())};
g.prototype.Beta=function(a){a.set_float(this.getBeta())};g.prototype.Gamma=function(a){a.set_float(this.getGamma())};g.prototype.AccelerationXWithG=function(a){a.set_float(this.acc_g_x)};g.prototype.AccelerationYWithG=function(a){a.set_float(this.acc_g_y)};g.prototype.AccelerationZWithG=function(a){a.set_float(this.acc_g_z)};g.prototype.AccelerationX=function(a){a.set_float(this.acc_x)};g.prototype.AccelerationY=function(a){a.set_float(this.acc_y)};g.prototype.AccelerationZ=function(a){a.set_float(this.acc_z)};
g.prototype.TouchIndex=function(a){a.set_int(this.trigger_index)};g.prototype.TouchID=function(a){a.set_float(this.trigger_id)};g.prototype.WidthForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].width)};g.prototype.HeightForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].height)};g.prototype.PressureForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].pressure)};d.exps=new g;k.HookMe=function(a){this._callbackObjs.push(a)};
k.UnHookMe=function(a){cr.arrayFindRemove(this._callbackObjs,a)};k.IsInTouch=function(){return 0<this.touches.length};var v=cr.plugins_.rex_TouchWrap.prototype.exps;k.TouchCount=function(){v.TouchCount.call(this,this.fake_ret);return this.fake_ret.value};k.X=function(a){v.X.call(this,this.fake_ret,a);return this.fake_ret.value};k.XAt=function(a,b){v.XAt.call(this,this.fake_ret,a,b);return this.fake_ret.value};k.XForID=function(a,b){v.XForID.call(this,this.fake_ret,a,b);return this.fake_ret.value};
k.Y=function(a){v.Y.call(this,this.fake_ret,a);return this.fake_ret.value};k.YAt=function(a,b){v.YAt.call(this,this.fake_ret,a,b);return this.fake_ret.value};k.YForID=function(a,b){v.YForID.call(this,this.fake_ret,a,b);return this.fake_ret.value};k.AbsoluteX=function(){v.AbsoluteX.call(this,this.fake_ret);return this.fake_ret.value};k.AbsoluteXAt=function(a){v.AbsoluteXAt.call(this,this.fake_ret,a);return this.fake_ret.value};k.AbsoluteXForID=function(a){v.AbsoluteXForID.call(this,this.fake_ret,a);
return this.fake_ret.value};k.AbsoluteY=function(){v.AbsoluteY.call(this,this.fake_ret);return this.fake_ret.value};k.AbsoluteYAt=function(a){v.AbsoluteYAt.call(this,this.fake_ret,a);return this.fake_ret.value};k.AbsoluteYForID=function(a){v.AbsoluteYForID.call(this,this.fake_ret,a);return this.fake_ret.value};k.CursorX=function(a){if(null==this.cursor.x)return null;if(cr.is_undefined(a)){var b=this.runtime.getLayerByNumber(0);var c=b.scale;var d=b.zoomRate;var e=b.parallaxX;var f=b.angle;b.scale=
1;b.zoomRate=1;b.parallaxX=1;b.angle=0;a=b.canvasToLayer(this.cursor.x,this.cursor.y,!0);b.scale=c;b.zoomRate=d;b.parallaxX=e;b.angle=f}else a=(b=cr.is_number(a)?this.runtime.getLayerByNumber(a):this.runtime.getLayerByName(a))?b.canvasToLayer(this.cursor.x,this.cursor.y,!0):0;return a};k.CursorY=function(a){if(null==this.cursor.y)return null;if(cr.is_undefined(a)){var b=this.runtime.getLayerByNumber(0);var c=b.scale;var d=b.zoomRate;var e=b.parallaxX;var f=b.angle;b.scale=1;b.zoomRate=1;b.parallaxX=
1;b.angle=0;a=b.canvasToLayer(this.cursor.x,this.cursor.y,!1);b.scale=c;b.zoomRate=d;b.parallaxX=e;b.angle=f}else a=(b=cr.is_number(a)?this.runtime.getLayerByNumber(a):this.runtime.getLayerByName(a))?b.canvasToLayer(this.cursor.x,this.cursor.y,!1):0;return a};k.CursorAbsoluteX=function(){return this.cursor.x};k.CursorAbsoluteY=function(){return this.cursor.y}})();cr.plugins_.sirg_fancyBox=function(a){this.runtime=a};
(function(){function a(){}var b=cr.plugins_.sirg_fancyBox.prototype;b.Type=function(a){this.plugin=a;this.runtime=a.runtime};b.Type.prototype.onCreate=function(){};b.Instance=function(a){this.type=a;this.runtime=a.runtime};var e=b.Instance.prototype;e.onCreate=function(){};e.onDestroy=function(){};e.saveToJSON=function(){return{}};e.loadFromJSON=function(a){};e.draw=function(a){};e.drawGL=function(a){};b.cnds=new function(){};a.prototype.ShowFancyBoxInline=function(a,b,e,g,d){switch(e){case 0:e="float";
break;case 1:e="inside";break;case 2:e="outside";break;case 3:e="over";break;default:e="outside"}jQuery.fancybox({type:"inline",content:d,title:1==b?a:null,helpers:{title:{type:e,position:1==g?"top":"bottom"}}})};a.prototype.ShowFancyBoxAjax=function(a,b,e,g,d){switch(e){case 0:e="float";break;case 1:e="inside";break;case 2:e="outside";break;case 3:e="over";break;default:e="outside"}jQuery.fancybox({type:"ajax",href:d,title:1==b?a:null,helpers:{title:{type:e,position:1==g?"top":"bottom"}}})};a.prototype.ShowFancyBoxIframe=
function(a,b,e,g,d){switch(e){case 0:e="float";break;case 1:e="inside";break;case 2:e="outside";break;case 3:e="over";break;default:e="outside"}jQuery.fancybox({type:"iframe",href:d,title:1==b?a:null,helpers:{title:{type:e,position:1==g?"top":"bottom"}}})};a.prototype.ShowFancyBoxSwf=function(a,b,e,g,d){switch(e){case 0:e="float";break;case 1:e="inside";break;case 2:e="outside";break;case 3:e="over";break;default:e="outside"}jQuery.fancybox({type:"swf",href:d,title:1==b?a:null,helpers:{title:{type:e,
position:1==g?"top":"bottom"}}})};a.prototype.ShowFancyBoxImage=function(a,b,e,g,d){switch(e){case 0:e="float";break;case 1:e="inside";break;case 2:e="outside";break;case 3:e="over";break;default:e="outside"}jQuery.fancybox({type:"image",href:d,title:1==b?a:null,helpers:{title:{type:e,position:1==g?"top":"bottom"}}})};a.prototype.ShowFancyBoxHtml=function(a,b,e,g,d){switch(e){case 0:e="float";break;case 1:e="inside";break;case 2:e="outside";break;case 3:e="over";break;default:e="outside"}jQuery.fancybox({type:"html",
content:d,title:1==b?a:null,helpers:{title:{type:e,position:1==g?"top":"bottom"}}})};a.prototype.ShowFancyBoxSimple=function(a){jQuery.fancybox({type:"inline",content:a})};b.acts=new a;b.exps=new function(){}})();
cr.behaviors.DragnDrop=function(a){this.runtime=a;var b=this;this.runtime.isDomFree||(jQuery(document).mousemove(function(a){b.onMouseMove(a)}),jQuery(document).mousedown(function(a){b.onMouseDown(a)}),jQuery(document).mouseup(function(a){b.onMouseUp(a)}));a=0<this.runtime.fullscreen_mode?document:this.runtime.canvas;this.runtime.isDirectCanvas?a=window.Canvas:this.runtime.isCocoonJs&&(a=window);"undefined"!==typeof PointerEvent?(a.addEventListener("pointerdown",function(a){b.onPointerStart(a)},!1),
a.addEventListener("pointermove",function(a){b.onPointerMove(a)},!1),a.addEventListener("pointerup",function(a){b.onPointerEnd(a)},!1),a.addEventListener("pointercancel",function(a){b.onPointerEnd(a)},!1)):window.navigator.msPointerEnabled?(a.addEventListener("MSPointerDown",function(a){b.onPointerStart(a)},!1),a.addEventListener("MSPointerMove",function(a){b.onPointerMove(a)},!1),a.addEventListener("MSPointerUp",function(a){b.onPointerEnd(a)},!1),a.addEventListener("MSPointerCancel",function(a){b.onPointerEnd(a)},
!1)):(a.addEventListener("touchstart",function(a){b.onTouchStart(a)},!1),a.addEventListener("touchmove",function(a){b.onTouchMove(a)},!1),a.addEventListener("touchend",function(a){b.onTouchEnd(a)},!1),a.addEventListener("touchcancel",function(a){b.onTouchEnd(a)},!1))};
(function(){function a(a){var b;var e=0;for(b=a.behavior_insts.length;e<b;e++)if(a.behavior_insts[e]instanceof l.Instance)return a.behavior_insts[e];return null}function b(){}function e(){}var l=cr.behaviors.DragnDrop.prototype,h={left:0,top:0};l.onMouseDown=function(a){if(1===a.which)this.onInputDown("leftmouse",a.pageX,a.pageY)};l.onMouseMove=function(a){if(1===a.which)this.onInputMove("leftmouse",a.pageX,a.pageY)};l.onMouseUp=function(a){if(1===a.which)this.onInputUp("leftmouse")};l.onTouchStart=
function(a){a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault();var b;var e=0;for(b=a.changedTouches.length;e<b;e++){var g=a.changedTouches[e];var h=g.identifier;this.onInputDown(h?h.toString():"<none>",g.pageX,g.pageY)}};l.onTouchMove=function(a){a.preventDefault&&a.preventDefault();var b;var e=0;for(b=a.changedTouches.length;e<b;e++){var g=a.changedTouches[e];var h=g.identifier;this.onInputMove(h?h.toString():"<none>",g.pageX,g.pageY)}};l.onTouchEnd=function(a){a.preventDefault&&cr.isCanvasInputEvent(a)&&
a.preventDefault();var b;var e=0;for(b=a.changedTouches.length;e<b;e++){var g=a.changedTouches[e];g=g.identifier;this.onInputUp(g?g.toString():"<none>")}};l.onPointerStart=function(a){a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType&&(a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault(),this.onInputDown(a.pointerId.toString(),a.pageX,a.pageY))};l.onPointerMove=function(a){a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType&&(a.preventDefault&&a.preventDefault(),
this.onInputMove(a.pointerId.toString(),a.pageX,a.pageY))};l.onPointerEnd=function(a){a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType&&(a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault(),this.onInputUp(a.pointerId.toString()))};l.onInputDown=function(b,d,e){var g=this.runtime.isDomFree?h:jQuery(this.runtime.canvas).offset();d-=g.left;e-=g.top;g=this.my_instances.valuesRef();var k,c=null;var f=0;for(k=g.length;f<k;f++){var l=g[f];var n=a(l);if(n.enabled&&!n.dragging){n=
l.layer.canvasToLayer(d,e,!0);var z=l.layer.canvasToLayer(d,e,!1);l.update_bbox();if(l.contains_pt(n,z))if(c)l.layer.index>c.layer.index?(c=l,x=n,C=z):l.layer.index===c.layer.index&&l.get_zindex()>c.get_zindex()&&(c=l,x=n,C=z);else{c=l;var x=n;var C=z}}}if(c)a(c).onDown(b,x,C)};l.onInputMove=function(b,d,e){var g=this.runtime.isDomFree?h:jQuery(this.runtime.canvas).offset();d-=g.left;e-=g.top;var k=this.my_instances.valuesRef(),c;var f=0;for(c=k.length;f<c;f++){var l=k[f];var n=a(l);!n.enabled||!n.dragging||
n.dragging&&n.dragsource!==b||(g=l.layer.canvasToLayer(d,e,!0),l=l.layer.canvasToLayer(d,e,!1),n.onMove(g,l))}};l.onInputUp=function(b){var d=this.my_instances.valuesRef(),e;var g=0;for(e=d.length;g<e;g++){var h=d[g];h=a(h);if(h.dragging&&h.dragsource===b)h.onUp()}};l.Type=function(a,b){this.behavior=a;this.objtype=b;this.runtime=a.runtime};l.Type.prototype.onCreate=function(){};l.Instance=function(a,b){this.type=a;this.behavior=a.behavior;this.inst=b;this.runtime=a.runtime};var n=l.Instance.prototype;
n.onCreate=function(){this.dragging=!1;this.dy=this.dx=0;this.dragsource="<none>";this.axes=this.properties[0];this.enabled=0!==this.properties[1]};n.saveToJSON=function(){return{enabled:this.enabled}};n.loadFromJSON=function(a){this.enabled=a.enabled;this.dragging=!1};n.onDown=function(a,b,e){this.dx=b-this.inst.x;this.dy=e-this.inst.y;this.dragging=!0;this.dragsource=a;this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.behaviors.DragnDrop.prototype.cnds.OnDragStart,this.inst);this.runtime.isInUserInputEvent=
!1};n.onMove=function(a,b){a-=this.dx;b-=this.dy;if(0===this.axes){if(this.inst.x!==a||this.inst.y!==b)this.inst.x=a,this.inst.y=b,this.inst.set_bbox_changed()}else 1===this.axes?this.inst.x!==a&&(this.inst.x=a,this.inst.set_bbox_changed()):2===this.axes&&this.inst.y!==b&&(this.inst.y=b,this.inst.set_bbox_changed())};n.onUp=function(){this.dragging=!1;this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.behaviors.DragnDrop.prototype.cnds.OnDrop,this.inst);this.runtime.isInUserInputEvent=!1};
n.tick=function(){};b.prototype.IsDragging=function(){return this.dragging};b.prototype.OnDragStart=function(){return!0};b.prototype.OnDrop=function(){return!0};b.prototype.IsEnabled=function(){return!!this.enabled};l.cnds=new b;e.prototype.SetEnabled=function(a){this.enabled=0!==a;this.enabled||(this.dragging=!1)};e.prototype.Drop=function(){if(this.dragging)this.onUp()};l.acts=new e;l.exps=new function(){}})();cr.behaviors.Flash=function(a){this.runtime=a};
(function(){function a(){}function b(){}var e=cr.behaviors.Flash.prototype;e.Type=function(a,b){this.behavior=a;this.objtype=b;this.runtime=a.runtime};e.Type.prototype.onCreate=function(){};e.Instance=function(a,b){this.type=a;this.behavior=a.behavior;this.inst=b;this.runtime=a.runtime};var l=e.Instance.prototype;l.onCreate=function(){this.timeleft=this.stagetimeleft=this.stage=this.offtime=this.ontime=0};l.saveToJSON=function(){return{ontime:this.ontime,offtime:this.offtime,stage:this.stage,stagetimeleft:this.stagetimeleft,
timeleft:this.timeleft}};l.loadFromJSON=function(a){this.ontime=a.ontime;this.offtime=a.offtime;this.stage=a.stage;this.stagetimeleft=a.stagetimeleft;this.timeleft=a.timeleft;null===this.timeleft&&(this.timeleft=Infinity)};l.tick=function(){if(!(0>=this.timeleft)){var a=this.runtime.getDt(this.inst);this.timeleft-=a;0>=this.timeleft?(this.timeleft=0,this.inst.visible=!0,this.runtime.redraw=!0,this.runtime.trigger(cr.behaviors.Flash.prototype.cnds.OnFlashEnded,this.inst)):(this.stagetimeleft-=a,0>=
this.stagetimeleft&&(0===this.stage?(this.inst.visible=!1,this.stage=1,this.stagetimeleft+=this.offtime):(this.inst.visible=!0,this.stage=0,this.stagetimeleft+=this.ontime),this.runtime.redraw=!0))}};a.prototype.IsFlashing=function(){return 0<this.timeleft};a.prototype.OnFlashEnded=function(){return!0};e.cnds=new a;b.prototype.Flash=function(a,b,e){this.ontime=a;this.offtime=b;this.stage=1;this.stagetimeleft=b;this.timeleft=e;this.inst.visible=!1;this.runtime.redraw=!0};b.prototype.StopFlashing=function(){this.timeleft=
0;this.inst.visible=!0;this.runtime.redraw=!0};e.acts=new b;e.exps=new function(){}})();cr.behaviors.Rex_DragDrop2=function(a){this.runtime=a};
(function(){function a(a){var b;var c=0;for(b=a.behavior_insts.length;c<b;c++)if(a.behavior_insts[c]instanceof h.Instance)return a.behavior_insts[c];return null}function b(){}function e(){}function l(){}var h=cr.behaviors.Rex_DragDrop2.prototype;h.Type=function(a,b){this.behavior=a;this.objtype=b;this.runtime=a.runtime;this.touchwrap=null};h.TouchWrapGet=function(){if(null!=this.touchwrap)return this.touchwrap;var a=this.runtime.types,b;for(b in a){var c=a[b].instances[0];if(c instanceof cr.plugins_.rex_TouchWrap.prototype.Instance)return this.touchwrap=
c,this.touchwrap.HookMe(this),this.touchwrap}};h.OnTouchStart=function(a,b,c){this.DragDetecting(b,c,a)};h.OnTouchEnd=function(b){var c=this.my_instances.valuesRef(),d,e=c.length,f;for(d=0;d<e;d++)if(f=c[d])f=a(f),null!=f&&f.drag_info.touch_src==b&&f.drag_info.is_on_dragged&&f.DragSrcSet(null)};var n=[];h.DragDetecting=function(b,c,d){var e=this.my_instances.valuesRef(),f,g=e.length,h;for(f=n.length=0;f<g;f++)if(h=e[f]){var k=a(h);if(null!=k&&k.enabled&&!k.drag_info.is_on_dragged){var l=h.layer.canvasToLayer(b,
c,!0);var q=h.layer.canvasToLayer(b,c,!1);h.update_bbox();h.contains_pt(l,q)&&n.push(k)}}g=n.length;if(0==g)return!1;b=n[0];c=b.inst;for(f=1;f<g;f++)if(k=n[f],e=k.inst,e.layer.index>c.layer.index||e.layer.index==c.layer.index&&e.get_zindex()>c.get_zindex())b=k,c=e;b.DragSrcSet(d);n.length=0;return!0};h.Type.prototype.onCreate=function(){};h.Instance=function(a,b){this.type=a;this.behavior=a.behavior;this.inst=b;this.runtime=a.runtime;this.behavior.TouchWrapGet()};var g=h.Instance.prototype;g.onCreate=
function(){this.enabled=1===this.properties[0];this.move_axis=this.properties[1];this.setAxisAngle(this.properties[2]);this.recycled||(this.drag_info=new r(this));this.drag_info.init(this)};g.setAxisAngle=function(a){this.axis_angle=a;this.axis_rad=cr.to_clamped_radians(this.axis_angle)};var d={},k={};g.tick=function(){if(this.enabled&&this.drag_info.is_on_dragged){var a=this.inst,b=this.drag_info,c=this.GetTouchX(),e=this.GetTouchY(),g=b.pre_x!=c||b.pre_y!=e;if(g){if(0===this.move_axis){var h=c+
b.drag_dx;var l=e+b.drag_dy}else 0===this.axis_rad?1===this.move_axis?(h=c+b.drag_dx,l=a.y):(h=a.x,l=e+b.drag_dy):(d.x=a.x,d.y=a.y,k.x=c+b.drag_dx,k.y=e+b.drag_dy,u(k,d,-this.axis_rad),1===this.move_axis?k.y=d.y:k.x=d.x,u(k,d,this.axis_rad),h=k.x,l=k.y);a.x=h;a.y=l;a.set_bbox_changed();b.pre_x=c;b.pre_y=e}this.drag_info.IsMovingSet(g)}};var u=function(a,b,c){c=cr.angleTo(b.x,b.y,a.x,a.y)+c;var d=cr.distanceTo(b.x,b.y,a.x,a.y);a.x=b.x+d*Math.cos(c);a.y=b.y+d*Math.sin(c);return a};g.GetTouchX=function(){return-1==
this.drag_info.touch_src?0:this.behavior.TouchWrapGet().XForID(this.drag_info.touch_src,this.inst.layer.index)};g.GetTouchY=function(){return-1==this.drag_info.touch_src?0:this.behavior.TouchWrapGet().YForID(this.drag_info.touch_src,this.inst.layer.index)};g.DragSrcSet=function(a){this.drag_info.DragSrcSet(a)};var r=function(a){},c=r.prototype;c.init=function(a){this.plugin=a;this.touch_src=-1;this.drag_dy=this.drag_dx=this.pre_y=this.pre_x=0;this.is_on_dragged=!1;this.drag_start_y=this.drag_start_x=
0;this.inst_start_x=a.inst.x;this.inst_start_y=a.inst.y;this.is_moving=!1};c.DragSrcSet=function(a){if(null==a)this.is_on_dragged=!1,this.plugin.runtime.trigger(cr.behaviors.Rex_DragDrop2.prototype.cnds.OnDrop,this.plugin.inst),this.touch_src=-1;else{this.is_on_dragged=!0;this.touch_src=a;a=this.plugin.inst;var b=this.plugin.GetTouchX(),c=this.plugin.GetTouchY();this.drag_dx=a.x-b;this.drag_dy=a.y-c;this.pre_x=b;this.pre_y=c;this.drag_start_x=b;this.drag_start_y=c;this.inst_start_x=a.x;this.inst_start_y=
a.y;this.plugin.runtime.trigger(cr.behaviors.Rex_DragDrop2.prototype.cnds.OnDragStart,this.plugin.inst)}this.IsMovingSet(!1)};c.ForceDrop=function(){this.is_on_dragged&&(this.plugin.runtime.trigger(cr.behaviors.Rex_DragDrop2.prototype.cnds.OnDrop,this.plugin.inst),this.is_on_dragged=!1)};c.IsMovingSet=function(a){!this.is_moving&&a?this.plugin.runtime.trigger(cr.behaviors.Rex_DragDrop2.prototype.cnds.OnDragMoveStart,this.plugin.inst):this.is_moving&&!a&&this.plugin.runtime.trigger(cr.behaviors.Rex_DragDrop2.prototype.cnds.OnDragMoveEnd,
this.plugin.inst);this.is_moving=a};c.DragDistance=function(){if(!this.is_on_dragged)return 0;var a=this.drag_start_x,b=this.drag_start_y,c=this.plugin.GetTouchX(),d=this.plugin.GetTouchY();return cr.distanceTo(a,b,c,d)};c.DragAngle=function(){if(!this.is_on_dragged)return 0;var a=this.drag_start_x,b=this.drag_start_y,c=this.plugin.GetTouchX(),d=this.plugin.GetTouchY();a=cr.angleTo(a,b,c,d);return a=cr.to_clamped_degrees(a)};g.saveToJSON=function(){return{en:this.enabled,aa:this.axis_angle}};g.loadFromJSON=
function(a){this.enabled=a.en;this.setAxisAngle(a.aa)};h.cnds=new b;b.prototype.OnDragStart=function(){return!0};b.prototype.OnDrop=function(){return!0};b.prototype.IsDragging=function(){return this.drag_info.is_on_dragged};b.prototype.OnDragMoveStart=function(){return!0};b.prototype.OnDragMove=function(){return!0};b.prototype.IsDraggingMoving=function(){return this.drag_info.is_moving};b.prototype.OnDragMoveEnd=function(){return!0};b.prototype.CompareDragDistance=function(a,b){return this.drag_info.is_on_dragged?
cr.do_cmp(this.drag_info.DragDistance(),a,b):!1};b.prototype.CompareDragAngle=function(a,b){return this.drag_info.is_on_dragged?cr.do_cmp(this.drag_info.DragAngle(),a,b):!1};b.prototype.IsEnabled=function(){return this.enabled};h.acts=new e;e.prototype.SetEnabled=function(a){this.enabled=0!==a;this.drag_info.ForceDrop()};e.prototype.ForceDrop=function(){this.drag_info.ForceDrop()};e.prototype.TryDrag=function(){if(!this.drag_info.is_on_dragged){var a=this.behavior.TouchWrapGet();if(a.IsInTouch()){a=
a.touches;var b=a.length,c,d=this.inst;d.update_bbox();for(c=0;c<b;c++){var e=a[c];var g=d.layer.canvasToLayer(e.x,e.y,!0);e=d.layer.canvasToLayer(e.x,e.y,!1);if(d.contains_pt(g,e)){this.DragSrcSet(c);break}}}}};e.prototype.SetAxisAngle=function(a){this.setAxisAngle(a)};h.exps=new l;l.prototype.X=function(a){a.set_float(this.GetTouchX())};l.prototype.Y=function(a){a.set_float(this.GetTouchY())};l.prototype.AbsoluteX=function(a){var b=-1==this.drag_info.touch_src?0:this.behavior.touchwrap.AbsoluteXForID(this.drag_info.touch_src);
a.set_float(b)};l.prototype.AbsoluteY=function(a){var b=-1==this.drag_info.touch_src?0:this.behavior.touchwrap.AbsoluteYForID(this.drag_info.touch_src);a.set_float(b)};l.prototype.Activated=function(a){a.set_int(this.enabled?1:0)};l.prototype.StartX=function(a){a.set_float(this.drag_info.inst_start_x)};l.prototype.StartY=function(a){a.set_float(this.drag_info.inst_start_y)};l.prototype.DragStartX=function(a){a.set_float(this.drag_info.drag_start_x)};l.prototype.DragStartY=function(a){a.set_float(this.drag_info.drag_start_y)};
l.prototype.InstStartX=function(a){a.set_float(this.drag_info.inst_start_x)};l.prototype.InstStartY=function(a){a.set_float(this.drag_info.inst_start_y)};l.prototype.DragDistance=function(a){a.set_float(this.drag_info.DragDistance())};l.prototype.DragAngle=function(a){a.set_float(this.drag_info.DragAngle())};l.prototype.AxisAngle=function(a){a.set_float(this.axis_angle)}})();cr.behaviors.Rex_Rotate=function(a){this.runtime=a};
(function(){function a(){}function b(){}function e(){}var l=cr.behaviors.Rex_Rotate.prototype;l.Type=function(a,b){this.behavior=a;this.objtype=b;this.runtime=a.runtime};l.Type.prototype.onCreate=function(){};l.Instance=function(a,b){this.type=a;this.behavior=a.behavior;this.inst=b;this.runtime=a.runtime};var h=l.Instance.prototype;h.onCreate=function(){this.enable=1==this.properties[0];this.direction=this.properties[1];this.speed=this.properties[2];this.acc=this.properties[3]};h.tick=function(){if(this.enable){var a=
this.runtime.getDt(this.inst);this.speed+=this.acc*a;0!=this.speed&&(a*=this.speed,0==this.direction&&(a=-a),this.inst.angle+=cr.to_clamped_radians(a),this.inst.set_bbox_changed())}};h.saveToJSON=function(){return{en:this.enable,d:this.direction,s:this.speed,a:this.acc}};h.loadFromJSON=function(a){this.enable=a.en;this.direction=a.d;this.speed=a.s;this.acc=a.a};l.cnds=new a;a.prototype.CompareSpeed=function(a,b){return cr.do_cmp(this.speed,a,b)};l.acts=new b;b.prototype.SetActivated=function(a){this.enable=
1==a};b.prototype.SetDirection=function(a){this.direction=a};b.prototype.SetSpeed=function(a){this.speed=a};b.prototype.SetAcceleration=function(a){this.acc=a};l.exps=new e;e.prototype.Speed=function(a){a.set_float(this.speed)};e.prototype.Acceleration=function(a){a.set_float(this.acc)};e.prototype.Activated=function(a){a.set_int(this.enable?1:0)}})();cr.behaviors.Rex_TouchArea2=function(a){this.runtime=a};
(function(){function a(){}function b(){}function e(){}var l=cr.behaviors.Rex_TouchArea2.prototype;l.Type=function(a,b){this.behavior=a;this.objtype=b;this.runtime=a.runtime};var h=l.Type.prototype;h.onCreate=function(){this.touchwrap=null};h.TouchWrapGet=function(){if(null==this.touchwrap){var a=this.runtime.types,b;for(b in a){var d=a[b].instances[0];if(null!=d&&"TOUCHWRAP"==d.check_name){this.touchwrap=d;break}}}};l.Instance=function(a,b){this.type=a;this.behavior=a.behavior;this.inst=b;this.runtime=
a.runtime;a.TouchWrapGet()};h=l.Instance.prototype;h.onCreate=function(){this.enabled=1===this.properties[0];this.is_touched=!1;this.cur_touchY=this.cur_touchX=-1;this.delta_touchY=this.delta_touchX=0;this._distance=this._vectorY=this._vectorX=this.start_touchY=this.start_touchX=-1};h.tick=function(){if(this.enabled){var a=this.type.touchwrap,b=a.touches,d=b.length,e=!1,h=this.inst;h.update_bbox();var l=this.cur_touchX,c=this.cur_touchY;if(a.IsInTouch())for(a=0;a<d;a++){var f=b[a];var q=h.layer.canvasToLayer(f.x,
f.y,!0);f=h.layer.canvasToLayer(f.x,f.y,!1);if(h.contains_pt(q,f)){this.cur_touchX=q;this.cur_touchY=f;e=!0;break}}this._distance=this._vectorY=this._vectorX=-1;b=this.is_touched;this.is_touched=e;b&&e?(this.delta_touchX=this.cur_touchX-l,this.delta_touchY=this.cur_touchY-c):this.delta_touchY=this.delta_touchX=0;!b&&e&&(this.start_touchX=this.cur_touchX,this.start_touchY=this.cur_touchY,this.runtime.trigger(cr.behaviors.Rex_TouchArea2.prototype.cnds.OnTouchStart,h));l==this.cur_touchX&&c==this.cur_touchY||
this.runtime.trigger(cr.behaviors.Rex_TouchArea2.prototype.cnds.OnTouchMoving,h);b&&!e&&this.runtime.trigger(cr.behaviors.Rex_TouchArea2.prototype.cnds.OnTouchEnd,h)}};h._dist_get=function(){-1==this._distance&&(this._distance=cr.distanceTo(this.start_touchX,this.start_touchY,this.cur_touchX,this.cur_touchY));return this._distance};h._unit_vecXY_get=function(){if(-1==this._vectorX&&-1==this._vectorY)if(this.start_touchX==this.cur_touchX&&this.start_touchY==this.cur_touchY)this._vectorY=this._vectorX=
0;else{var a=cr.angleTo(this.start_touchX,this.start_touchY,this.cur_touchX,this.cur_touchY);this._vectorX=Math.cos(a);this._vectorY=Math.sin(a)}};h._currx_get=function(){return this.is_touched?this.cur_touchX:-1};h._curry_get=function(){return this.is_touched?this.cur_touchY:-1};h._startx_get=function(){return this.is_touched?this.start_touchX:-1};h._starty_get=function(){return this.is_touched?this.start_touchY:-1};h._distance_get=function(){return this.is_touched?this._dist_get():-1};h._angle_get=
function(){if(this.is_touched){var a=cr.angleTo(this.start_touchX,this.start_touchY,this.cur_touchX,this.cur_touchY);a=cr.to_clamped_degrees(a)}else a=-1;return a};h._vectorx_get=function(){if(this.is_touched){this._unit_vecXY_get();var a=this._vectorX}else a=0;return a};h._vectory_get=function(){if(this.is_touched){this._unit_vecXY_get();var a=this._vectorY}else a=0;return a};l.cnds=new a;a.prototype.OnTouchStart=function(){return!0};a.prototype.OnTouchEnd=function(){return!0};a.prototype.IsInTouch=
function(){return this.is_touched};a.prototype.OnTouchMoving=function(){return!0};a.prototype.CompareDragDistance=function(a,b){return this.is_touched?cr.do_cmp(this._distance_get(),a,b):!1};a.prototype.CompareDragAngle=function(a,b){return this.is_touched?cr.do_cmp(this._angle_get(),a,b):!1};l.acts=new b;b.prototype.SetEnabled=function(a){this.enabled=0!==a};l.exps=new e;e.prototype.X=function(a){a.set_float(this._currx_get())};e.prototype.Y=function(a){a.set_float(this._curry_get())};e.prototype.StartX=
function(a){a.set_float(this._startx_get())};e.prototype.StartY=function(a){a.set_float(this._starty_get())};e.prototype.Distance=function(a){a.set_float(this._distance_get())};e.prototype.Angle=function(a){a.set_float(this._angle_get())};e.prototype.VectorX=function(a){a.set_float(this._vectorx_get())};e.prototype.VectorY=function(a){a.set_float(this._vectory_get())};e.prototype.DeltaX=function(a){a.set_float(this.delta_touchX)};e.prototype.DeltaY=function(a){a.set_float(this.delta_touchY)}})();
cr.behaviors.bound=function(a){this.runtime=a};
(function(){var a=cr.behaviors.bound.prototype;a.Type=function(a,e){this.behavior=a;this.objtype=e;this.runtime=a.runtime};a.Type.prototype.onCreate=function(){};a.Instance=function(a,e){this.type=a;this.behavior=a.behavior;this.inst=e;this.runtime=a.runtime;this.mode=0};a=a.Instance.prototype;a.onCreate=function(){this.mode=this.properties[0]};a.tick=function(){};a.tick2=function(){this.inst.update_bbox();var a=this.inst.bbox,e=this.inst.layer.layout,l=!1;0===this.mode?(0>this.inst.x&&(this.inst.x=
0,l=!0),0>this.inst.y&&(this.inst.y=0,l=!0),this.inst.x>e.width&&(this.inst.x=e.width,l=!0),this.inst.y>e.height&&(this.inst.y=e.height,l=!0)):(0>a.left&&(this.inst.x-=a.left,l=!0),0>a.top&&(this.inst.y-=a.top,l=!0),a.right>e.width&&(this.inst.x-=a.right-e.width,l=!0),a.bottom>e.height&&(this.inst.y-=a.bottom-e.height,l=!0));l&&this.inst.set_bbox_changed()}})();cr.behaviors.solid=function(a){this.runtime=a};
(function(){function a(){}function b(){}var e=cr.behaviors.solid.prototype;e.Type=function(a,b){this.behavior=a;this.objtype=b;this.runtime=a.runtime};e.Type.prototype.onCreate=function(){};e.Instance=function(a,b){this.type=a;this.behavior=a.behavior;this.inst=b;this.runtime=a.runtime};var l=e.Instance.prototype;l.onCreate=function(){this.inst.extra.solidEnabled=0!==this.properties[0]};l.tick=function(){};a.prototype.IsEnabled=function(){return this.inst.extra.solidEnabled};e.cnds=new a;b.prototype.SetEnabled=
function(a){this.inst.extra.solidEnabled=!!a};e.acts=new b})();
cr.getObjectRefTable=function(){return[cr.plugins_.CSS_import,cr.plugins_.Function,cr.plugins_.filechooser,cr.plugins_.Browser,cr.plugins_.pix_dialogs,cr.plugins_.Keyboard,cr.plugins_.Mouse,cr.plugins_.Rex_SysExt,cr.plugins_.rex_TouchWrap,cr.plugins_.Touch,cr.plugins_.Rex_UID2Prop,cr.plugins_.sirg_fancyBox,cr.plugins_.Sprite,cr.plugins_.Text,cr.plugins_.TiledBg,cr.plugins_.ValerypopoffJSPlugin,cr.behaviors.solid,cr.behaviors.DragnDrop,cr.behaviors.Flash,cr.behaviors.Rex_Rotate,cr.behaviors.bound,
cr.behaviors.Rex_TouchArea2,cr.behaviors.Rex_DragDrop2,cr.system_object.prototype.cnds.IsGroupActive,cr.plugins_.Function.prototype.cnds.OnFunction,cr.plugins_.ValerypopoffJSPlugin.prototype.acts.Call,cr.system_object.prototype.acts.SetVar,cr.plugins_.Function.prototype.acts.CallFunction,cr.system_object.prototype.acts.Wait,cr.system_object.prototype.acts.RestartLayout,cr.plugins_.Touch.prototype.cnds.OnTouchObject,cr.plugins_.Text.prototype.cnds.IsVisible,cr.system_object.prototype.acts.GoToLayout,
cr.plugins_.Browser.prototype.acts.GoToURLWindow,cr.system_object.prototype.exps.replace,cr.plugins_.Browser.prototype.acts.Reload,cr.plugins_.pix_dialogs.prototype.acts.openDialog,cr.plugins_.pix_dialogs.prototype.cnds.dialogConfirmed,cr.plugins_.Sprite.prototype.acts.SetOpacity,cr.plugins_.Sprite.prototype.acts.Destroy,cr.plugins_.Touch.prototype.cnds.OnHoldGestureObject,cr.plugins_.Touch.prototype.cnds.OnTapGestureObject,cr.system_object.prototype.cnds.OnLayoutStart,cr.system_object.prototype.acts.SetLayerVisible,
cr.system_object.prototype.cnds.Compare,cr.system_object.prototype.exps.layoutname,cr.plugins_.Sprite.prototype.acts.SetVisible,cr.system_object.prototype.cnds.OnLayoutEnd,cr.system_object.prototype.acts.SetFullscreenQuality,cr.system_object.prototype.cnds.CompareVar,cr.plugins_.Touch.prototype.cnds.IsTouchingObject,cr.plugins_.Touch.prototype.exps.X,cr.plugins_.Touch.prototype.exps.Y,cr.system_object.prototype.acts.CreateObject,cr.plugins_.Sprite.prototype.acts.SetSize,cr.plugins_.Sprite.prototype.acts.SetWidth,
cr.system_object.prototype.exps.distance,cr.plugins_.Sprite.prototype.exps.X,cr.plugins_.Sprite.prototype.exps.Y,cr.plugins_.Sprite.prototype.acts.SetAngle,cr.system_object.prototype.exps.angle,cr.plugins_.Browser.prototype.cnds.IsOnline,cr.plugins_.Browser.prototype.exps.Domain,cr.system_object.prototype.exps.str,cr.system_object.prototype.exps.tickcount,cr.plugins_.Text.prototype.acts.SetVisible,cr.plugins_.Text.prototype.acts.SetText,cr.plugins_.Text.prototype.exps.Text,cr.plugins_.Sprite.prototype.cnds.CompareOpacity,
cr.behaviors.Rex_Rotate.prototype.acts.SetActivated,cr.behaviors.Flash.prototype.acts.Flash]};
